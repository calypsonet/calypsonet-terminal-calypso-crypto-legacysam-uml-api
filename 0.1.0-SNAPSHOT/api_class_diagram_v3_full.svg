<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1789px" preserveAspectRatio="none" style="width:3948px;height:1789px;background:#FFFFFF;" version="1.1" viewBox="0 0 3948 1789" width="3948px" zoomAndPan="magnify"><defs><filter height="1" id="b12jbdtdtkuruh0" width="1" x="0" y="0"><feFlood flood-color="#FFFF00" result="flood"/><feComposite in="SourceGraphic" in2="flood" operator="over"/></filter><filter height="1" id="b12jbdtdtkuruh1" width="1" x="0" y="0"><feFlood flood-color="#FFC0CB" result="flood"/><feComposite in="SourceGraphic" in2="flood" operator="over"/></filter></defs><g><rect fill="none" height="25.6406" id="_title" style="stroke:none;stroke-width:1.0;" width="677" x="1628.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="667" x="1633.5" y="22.6738">Calypsonet - calypsonet-terminal-calypso-crypto-legacysam-java-api - 0.1.+ (2022-11-29) v3 FULL</text><rect fill="#DDDDDD" height="72.5625" id="_legend" rx="7.5" ry="7.5" style="stroke:#000000;stroke-width:1.0;" width="282" x="1826" y="48.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="88" x="1831" y="66.3145">Colors legend</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1923" y="66.3145">:</text><ellipse cx="1836.5" cy="77.4219" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="189" x="1843" y="81.9551">External public API references</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2036" y="81.9551">:</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="1840" y="90.5625"/><text fill="#000000" filter="url(#b12jbdtdtkuruh0)" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="250" x="1847" y="97.5957">calypsonet-terminal-reader-java-api</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="1840" y="106.2031"/><text fill="#000000" filter="url(#b12jbdtdtkuruh1)" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="256" x="1847" y="113.2363">calypsonet-terminal-calypso-java-api</text><!--MD5=[7442f3b126ee602ae02566c1a49e158a]
cluster api--><g id="cluster_api"><path d="M8.5,140.2031 L431.5,140.2031 A3.75,3.75 0 0 1 434,142.7031 L441,161.8438 L3938.5,161.8438 A2.5,2.5 0 0 1 3941,164.3438 L3941,1779.7031 A2.5,2.5 0 0 1 3938.5,1782.2031 L8.5,1782.2031 A2.5,2.5 0 0 1 6,1779.7031 L6,142.7031 A2.5,2.5 0 0 1 8.5,140.2031 " fill="#F8F9F9" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="6" x2="441" y1="161.8438" y2="161.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="422" x="10" y="154.877">org.calypsonet.terminal.calypso.crypto.symmetric.legacysam</text></g><!--MD5=[98d4fa74a8fc0b7c744d347d810a7562]
cluster sam--><g id="cluster_sam"><path d="M677.5,1182.2031 L706.5,1182.2031 A3.75,3.75 0 0 1 709,1184.7031 L716,1203.8438 L1632.5,1203.8438 A2.5,2.5 0 0 1 1635,1206.3438 L1635,1755.7031 A2.5,2.5 0 0 1 1632.5,1758.2031 L677.5,1758.2031 A2.5,2.5 0 0 1 675,1755.7031 L675,1184.7031 A2.5,2.5 0 0 1 677.5,1182.2031 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="675" x2="716" y1="1203.8438" y2="1203.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="28" x="679" y="1196.877">sam</text></g><!--MD5=[120218adfd8782b0057db0a1b8294250]
class ApiProperties--><g id="elem_ApiProperties"><rect codeLine="61" fill="#FEFECE" height="63.6406" id="ApiProperties" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="236" x="3023" y="181.7031"/><ellipse cx="3038" cy="197.7031" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3040.7656,193.5781 Q3040.9219,193.3594 3041.1094,193.25 Q3041.2969,193.1406 3041.5156,193.1406 Q3041.8906,193.1406 3042.125,193.4063 Q3042.3594,193.6563 3042.3594,194.2656 L3042.3594,195.7188 Q3042.3594,196.3281 3042.125,196.5938 Q3041.8906,196.8594 3041.5156,196.8594 Q3041.1719,196.8594 3040.9688,196.6563 Q3040.7656,196.4688 3040.6563,195.9531 Q3040.6094,195.5938 3040.4219,195.4063 Q3040.0938,195.0313 3039.4844,194.8125 Q3038.875,194.5938 3038.25,194.5938 Q3037.4844,194.5938 3036.8438,194.9219 Q3036.2188,195.25 3035.7188,196 Q3035.2344,196.75 3035.2344,197.7813 L3035.2344,198.875 Q3035.2344,200.1094 3036.125,200.9375 Q3037.0156,201.75 3038.6094,201.75 Q3039.5469,201.75 3040.2031,201.5 Q3040.5938,201.3438 3041.0156,200.9063 Q3041.2813,200.6406 3041.4219,200.5625 Q3041.5781,200.4844 3041.7813,200.4844 Q3042.1094,200.4844 3042.3594,200.75 Q3042.625,201 3042.625,201.3438 Q3042.625,201.6875 3042.2813,202.0938 Q3041.7813,202.6719 3040.9844,203 Q3039.9063,203.4531 3038.6094,203.4531 Q3037.0938,203.4531 3035.8906,202.8281 Q3034.9063,202.3281 3034.2188,201.2656 Q3033.5313,200.1875 3033.5313,198.9063 L3033.5313,197.75 Q3033.5313,196.4219 3034.1406,195.2813 Q3034.7656,194.125 3035.8594,193.5156 Q3036.9531,192.8906 3038.1875,192.8906 Q3038.9219,192.8906 3039.5625,193.0625 Q3040.2188,193.2188 3040.7656,193.5781 Z " fill="#000000"/><ellipse cx="3057" cy="197.2031" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="30" x="3063" y="202.5566">final</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="159" x="3097" y="202.5566">LegacySamApiProperties</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="3024" x2="3258" y1="213.7031" y2="213.7031"/><ellipse cx="3034" cy="227.0234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" text-decoration="underline" textLength="30" x="3043" y="230.377">final</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="101" x="3077" y="230.377">String VERSION</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="3024" x2="3258" y1="237.3438" y2="237.3438"/></g><!--MD5=[dbd049b1aac9d758f526265ceb7ce91b]
class LegacySamCardTransactionCryptoExtension--><g id="elem_LegacySamCardTransactionCryptoExtension"><rect codeLine="240" fill="#E9F7EF" height="88.5625" id="LegacySamCardTransactionCryptoExtension" rx="2.5" ry="2.5" style="stroke:#27AE60;stroke-width:2.0;" width="778" x="2917" y="829.2031"/><ellipse cx="3154.75" cy="849.8438" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3155.7031,846.4844 L3155.7031,853.1406 L3157.4219,853.1406 Q3158.0313,853.1406 3158.2969,853.375 Q3158.5625,853.6094 3158.5625,854 Q3158.5625,854.375 3158.2969,854.6094 Q3158.0313,854.8438 3157.4219,854.8438 L3152.2813,854.8438 Q3151.6719,854.8438 3151.4063,854.6094 Q3151.1406,854.375 3151.1406,853.9844 Q3151.1406,853.6094 3151.4063,853.375 Q3151.6719,853.1406 3152.2813,853.1406 L3154,853.1406 L3154,846.4844 L3152.2813,846.4844 Q3151.6719,846.4844 3151.4063,846.25 Q3151.1406,846.0156 3151.1406,845.625 Q3151.1406,845.25 3151.4063,845.0156 Q3151.6719,844.7813 3152.2813,844.7813 L3157.4219,844.7813 Q3158.0313,844.7813 3158.2969,845.0156 Q3158.5625,845.25 3158.5625,845.625 Q3158.5625,846.0156 3158.2969,846.25 Q3158.0313,846.4844 3157.4219,846.4844 L3155.7031,846.4844 Z " fill="#000000"/><ellipse cx="3180.25" cy="849.3438" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="16" x="3207.25" y="846.877">&lt;&lt;</text><text fill="#000000" filter="url(#b12jbdtdtkuruh1)" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="209" x="3223.25" y="846.877">CardTransactionCryptoExtension</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="16" x="3432.25" y="846.877">&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="283" x="3186.25" y="862.5176">LegacySamCardTransactionCryptoExtension</text><line style="stroke:#27AE60;stroke-width:2.0;" x1="2918" x2="3694" y1="870.4844" y2="870.4844"/><line style="stroke:#27AE60;stroke-width:2.0;" x1="2918" x2="3694" y1="878.4844" y2="878.4844"/><ellipse cx="2928" cy="891.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="752" x="2937" y="895.1582">LegacySamCardTransactionCryptoExtension prepareComputeSignature (CommonSignatureComputationData&lt;?&gt; data)</text><ellipse cx="2928" cy="907.4453" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="721" x="2937" y="910.7988">LegacySamCardTransactionCryptoExtension prepareVerifySignature (CommonSignatureVerificationData&lt;?&gt; data)</text></g><!--MD5=[3dfe6076040c9abfebce4121b80cdb8d]
class LegacySamTransactionManagerFactory--><g id="elem_LegacySamTransactionManagerFactory"><rect codeLine="239" fill="#FDEDEC" height="126.2031" id="LegacySamTransactionManagerFactory" rx="2.5" ry="2.5" style="stroke:#E74C3C;stroke-width:2.0;" width="1119" x="492.5" y="994.2031"/><ellipse cx="915.25" cy="1010.2031" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M916.2031,1006.8438 L916.2031,1013.5 L917.9219,1013.5 Q918.5313,1013.5 918.7969,1013.7344 Q919.0625,1013.9688 919.0625,1014.3594 Q919.0625,1014.7344 918.7969,1014.9688 Q918.5313,1015.2031 917.9219,1015.2031 L912.7813,1015.2031 Q912.1719,1015.2031 911.9063,1014.9688 Q911.6406,1014.7344 911.6406,1014.3438 Q911.6406,1013.9688 911.9063,1013.7344 Q912.1719,1013.5 912.7813,1013.5 L914.5,1013.5 L914.5,1006.8438 L912.7813,1006.8438 Q912.1719,1006.8438 911.9063,1006.6094 Q911.6406,1006.375 911.6406,1005.9844 Q911.6406,1005.6094 911.9063,1005.375 Q912.1719,1005.1406 912.7813,1005.1406 L917.9219,1005.1406 Q918.5313,1005.1406 918.7969,1005.375 Q919.0625,1005.6094 919.0625,1005.9844 Q919.0625,1006.375 918.7969,1006.6094 Q918.5313,1006.8438 917.9219,1006.8438 L916.2031,1006.8438 Z " fill="#000000"/><ellipse cx="940.75" cy="1009.7031" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="254" x="946.75" y="1015.0566">LegacySamTransactionManagerFactory</text><line style="stroke:#E74C3C;stroke-width:2.0;" x1="493.5" x2="1610.5" y1="1026.2031" y2="1026.2031"/><line style="stroke:#E74C3C;stroke-width:2.0;" x1="493.5" x2="1610.5" y1="1034.2031" y2="1034.2031"/><ellipse cx="503.5" cy="1047.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="449" x="512.5" y="1050.877">LegacySamFreeTransactionManager createFreeTransactionManager (</text><text fill="#000000" filter="url(#b12jbdtdtkuruh0)" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="961.5" y="1050.877">CardReader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="190" x="1043.5" y="1050.877">samReader, LegacySam sam)</text><ellipse cx="503.5" cy="1063.1641" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="547" x="512.5" y="1066.5176">LegacySamSecureReadTransactionManager createSecureReadTransactionManager (</text><text fill="#000000" filter="url(#b12jbdtdtkuruh0)" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="1059.5" y="1066.5176">CardReader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="464" x="1141.5" y="1066.5176">samReader, LegacySam sam, LegacySamSecuritySetting securitySetting)</text><ellipse cx="503.5" cy="1078.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="545" x="512.5" y="1082.1582">LegacySamSecureWriteTransactionManager createSecureWriteTransactionManager (</text><text fill="#000000" filter="url(#b12jbdtdtkuruh0)" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="1057.5" y="1082.1582">CardReader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="464" x="1139.5" y="1082.1582">samReader, LegacySam sam, LegacySamSecuritySetting securitySetting)</text><ellipse cx="503.5" cy="1094.4453" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="579" x="512.5" y="1097.7988">LegacyControlSamStaticTransactionManager createControlSamStaticTransactionManager (</text><text fill="#000000" filter="url(#b12jbdtdtkuruh0)" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="1091.5" y="1097.7988">CardReader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="190" x="1173.5" y="1097.7988">samReader, LegacySam sam)</text><ellipse cx="503.5" cy="1110.0859" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="571" x="512.5" y="1113.4395">LegacyTargetSamStaticTransactionManager createTargetSamStaticTransactionManager (</text><text fill="#000000" filter="url(#b12jbdtdtkuruh0)" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="1083.5" y="1113.4395">CardReader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="190" x="1165.5" y="1113.4395">samReader, LegacySam sam)</text></g><!--MD5=[0ca469eb9daf2ada2044bbaaac3ba003]
class LegacySamTransactionManager--><g id="elem_LegacySamTransactionManager"><rect codeLine="75" fill="#FEFECE" height="79.2813" id="LegacySamTransactionManager" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="508" x="1493" y="174.2031"/><ellipse cx="1508" cy="190.2031" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1508.9531,186.8438 L1508.9531,193.5 L1510.6719,193.5 Q1511.2813,193.5 1511.5469,193.7344 Q1511.8125,193.9688 1511.8125,194.3594 Q1511.8125,194.7344 1511.5469,194.9688 Q1511.2813,195.2031 1510.6719,195.2031 L1505.5313,195.2031 Q1504.9219,195.2031 1504.6563,194.9688 Q1504.3906,194.7344 1504.3906,194.3438 Q1504.3906,193.9688 1504.6563,193.7344 Q1504.9219,193.5 1505.5313,193.5 L1507.25,193.5 L1507.25,186.8438 L1505.5313,186.8438 Q1504.9219,186.8438 1504.6563,186.6094 Q1504.3906,186.375 1504.3906,185.9844 Q1504.3906,185.6094 1504.6563,185.375 Q1504.9219,185.1406 1505.5313,185.1406 L1510.6719,185.1406 Q1511.2813,185.1406 1511.5469,185.375 Q1511.8125,185.6094 1511.8125,185.9844 Q1511.8125,186.375 1511.5469,186.6094 Q1511.2813,186.8438 1510.6719,186.8438 L1508.9531,186.8438 Z " fill="#000000"/><ellipse cx="1527" cy="189.7031" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="206" x="1533" y="195.0566">LegacySamTransactionManager</text><rect fill="#FFFFFF" height="15.4063" style="stroke:#D4AC0D;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="257" x="1747" y="171.2031"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="255" x="1748" y="183.0664">T extends LegacySamTransactionManager&lt;T&gt;</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1494" x2="2000" y1="206.2031" y2="206.2031"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1494" x2="2000" y1="214.2031" y2="214.2031"/><ellipse cx="1504" cy="227.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="248" x="1513" y="230.877">List&lt;byte[]&gt; getTransactionAuditData ()</text><ellipse cx="1504" cy="243.1641" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="148" x="1513" y="246.5176">T processCommands ()</text></g><!--MD5=[8560ba9595df2db95e6096dd1b62c14e]
class LegacySamReadTransactionManager--><g id="elem_LegacySamReadTransactionManager"><rect codeLine="79" fill="#FEFECE" height="313.8906" id="LegacySamReadTransactionManager" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="657" x="2105.5" y="454.2031"/><ellipse cx="2159.75" cy="470.2031" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2160.7031,466.8438 L2160.7031,473.5 L2162.4219,473.5 Q2163.0313,473.5 2163.2969,473.7344 Q2163.5625,473.9688 2163.5625,474.3594 Q2163.5625,474.7344 2163.2969,474.9688 Q2163.0313,475.2031 2162.4219,475.2031 L2157.2813,475.2031 Q2156.6719,475.2031 2156.4063,474.9688 Q2156.1406,474.7344 2156.1406,474.3438 Q2156.1406,473.9688 2156.4063,473.7344 Q2156.6719,473.5 2157.2813,473.5 L2159,473.5 L2159,466.8438 L2157.2813,466.8438 Q2156.6719,466.8438 2156.4063,466.6094 Q2156.1406,466.375 2156.1406,465.9844 Q2156.1406,465.6094 2156.4063,465.375 Q2156.6719,465.1406 2157.2813,465.1406 L2162.4219,465.1406 Q2163.0313,465.1406 2163.2969,465.375 Q2163.5625,465.6094 2163.5625,465.9844 Q2163.5625,466.375 2163.2969,466.6094 Q2163.0313,466.8438 2162.4219,466.8438 L2160.7031,466.8438 Z " fill="#000000"/><ellipse cx="2185.25" cy="469.7031" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="240" x="2191.25" y="475.0566">LegacySamReadTransactionManager</text><rect fill="#FFFFFF" height="15.4063" style="stroke:#D4AC0D;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="287" x="2478.5" y="451.2031"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="285" x="2479.5" y="463.0664">T extends LegacySamReadTransactionManager&lt;T&gt;</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="2106.5" x2="2761.5" y1="486.2031" y2="486.2031"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="2106.5" x2="2761.5" y1="494.2031" y2="494.2031"/><ellipse cx="2116.5" cy="507.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="212" x="2125.5" y="510.877">T prepareReadSamParameters ()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2125.5" y="526.5176"> </text><ellipse cx="2116.5" cy="538.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="336" x="2125.5" y="542.1582">T prepareReadCaadRecord (int caadRecordNumber)</text><ellipse cx="2116.5" cy="554.4453" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="542" x="2125.5" y="557.7988">T prepareReadCaadRecords (int fromCaadRecordNumber, int toCaadRecordNumber)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2125.5" y="573.4395"> </text><ellipse cx="2116.5" cy="585.7266" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="442" x="2125.5" y="589.0801">T prepareReadSystemKeyParameters (LegacySystemKey systemKey)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2125.5" y="604.7207"> </text><ellipse cx="2116.5" cy="617.0078" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="401" x="2125.5" y="620.3613">T prepareReadWorkKeyParameter (int workKeyRecordNumber)</text><ellipse cx="2116.5" cy="632.6484" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="631" x="2125.5" y="636.002">T prepareReadWorkKeyParameters (int fromWorkKeyRecordNumber, int toWorkKeyRecordNumber)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2125.5" y="651.6426"> </text><ellipse cx="2116.5" cy="663.9297" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="449" x="2125.5" y="667.2832">T prepareReadWorkKeyParameter (byte workKeyKif, byte workKeyKvc)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2125.5" y="682.9238"> </text><ellipse cx="2116.5" cy="695.2109" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="352" x="2125.5" y="698.5645">T prepareReadEventCounter (int eventCounterNumber)</text><ellipse cx="2116.5" cy="710.8516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="563" x="2125.5" y="714.2051">T prepareReadEventCounters (int fromEventCounterNumber, int toEventCounterNumber)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2125.5" y="729.8457"> </text><ellipse cx="2116.5" cy="742.1328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="336" x="2125.5" y="745.4863">T prepareReadEventCeiling (int eventCeilingNumber)</text><ellipse cx="2116.5" cy="757.7734" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="539" x="2125.5" y="761.127">T prepareReadEventCeilings (int fromEventCeilingNumber, int toEventCeilingNumber)</text></g><!--MD5=[155746c58e5d7251cb5fc63eeff736cd]
class LegacySamFreeWriteTransactionManager--><g id="elem_LegacySamFreeWriteTransactionManager"><rect codeLine="98" fill="#FEFECE" height="79.2813" id="LegacySamFreeWriteTransactionManager" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="799" x="1347.5" y="314.2031"/><ellipse cx="1446.25" cy="330.2031" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1447.2031,326.8438 L1447.2031,333.5 L1448.9219,333.5 Q1449.5313,333.5 1449.7969,333.7344 Q1450.0625,333.9688 1450.0625,334.3594 Q1450.0625,334.7344 1449.7969,334.9688 Q1449.5313,335.2031 1448.9219,335.2031 L1443.7813,335.2031 Q1443.1719,335.2031 1442.9063,334.9688 Q1442.6406,334.7344 1442.6406,334.3438 Q1442.6406,333.9688 1442.9063,333.7344 Q1443.1719,333.5 1443.7813,333.5 L1445.5,333.5 L1445.5,326.8438 L1443.7813,326.8438 Q1443.1719,326.8438 1442.9063,326.6094 Q1442.6406,326.375 1442.6406,325.9844 Q1442.6406,325.6094 1442.9063,325.375 Q1443.1719,325.1406 1443.7813,325.1406 L1448.9219,325.1406 Q1449.5313,325.1406 1449.7969,325.375 Q1450.0625,325.6094 1450.0625,325.9844 Q1450.0625,326.375 1449.7969,326.6094 Q1449.5313,326.8438 1448.9219,326.8438 L1447.2031,326.8438 Z " fill="#000000"/><ellipse cx="1471.75" cy="329.7031" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="270" x="1477.75" y="335.0566">LegacySamFreeWriteTransactionManager</text><rect fill="#FFFFFF" height="15.4063" style="stroke:#D4AC0D;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="310" x="1839.5" y="311.2031"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="308" x="1840.5" y="323.0664">T extends LegacySamFreeWriteTransactionManager&lt;T&gt;</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1348.5" x2="2145.5" y1="346.2031" y2="346.2031"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1348.5" x2="2145.5" y1="354.2031" y2="354.2031"/><ellipse cx="1358.5" cy="367.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="773" x="1367.5" y="370.877">T prepareWriteExternalPlainWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters, byte[] workKeyValue)</text><ellipse cx="1358.5" cy="383.1641" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="686" x="1367.5" y="386.5176">T prepareWriteRandomlyGeneratedWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters)</text></g><!--MD5=[289fd8b2248dd9124bc1cfda0abe149c]
class LegacySamWriteTransactionManager--><g id="elem_LegacySamWriteTransactionManager"><rect codeLine="102" fill="#FEFECE" height="235.6875" id="LegacySamWriteTransactionManager" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="998" x="1035" y="493.2031"/><ellipse cx="1260.75" cy="509.2031" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1261.7031,505.8438 L1261.7031,512.5 L1263.4219,512.5 Q1264.0313,512.5 1264.2969,512.7344 Q1264.5625,512.9688 1264.5625,513.3594 Q1264.5625,513.7344 1264.2969,513.9688 Q1264.0313,514.2031 1263.4219,514.2031 L1258.2813,514.2031 Q1257.6719,514.2031 1257.4063,513.9688 Q1257.1406,513.7344 1257.1406,513.3438 Q1257.1406,512.9688 1257.4063,512.7344 Q1257.6719,512.5 1258.2813,512.5 L1260,512.5 L1260,505.8438 L1258.2813,505.8438 Q1257.6719,505.8438 1257.4063,505.6094 Q1257.1406,505.375 1257.1406,504.9844 Q1257.1406,504.6094 1257.4063,504.375 Q1257.6719,504.1406 1258.2813,504.1406 L1263.4219,504.1406 Q1264.0313,504.1406 1264.2969,504.375 Q1264.5625,504.6094 1264.5625,504.9844 Q1264.5625,505.375 1264.2969,505.6094 Q1264.0313,505.8438 1263.4219,505.8438 L1261.7031,505.8438 Z " fill="#000000"/><ellipse cx="1286.25" cy="508.7031" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="240" x="1292.25" y="514.0566">LegacySamWriteTransactionManager</text><rect fill="#FFFFFF" height="15.4063" style="stroke:#D4AC0D;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="285" x="1751" y="490.2031"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="283" x="1752" y="502.0664">T extends LegacySamWriteTransactionManager&lt;T&gt;</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1036" x2="2032" y1="525.2031" y2="525.2031"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1036" x2="2032" y1="533.2031" y2="533.2031"/><ellipse cx="1046" cy="546.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="773" x="1055" y="549.877">T prepareWriteExternalPlainWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters, byte[] workKeyValue)</text><ellipse cx="1046" cy="562.1641" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="686" x="1055" y="565.5176">T prepareWriteRandomlyGeneratedWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1055" y="581.1582"> </text><ellipse cx="1046" cy="593.4453" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="322" x="1055" y="596.7988">T prepareWriteSamParameters (byte[] parameters)</text><ellipse cx="1046" cy="609.0859" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="413" x="1055" y="612.4395">T prepareWriteCaadRecord (int caadRecordNumber, byte[] caad)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1055" y="628.0801"> </text><ellipse cx="1046" cy="640.3672" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="889" x="1055" y="643.7207">T prepareWriteTransferredCipheredSystemKey (LegacySystemKey sourceSystemKey, byte sourceSystemKeyKif, byte sourceSystemKeyKvc)</text><ellipse cx="1046" cy="656.0078" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="755" x="1055" y="659.3613">T prepareWriteTransferredPlainWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters)</text><ellipse cx="1046" cy="671.6484" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="972" x="1055" y="675.002">T prepareWriteTransferredCipheredWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters, byte cipheringSystemKeyKvc)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1055" y="690.6426"> </text><ellipse cx="1046" cy="702.9297" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="423" x="1055" y="706.2832">T prepareWriteEventCeiling (int eventCeilingNumber, int newValue)</text><ellipse cx="1046" cy="718.5703" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="533" x="1055" y="721.9238">T prepareWriteEventCeilings (int fromEventCeilingNumber, List&lt;Integer&gt; newValues)</text></g><!--MD5=[cdba2e3b2692f0a974bd83ada5baadec]
class LegacySamSecuritySetting--><g id="elem_LegacySamSecuritySetting"><rect codeLine="231" fill="#F4ECF7" height="63.6406" id="LegacySamSecuritySetting" rx="2.5" ry="2.5" style="stroke:#8E44AD;stroke-width:2.0;" width="634" x="22" y="1338.2031"/><ellipse cx="244.75" cy="1354.2031" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M245.7031,1350.8438 L245.7031,1357.5 L247.4219,1357.5 Q248.0313,1357.5 248.2969,1357.7344 Q248.5625,1357.9688 248.5625,1358.3594 Q248.5625,1358.7344 248.2969,1358.9688 Q248.0313,1359.2031 247.4219,1359.2031 L242.2813,1359.2031 Q241.6719,1359.2031 241.4063,1358.9688 Q241.1406,1358.7344 241.1406,1358.3438 Q241.1406,1357.9688 241.4063,1357.7344 Q241.6719,1357.5 242.2813,1357.5 L244,1357.5 L244,1350.8438 L242.2813,1350.8438 Q241.6719,1350.8438 241.4063,1350.6094 Q241.1406,1350.375 241.1406,1349.9844 Q241.1406,1349.6094 241.4063,1349.375 Q241.6719,1349.1406 242.2813,1349.1406 L247.4219,1349.1406 Q248.0313,1349.1406 248.2969,1349.375 Q248.5625,1349.6094 248.5625,1349.9844 Q248.5625,1350.375 248.2969,1350.6094 Q248.0313,1350.8438 247.4219,1350.8438 L245.7031,1350.8438 Z " fill="#000000"/><ellipse cx="270.25" cy="1353.7031" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="169" x="276.25" y="1359.0566">LegacySamSecuritySetting</text><line style="stroke:#8E44AD;stroke-width:2.0;" x1="23" x2="655" y1="1370.2031" y2="1370.2031"/><line style="stroke:#8E44AD;stroke-width:2.0;" x1="23" x2="655" y1="1378.2031" y2="1378.2031"/><ellipse cx="33" cy="1391.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="336" x="42" y="1394.877">LegacySamSecuritySetting setControlSamResource (</text><text fill="#000000" filter="url(#b12jbdtdtkuruh0)" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="378" y="1394.877">CardReader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="190" x="460" y="1394.877">samReader, LegacySam sam)</text></g><!--MD5=[c17ae2c2af60537b87d9abee834860c0]
class CommonSignatureComputationData--><g id="elem_CommonSignatureComputationData"><rect codeLine="232" fill="#F4ECF7" height="126.2031" id="CommonSignatureComputationData" rx="2.5" ry="2.5" style="stroke:#8E44AD;stroke-width:2.0;" width="553" x="2106.5" y="994.2031"/><ellipse cx="2121.5" cy="1010.2031" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2122.4531,1006.8438 L2122.4531,1013.5 L2124.1719,1013.5 Q2124.7813,1013.5 2125.0469,1013.7344 Q2125.3125,1013.9688 2125.3125,1014.3594 Q2125.3125,1014.7344 2125.0469,1014.9688 Q2124.7813,1015.2031 2124.1719,1015.2031 L2119.0313,1015.2031 Q2118.4219,1015.2031 2118.1563,1014.9688 Q2117.8906,1014.7344 2117.8906,1014.3438 Q2117.8906,1013.9688 2118.1563,1013.7344 Q2118.4219,1013.5 2119.0313,1013.5 L2120.75,1013.5 L2120.75,1006.8438 L2119.0313,1006.8438 Q2118.4219,1006.8438 2118.1563,1006.6094 Q2117.8906,1006.375 2117.8906,1005.9844 Q2117.8906,1005.6094 2118.1563,1005.375 Q2118.4219,1005.1406 2119.0313,1005.1406 L2124.1719,1005.1406 Q2124.7813,1005.1406 2125.0469,1005.375 Q2125.3125,1005.6094 2125.3125,1005.9844 Q2125.3125,1006.375 2125.0469,1006.6094 Q2124.7813,1006.8438 2124.1719,1006.8438 L2122.4531,1006.8438 Z " fill="#000000"/><ellipse cx="2140.5" cy="1009.7031" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="227" x="2146.5" y="1015.0566">CommonSignatureComputationData</text><rect fill="#FFFFFF" height="15.4063" style="stroke:#8E44AD;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="281" x="2381.5" y="991.2031"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="279" x="2382.5" y="1003.0664">T extends CommonSignatureComputationData&lt;T&gt;</text><line style="stroke:#8E44AD;stroke-width:2.0;" x1="2107.5" x2="2658.5" y1="1026.2031" y2="1026.2031"/><line style="stroke:#8E44AD;stroke-width:2.0;" x1="2107.5" x2="2658.5" y1="1034.2031" y2="1034.2031"/><ellipse cx="2117.5" cy="1047.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="256" x="2126.5" y="1050.877">T setData (byte[] data, byte kif, byte kvc)</text><ellipse cx="2117.5" cy="1063.1641" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="176" x="2126.5" y="1066.5176">T setSignatureSize (int size)</text><ellipse cx="2117.5" cy="1078.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="233" x="2126.5" y="1082.1582">T setKeyDiversifier (byte[] diversifier)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2126.5" y="1097.7988"> </text><ellipse cx="2117.5" cy="1110.0859" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134" x="2126.5" y="1113.4395">byte[] getSignature ()</text></g><!--MD5=[c644258d6e85feb715526e24ebfc93b6]
class BasicSignatureComputationData--><g id="elem_BasicSignatureComputationData"><rect codeLine="233" fill="#F4ECF7" height="48" id="BasicSignatureComputationData" rx="2.5" ry="2.5" style="stroke:#8E44AD;stroke-width:2.0;" width="248" x="1654" y="1346.2031"/><ellipse cx="1669" cy="1362.2031" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1669.9531,1358.8438 L1669.9531,1365.5 L1671.6719,1365.5 Q1672.2813,1365.5 1672.5469,1365.7344 Q1672.8125,1365.9688 1672.8125,1366.3594 Q1672.8125,1366.7344 1672.5469,1366.9688 Q1672.2813,1367.2031 1671.6719,1367.2031 L1666.5313,1367.2031 Q1665.9219,1367.2031 1665.6563,1366.9688 Q1665.3906,1366.7344 1665.3906,1366.3438 Q1665.3906,1365.9688 1665.6563,1365.7344 Q1665.9219,1365.5 1666.5313,1365.5 L1668.25,1365.5 L1668.25,1358.8438 L1666.5313,1358.8438 Q1665.9219,1358.8438 1665.6563,1358.6094 Q1665.3906,1358.375 1665.3906,1357.9844 Q1665.3906,1357.6094 1665.6563,1357.375 Q1665.9219,1357.1406 1666.5313,1357.1406 L1671.6719,1357.1406 Q1672.2813,1357.1406 1672.5469,1357.375 Q1672.8125,1357.6094 1672.8125,1357.9844 Q1672.8125,1358.375 1672.5469,1358.6094 Q1672.2813,1358.8438 1671.6719,1358.8438 L1669.9531,1358.8438 Z " fill="#000000"/><ellipse cx="1688" cy="1361.7031" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="205" x="1694" y="1367.0566">BasicSignatureComputationData</text><line style="stroke:#8E44AD;stroke-width:2.0;" x1="1655" x2="1901" y1="1378.2031" y2="1378.2031"/><line style="stroke:#8E44AD;stroke-width:2.0;" x1="1655" x2="1901" y1="1386.2031" y2="1386.2031"/></g><!--MD5=[cdc2fcd8768bdabfe9b56e9f578bd14d]
class TraceableSignatureComputationData--><g id="elem_TraceableSignatureComputationData"><rect codeLine="234" fill="#F4ECF7" height="110.5625" id="TraceableSignatureComputationData" rx="2.5" ry="2.5" style="stroke:#8E44AD;stroke-width:2.0;" width="732" x="1937" y="1314.7031"/><ellipse cx="2175.75" cy="1330.7031" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2176.7031,1327.3438 L2176.7031,1334 L2178.4219,1334 Q2179.0313,1334 2179.2969,1334.2344 Q2179.5625,1334.4688 2179.5625,1334.8594 Q2179.5625,1335.2344 2179.2969,1335.4688 Q2179.0313,1335.7031 2178.4219,1335.7031 L2173.2813,1335.7031 Q2172.6719,1335.7031 2172.4063,1335.4688 Q2172.1406,1335.2344 2172.1406,1334.8438 Q2172.1406,1334.4688 2172.4063,1334.2344 Q2172.6719,1334 2173.2813,1334 L2175,1334 L2175,1327.3438 L2173.2813,1327.3438 Q2172.6719,1327.3438 2172.4063,1327.1094 Q2172.1406,1326.875 2172.1406,1326.4844 Q2172.1406,1326.1094 2172.4063,1325.875 Q2172.6719,1325.6406 2173.2813,1325.6406 L2178.4219,1325.6406 Q2179.0313,1325.6406 2179.2969,1325.875 Q2179.5625,1326.1094 2179.5625,1326.4844 Q2179.5625,1326.875 2179.2969,1327.1094 Q2179.0313,1327.3438 2178.4219,1327.3438 L2176.7031,1327.3438 Z " fill="#000000"/><ellipse cx="2201.25" cy="1330.2031" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="235" x="2207.25" y="1335.5566">TraceableSignatureComputationData</text><line style="stroke:#8E44AD;stroke-width:2.0;" x1="1938" x2="2668" y1="1346.7031" y2="1346.7031"/><line style="stroke:#8E44AD;stroke-width:2.0;" x1="1938" x2="2668" y1="1354.7031" y2="1354.7031"/><ellipse cx="1948" cy="1368.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="706" x="1957" y="1371.377">TraceableSignatureComputationData withSamTraceabilityMode (int offset, boolean usePartialSamSerialNumber)</text><ellipse cx="1948" cy="1383.6641" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="363" x="1957" y="1387.0176">TraceableSignatureComputationData withoutBusyMode ()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1957" y="1402.6582"> </text><ellipse cx="1948" cy="1414.9453" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147" x="1957" y="1418.2988">byte[] getSignedData ()</text></g><!--MD5=[49815161954875a46b9e77877b8c8585]
class CommonSignatureVerificationData--><g id="elem_CommonSignatureVerificationData"><rect codeLine="235" fill="#F4ECF7" height="110.5625" id="CommonSignatureVerificationData" rx="2.5" ry="2.5" style="stroke:#8E44AD;stroke-width:2.0;" width="533" x="2800.5" y="1001.7031"/><ellipse cx="2815.5" cy="1017.7031" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2816.4531,1014.3438 L2816.4531,1021 L2818.1719,1021 Q2818.7813,1021 2819.0469,1021.2344 Q2819.3125,1021.4688 2819.3125,1021.8594 Q2819.3125,1022.2344 2819.0469,1022.4688 Q2818.7813,1022.7031 2818.1719,1022.7031 L2813.0313,1022.7031 Q2812.4219,1022.7031 2812.1563,1022.4688 Q2811.8906,1022.2344 2811.8906,1021.8438 Q2811.8906,1021.4688 2812.1563,1021.2344 Q2812.4219,1021 2813.0313,1021 L2814.75,1021 L2814.75,1014.3438 L2813.0313,1014.3438 Q2812.4219,1014.3438 2812.1563,1014.1094 Q2811.8906,1013.875 2811.8906,1013.4844 Q2811.8906,1013.1094 2812.1563,1012.875 Q2812.4219,1012.6406 2813.0313,1012.6406 L2818.1719,1012.6406 Q2818.7813,1012.6406 2819.0469,1012.875 Q2819.3125,1013.1094 2819.3125,1013.4844 Q2819.3125,1013.875 2819.0469,1014.1094 Q2818.7813,1014.3438 2818.1719,1014.3438 L2816.4531,1014.3438 Z " fill="#000000"/><ellipse cx="2834.5" cy="1017.2031" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="217" x="2840.5" y="1022.5566">CommonSignatureVerificationData</text><rect fill="#FFFFFF" height="15.4063" style="stroke:#8E44AD;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="271" x="3065.5" y="998.7031"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="269" x="3066.5" y="1010.5664">T extends CommonSignatureVerificationData&lt;T&gt;</text><line style="stroke:#8E44AD;stroke-width:2.0;" x1="2801.5" x2="3332.5" y1="1033.7031" y2="1033.7031"/><line style="stroke:#8E44AD;stroke-width:2.0;" x1="2801.5" x2="3332.5" y1="1041.7031" y2="1041.7031"/><ellipse cx="2811.5" cy="1055.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="362" x="2820.5" y="1058.377">T setData (byte[] data, byte[] signature, byte kif, byte kvc)</text><ellipse cx="2811.5" cy="1070.6641" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="233" x="2820.5" y="1074.0176">T setKeyDiversifier (byte[] diversifier)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2820.5" y="1089.6582"> </text><ellipse cx="2811.5" cy="1101.9453" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="171" x="2820.5" y="1105.2988">boolean isSignatureValid ()</text></g><!--MD5=[792b97716737da270761df73939131ae]
class BasicSignatureVerificationData--><g id="elem_BasicSignatureVerificationData"><rect codeLine="236" fill="#F4ECF7" height="48" id="BasicSignatureVerificationData" rx="2.5" ry="2.5" style="stroke:#8E44AD;stroke-width:2.0;" width="238" x="2704" y="1346.2031"/><ellipse cx="2719" cy="1362.2031" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2719.9531,1358.8438 L2719.9531,1365.5 L2721.6719,1365.5 Q2722.2813,1365.5 2722.5469,1365.7344 Q2722.8125,1365.9688 2722.8125,1366.3594 Q2722.8125,1366.7344 2722.5469,1366.9688 Q2722.2813,1367.2031 2721.6719,1367.2031 L2716.5313,1367.2031 Q2715.9219,1367.2031 2715.6563,1366.9688 Q2715.3906,1366.7344 2715.3906,1366.3438 Q2715.3906,1365.9688 2715.6563,1365.7344 Q2715.9219,1365.5 2716.5313,1365.5 L2718.25,1365.5 L2718.25,1358.8438 L2716.5313,1358.8438 Q2715.9219,1358.8438 2715.6563,1358.6094 Q2715.3906,1358.375 2715.3906,1357.9844 Q2715.3906,1357.6094 2715.6563,1357.375 Q2715.9219,1357.1406 2716.5313,1357.1406 L2721.6719,1357.1406 Q2722.2813,1357.1406 2722.5469,1357.375 Q2722.8125,1357.6094 2722.8125,1357.9844 Q2722.8125,1358.375 2722.5469,1358.6094 Q2722.2813,1358.8438 2721.6719,1358.8438 L2719.9531,1358.8438 Z " fill="#000000"/><ellipse cx="2738" cy="1361.7031" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="195" x="2744" y="1367.0566">BasicSignatureVerificationData</text><line style="stroke:#8E44AD;stroke-width:2.0;" x1="2705" x2="2941" y1="1378.2031" y2="1378.2031"/><line style="stroke:#8E44AD;stroke-width:2.0;" x1="2705" x2="2941" y1="1386.2031" y2="1386.2031"/></g><!--MD5=[2fc7953a0035a8aa989ea0d75f9f7d1b]
class TraceableSignatureVerificationData--><g id="elem_TraceableSignatureVerificationData"><rect codeLine="237" fill="#F4ECF7" height="79.2813" id="TraceableSignatureVerificationData" rx="2.5" ry="2.5" style="stroke:#8E44AD;stroke-width:2.0;" width="948" x="2977" y="1330.7031"/><ellipse cx="3328.75" cy="1346.7031" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3329.7031,1343.3438 L3329.7031,1350 L3331.4219,1350 Q3332.0313,1350 3332.2969,1350.2344 Q3332.5625,1350.4688 3332.5625,1350.8594 Q3332.5625,1351.2344 3332.2969,1351.4688 Q3332.0313,1351.7031 3331.4219,1351.7031 L3326.2813,1351.7031 Q3325.6719,1351.7031 3325.4063,1351.4688 Q3325.1406,1351.2344 3325.1406,1350.8438 Q3325.1406,1350.4688 3325.4063,1350.2344 Q3325.6719,1350 3326.2813,1350 L3328,1350 L3328,1343.3438 L3326.2813,1343.3438 Q3325.6719,1343.3438 3325.4063,1343.1094 Q3325.1406,1342.875 3325.1406,1342.4844 Q3325.1406,1342.1094 3325.4063,1341.875 Q3325.6719,1341.6406 3326.2813,1341.6406 L3331.4219,1341.6406 Q3332.0313,1341.6406 3332.2969,1341.875 Q3332.5625,1342.1094 3332.5625,1342.4844 Q3332.5625,1342.875 3332.2969,1343.1094 Q3332.0313,1343.3438 3331.4219,1343.3438 L3329.7031,1343.3438 Z " fill="#000000"/><ellipse cx="3354.25" cy="1346.2031" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="225" x="3360.25" y="1351.5566">TraceableSignatureVerificationData</text><line style="stroke:#8E44AD;stroke-width:2.0;" x1="2978" x2="3924" y1="1362.7031" y2="1362.7031"/><line style="stroke:#8E44AD;stroke-width:2.0;" x1="2978" x2="3924" y1="1370.7031" y2="1370.7031"/><ellipse cx="2988" cy="1384.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="922" x="2997" y="1387.377">TraceableSignatureVerificationData withSamTraceabilityMode (int offset, boolean isPartialSamSerialNumber, boolean checkSamRevocationStatus)</text><ellipse cx="2988" cy="1399.6641" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="353" x="2997" y="1403.0176">TraceableSignatureVerificationData withoutBusyMode ()</text></g><!--MD5=[3a04f400e335556ca7c4adcb3d92e310]
class LegacySamSecureReadTransactionManager--><g id="elem_LegacySamSecureReadTransactionManager"><rect codeLine="117" fill="#FEFECE" height="48" id="LegacySamSecureReadTransactionManager" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="328" x="1789" y="849.7031"/><ellipse cx="1804" cy="865.7031" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1804.9531,862.3438 L1804.9531,869 L1806.6719,869 Q1807.2813,869 1807.5469,869.2344 Q1807.8125,869.4688 1807.8125,869.8594 Q1807.8125,870.2344 1807.5469,870.4688 Q1807.2813,870.7031 1806.6719,870.7031 L1801.5313,870.7031 Q1800.9219,870.7031 1800.6563,870.4688 Q1800.3906,870.2344 1800.3906,869.8438 Q1800.3906,869.4688 1800.6563,869.2344 Q1800.9219,869 1801.5313,869 L1803.25,869 L1803.25,862.3438 L1801.5313,862.3438 Q1800.9219,862.3438 1800.6563,862.1094 Q1800.3906,861.875 1800.3906,861.4844 Q1800.3906,861.1094 1800.6563,860.875 Q1800.9219,860.6406 1801.5313,860.6406 L1806.6719,860.6406 Q1807.2813,860.6406 1807.5469,860.875 Q1807.8125,861.1094 1807.8125,861.4844 Q1807.8125,861.875 1807.5469,862.1094 Q1807.2813,862.3438 1806.6719,862.3438 L1804.9531,862.3438 Z " fill="#000000"/><ellipse cx="1823" cy="865.2031" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="285" x="1829" y="870.5566">LegacySamSecureReadTransactionManager</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1790" x2="2116" y1="881.7031" y2="881.7031"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1790" x2="2116" y1="889.7031" y2="889.7031"/></g><!--MD5=[1628adf05aefa5de516c8137f2ec891f]
class LegacySamFreeTransactionManager--><g id="elem_LegacySamFreeTransactionManager"><rect codeLine="119" fill="#FEFECE" height="79.2813" id="LegacySamFreeTransactionManager" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="730" x="2152" y="834.2031"/><ellipse cx="2389.25" cy="850.2031" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2390.2031,846.8438 L2390.2031,853.5 L2391.9219,853.5 Q2392.5313,853.5 2392.7969,853.7344 Q2393.0625,853.9688 2393.0625,854.3594 Q2393.0625,854.7344 2392.7969,854.9688 Q2392.5313,855.2031 2391.9219,855.2031 L2386.7813,855.2031 Q2386.1719,855.2031 2385.9063,854.9688 Q2385.6406,854.7344 2385.6406,854.3438 Q2385.6406,853.9688 2385.9063,853.7344 Q2386.1719,853.5 2386.7813,853.5 L2388.5,853.5 L2388.5,846.8438 L2386.7813,846.8438 Q2386.1719,846.8438 2385.9063,846.6094 Q2385.6406,846.375 2385.6406,845.9844 Q2385.6406,845.6094 2385.9063,845.375 Q2386.1719,845.1406 2386.7813,845.1406 L2391.9219,845.1406 Q2392.5313,845.1406 2392.7969,845.375 Q2393.0625,845.6094 2393.0625,845.9844 Q2393.0625,846.375 2392.7969,846.6094 Q2392.5313,846.8438 2391.9219,846.8438 L2390.2031,846.8438 Z " fill="#000000"/><ellipse cx="2414.75" cy="849.7031" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="236" x="2420.75" y="855.0566">LegacySamFreeTransactionManager</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="2153" x2="2881" y1="866.2031" y2="866.2031"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="2153" x2="2881" y1="874.2031" y2="874.2031"/><ellipse cx="2163" cy="887.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="704" x="2172" y="890.877">LegacySamFreeTransactionManager prepareComputeSignature (CommonSignatureComputationData&lt;?&gt; data)</text><ellipse cx="2163" cy="903.1641" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="673" x="2172" y="906.5176">LegacySamFreeTransactionManager prepareVerifySignature (CommonSignatureVerificationData&lt;?&gt; data)</text></g><!--MD5=[d1e88ceba10e2a9725069380c4ef5b88]
class LegacySamSecureWriteTransactionManager--><g id="elem_LegacySamSecureWriteTransactionManager"><rect codeLine="123" fill="#FEFECE" height="48" id="LegacySamSecureWriteTransactionManager" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="328" x="1426" y="849.7031"/><ellipse cx="1441" cy="865.7031" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1441.9531,862.3438 L1441.9531,869 L1443.6719,869 Q1444.2813,869 1444.5469,869.2344 Q1444.8125,869.4688 1444.8125,869.8594 Q1444.8125,870.2344 1444.5469,870.4688 Q1444.2813,870.7031 1443.6719,870.7031 L1438.5313,870.7031 Q1437.9219,870.7031 1437.6563,870.4688 Q1437.3906,870.2344 1437.3906,869.8438 Q1437.3906,869.4688 1437.6563,869.2344 Q1437.9219,869 1438.5313,869 L1440.25,869 L1440.25,862.3438 L1438.5313,862.3438 Q1437.9219,862.3438 1437.6563,862.1094 Q1437.3906,861.875 1437.3906,861.4844 Q1437.3906,861.1094 1437.6563,860.875 Q1437.9219,860.6406 1438.5313,860.6406 L1443.6719,860.6406 Q1444.2813,860.6406 1444.5469,860.875 Q1444.8125,861.1094 1444.8125,861.4844 Q1444.8125,861.875 1444.5469,862.1094 Q1444.2813,862.3438 1443.6719,862.3438 L1441.9531,862.3438 Z " fill="#000000"/><ellipse cx="1460" cy="865.2031" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="285" x="1466" y="870.5566">LegacySamSecureWriteTransactionManager</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1427" x2="1753" y1="881.7031" y2="881.7031"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1427" x2="1753" y1="889.7031" y2="889.7031"/></g><!--MD5=[d2d73b38f5041627d063376b6795c82a]
class LegacyTargetSamStaticTransactionManager--><g id="elem_LegacyTargetSamStaticTransactionManager"><rect codeLine="125" fill="#FEFECE" height="63.6406" id="LegacyTargetSamStaticTransactionManager" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="631" x="46.5" y="841.7031"/><ellipse cx="210.75" cy="857.7031" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M211.7031,854.3438 L211.7031,861 L213.4219,861 Q214.0313,861 214.2969,861.2344 Q214.5625,861.4688 214.5625,861.8594 Q214.5625,862.2344 214.2969,862.4688 Q214.0313,862.7031 213.4219,862.7031 L208.2813,862.7031 Q207.6719,862.7031 207.4063,862.4688 Q207.1406,862.2344 207.1406,861.8438 Q207.1406,861.4688 207.4063,861.2344 Q207.6719,861 208.2813,861 L210,861 L210,854.3438 L208.2813,854.3438 Q207.6719,854.3438 207.4063,854.1094 Q207.1406,853.875 207.1406,853.4844 Q207.1406,853.1094 207.4063,852.875 Q207.6719,852.6406 208.2813,852.6406 L213.4219,852.6406 Q214.0313,852.6406 214.2969,852.875 Q214.5625,853.1094 214.5625,853.4844 Q214.5625,853.875 214.2969,854.1094 Q214.0313,854.3438 213.4219,854.3438 L211.7031,854.3438 Z " fill="#000000"/><ellipse cx="236.25" cy="857.2031" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="283" x="242.25" y="862.5566">LegacyTargetSamStaticTransactionManager</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="47.5" x2="676.5" y1="873.7031" y2="873.7031"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="47.5" x2="676.5" y1="881.7031" y2="881.7031"/><ellipse cx="57.5" cy="895.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="605" x="66.5" y="898.377">LegacyTargetSamStaticTransactionManager importCommands (String cipheredSamCommands)</text></g><!--MD5=[62206db92848e4aa09178b2c3d943706]
class LegacyControlSamStaticTransactionManager--><g id="elem_LegacyControlSamStaticTransactionManager"><rect codeLine="128" fill="#FEFECE" height="79.2813" id="LegacyControlSamStaticTransactionManager" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="678" x="713" y="834.2031"/><ellipse cx="898.75" cy="850.2031" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M899.7031,846.8438 L899.7031,853.5 L901.4219,853.5 Q902.0313,853.5 902.2969,853.7344 Q902.5625,853.9688 902.5625,854.3594 Q902.5625,854.7344 902.2969,854.9688 Q902.0313,855.2031 901.4219,855.2031 L896.2813,855.2031 Q895.6719,855.2031 895.4063,854.9688 Q895.1406,854.7344 895.1406,854.3438 Q895.1406,853.9688 895.4063,853.7344 Q895.6719,853.5 896.2813,853.5 L898,853.5 L898,846.8438 L896.2813,846.8438 Q895.6719,846.8438 895.4063,846.6094 Q895.1406,846.375 895.1406,845.9844 Q895.1406,845.6094 895.4063,845.375 Q895.6719,845.1406 896.2813,845.1406 L901.4219,845.1406 Q902.0313,845.1406 902.2969,845.375 Q902.5625,845.6094 902.5625,845.9844 Q902.5625,846.375 902.2969,846.6094 Q902.0313,846.8438 901.4219,846.8438 L899.7031,846.8438 Z " fill="#000000"/><ellipse cx="924.25" cy="849.7031" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="287" x="930.25" y="855.0566">LegacyControlSamStaticTransactionManager</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="714" x2="1390" y1="866.2031" y2="866.2031"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="714" x2="1390" y1="874.2031" y2="874.2031"/><ellipse cx="724" cy="887.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="652" x="733" y="890.877">LegacyControlSamStaticTransactionManager prepareGiveTargetSamPseudoRandom (? staticRandom)</text><ellipse cx="724" cy="903.1641" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="165" x="733" y="906.5176">String exportCommands ()</text></g><!--MD5=[f828a509400a69824ac8cdade397711f]
class LegacySamSelection--><g id="elem_LegacySamSelection"><rect codeLine="228" fill="#F4ECF7" height="119.8438" id="LegacySamSelection" rx="2.5" ry="2.5" style="stroke:#8E44AD;stroke-width:2.0;" width="543" x="1075.5" y="1310.2031"/><ellipse cx="1271.25" cy="1330.8438" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1272.2031,1327.4844 L1272.2031,1334.1406 L1273.9219,1334.1406 Q1274.5313,1334.1406 1274.7969,1334.375 Q1275.0625,1334.6094 1275.0625,1335 Q1275.0625,1335.375 1274.7969,1335.6094 Q1274.5313,1335.8438 1273.9219,1335.8438 L1268.7813,1335.8438 Q1268.1719,1335.8438 1267.9063,1335.6094 Q1267.6406,1335.375 1267.6406,1334.9844 Q1267.6406,1334.6094 1267.9063,1334.375 Q1268.1719,1334.1406 1268.7813,1334.1406 L1270.5,1334.1406 L1270.5,1327.4844 L1268.7813,1327.4844 Q1268.1719,1327.4844 1267.9063,1327.25 Q1267.6406,1327.0156 1267.6406,1326.625 Q1267.6406,1326.25 1267.9063,1326.0156 Q1268.1719,1325.7813 1268.7813,1325.7813 L1273.9219,1325.7813 Q1274.5313,1325.7813 1274.7969,1326.0156 Q1275.0625,1326.25 1275.0625,1326.625 Q1275.0625,1327.0156 1274.7969,1327.25 Q1274.5313,1327.4844 1273.9219,1327.4844 L1272.2031,1327.4844 Z " fill="#000000"/><ellipse cx="1296.75" cy="1330.3438" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="16" x="1308.25" y="1327.877">&lt;&lt;</text><text fill="#000000" filter="url(#b12jbdtdtkuruh0)" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="89" x="1324.25" y="1327.877">CardSelection</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="16" x="1413.25" y="1327.877">&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="132" x="1302.75" y="1343.5176">LegacySamSelection</text><line style="stroke:#8E44AD;stroke-width:2.0;" x1="1076.5" x2="1617.5" y1="1351.4844" y2="1351.4844"/><line style="stroke:#8E44AD;stroke-width:2.0;" x1="1076.5" x2="1617.5" y1="1359.4844" y2="1359.4844"/><ellipse cx="1086.5" cy="1372.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="517" x="1095.5" y="1376.1582">LegacySamSelection filterByProductType (LegacySam.ProductType productType)</text><ellipse cx="1086.5" cy="1388.4453" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="442" x="1095.5" y="1391.7988">LegacySamSelection filterBySerialNumber (String serialNumberRegex)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1095.5" y="1407.4395"> </text><ellipse cx="1086.5" cy="1419.7266" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="353" x="1095.5" y="1423.0801">LegacySamSelection setUnlockData (String unlockData)</text></g><!--MD5=[756cbdb2eeffdcd67180b97f5e83c8e0]
class LegacySam--><g id="elem_LegacySam"><rect codeLine="229" fill="#F4ECF7" height="307.5313" id="LegacySam" rx="2.5" ry="2.5" style="stroke:#8E44AD;stroke-width:2.0;" width="349" x="691.5" y="1216.2031"/><ellipse cx="806.25" cy="1236.8438" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M807.2031,1233.4844 L807.2031,1240.1406 L808.9219,1240.1406 Q809.5313,1240.1406 809.7969,1240.375 Q810.0625,1240.6094 810.0625,1241 Q810.0625,1241.375 809.7969,1241.6094 Q809.5313,1241.8438 808.9219,1241.8438 L803.7813,1241.8438 Q803.1719,1241.8438 802.9063,1241.6094 Q802.6406,1241.375 802.6406,1240.9844 Q802.6406,1240.6094 802.9063,1240.375 Q803.1719,1240.1406 803.7813,1240.1406 L805.5,1240.1406 L805.5,1233.4844 L803.7813,1233.4844 Q803.1719,1233.4844 802.9063,1233.25 Q802.6406,1233.0156 802.6406,1232.625 Q802.6406,1232.25 802.9063,1232.0156 Q803.1719,1231.7813 803.7813,1231.7813 L808.9219,1231.7813 Q809.5313,1231.7813 809.7969,1232.0156 Q810.0625,1232.25 810.0625,1232.625 Q810.0625,1233.0156 809.7969,1233.25 Q809.5313,1233.4844 808.9219,1233.4844 L807.2031,1233.4844 Z " fill="#000000"/><ellipse cx="831.75" cy="1236.3438" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="16" x="837.75" y="1233.877">&lt;&lt;</text><text fill="#000000" filter="url(#b12jbdtdtkuruh0)" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="68" x="853.75" y="1233.877">SmartCard</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="16" x="921.75" y="1233.877">&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="74" x="850.75" y="1249.5176">LegacySam</text><line style="stroke:#8E44AD;stroke-width:2.0;" x1="692.5" x2="1039.5" y1="1257.4844" y2="1257.4844"/><line style="stroke:#8E44AD;stroke-width:2.0;" x1="692.5" x2="1039.5" y1="1265.4844" y2="1265.4844"/><ellipse cx="702.5" cy="1278.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="200" x="711.5" y="1282.1582">ProductType getProductType ()</text><ellipse cx="702.5" cy="1294.4453" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147" x="711.5" y="1297.7988">String getProductInfo ()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="711.5" y="1313.4395"> </text><ellipse cx="702.5" cy="1325.7266" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="711.5" y="1329.0801">byte[] getSerialNumber ()</text><ellipse cx="702.5" cy="1341.3672" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="711.5" y="1344.7207">byte getPlatform ()</text><ellipse cx="702.5" cy="1357.0078" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="166" x="711.5" y="1360.3613">byte getApplicationType ()</text><ellipse cx="702.5" cy="1372.6484" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="191" x="711.5" y="1376.002">byte getApplicationSubType ()</text><ellipse cx="702.5" cy="1388.2891" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="711.5" y="1391.6426">byte getSoftwareIssuer ()</text><ellipse cx="702.5" cy="1403.9297" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="168" x="711.5" y="1407.2832">byte getSoftwareVersion ()</text><ellipse cx="702.5" cy="1419.5703" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="174" x="711.5" y="1422.9238">byte getSoftwareRevision ()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="711.5" y="1438.5645"> </text><ellipse cx="702.5" cy="1450.8516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="323" x="711.5" y="1454.2051">Integer getEventCounter (int eventCounterNumber)</text><ellipse cx="702.5" cy="1466.4922" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="313" x="711.5" y="1469.8457">SortedMap&lt;Integer, Integer&gt; getEventCounters ()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="711.5" y="1485.4863"> </text><ellipse cx="702.5" cy="1497.7734" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="307" x="711.5" y="1501.127">Integer getEventCeiling (int eventCeilingNumber)</text><ellipse cx="702.5" cy="1513.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="305" x="711.5" y="1516.7676">SortedMap&lt;Integer, Integer&gt; getEventCeilings ()</text></g><!--MD5=[64db2d10778acf6b7b903aeb76cb16f8]
class SamProductType--><g id="elem_SamProductType"><rect codeLine="230" fill="#F4ECF7" height="141.8438" id="SamProductType" rx="2.5" ry="2.5" style="stroke:#8E44AD;stroke-width:2.0;" width="124" x="865" y="1600.2031"/><ellipse cx="880" cy="1616.2031" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M880.9531,1612.8438 L880.9531,1619.5 L882.6719,1619.5 Q883.2813,1619.5 883.5469,1619.7344 Q883.8125,1619.9688 883.8125,1620.3594 Q883.8125,1620.7344 883.5469,1620.9688 Q883.2813,1621.2031 882.6719,1621.2031 L877.5313,1621.2031 Q876.9219,1621.2031 876.6563,1620.9688 Q876.3906,1620.7344 876.3906,1620.3438 Q876.3906,1619.9688 876.6563,1619.7344 Q876.9219,1619.5 877.5313,1619.5 L879.25,1619.5 L879.25,1612.8438 L877.5313,1612.8438 Q876.9219,1612.8438 876.6563,1612.6094 Q876.3906,1612.375 876.3906,1611.9844 Q876.3906,1611.6094 876.6563,1611.375 Q876.9219,1611.1406 877.5313,1611.1406 L882.6719,1611.1406 Q883.2813,1611.1406 883.5469,1611.375 Q883.8125,1611.6094 883.8125,1611.9844 Q883.8125,1612.375 883.5469,1612.6094 Q883.2813,1612.8438 882.6719,1612.8438 L880.9531,1612.8438 Z " fill="#000000"/><ellipse cx="899" cy="1615.7031" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="81" x="905" y="1621.0566">ProductType</text><line style="stroke:#8E44AD;stroke-width:2.0;" x1="866" x2="988" y1="1632.2031" y2="1632.2031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="871" y="1648.877">SAM_C1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="871" y="1664.5176">HSM_C1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="871" y="1680.1582">SAM_S1E1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="871" y="1695.7988">SAM_S1Dx</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="871" y="1711.4395">CSAM_F</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="871" y="1727.0801">UNKNOWN</text><line style="stroke:#8E44AD;stroke-width:2.0;" x1="866" x2="988" y1="1734.0469" y2="1734.0469"/></g><!--MD5=[9f9e452891b394849e9149e2c852154b]
reverse link LegacySamTransactionManager to LegacySamReadTransactionManager--><g id="link_LegacySamTransactionManager_LegacySamReadTransactionManager"><path d="M2020.55,255.2031 C2070.36,269.3531 2120.32,288.4531 2164,314.2031 C2224.07,349.6231 2278.49,402.6931 2322.49,454.1531 " fill="none" id="LegacySamTransactionManager-backto-LegacySamReadTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="2018.57,261.9231,2001.11,249.9231,2022.25,248.4131,2018.57,261.9231" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[f7ac68152805076048aaa8013cf2a34e]
reverse link LegacySamTransactionManager to LegacySamFreeWriteTransactionManager--><g id="link_LegacySamTransactionManager_LegacySamFreeWriteTransactionManager"><path d="M1747,273.6331 C1747,287.3531 1747,301.6131 1747,314.1831 " fill="none" id="LegacySamTransactionManager-backto-LegacySamFreeWriteTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="1740,273.5131,1747,253.5131,1754,273.5131,1740,273.5131" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[0f8f45f4589ff3d71cd79e03f4a5e8af]
reverse link LegacySamFreeWriteTransactionManager to LegacySamWriteTransactionManager--><g id="link_LegacySamFreeWriteTransactionManager_LegacySamWriteTransactionManager"><path d="M1701.81,408.9131 C1681.31,433.5031 1656.21,463.6131 1631.74,492.9631 " fill="none" id="LegacySamFreeWriteTransactionManager-backto-LegacySamWriteTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="1696.7,404.1131,1714.88,393.2331,1707.45,413.0731,1696.7,404.1131" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[20d25d6eaea103eca888d235be4725d2]
reverse link LegacySamReadTransactionManager to LegacySamSecureReadTransactionManager--><g id="link_LegacySamReadTransactionManager_LegacySamSecureReadTransactionManager"><path d="M2128.03,777.9131 C2075.86,806.1631 2028.15,832.0041 1995.76,849.5441 " fill="none" id="LegacySamReadTransactionManager-backto-LegacySamSecureReadTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="2124.95,771.6131,2145.87,768.2531,2131.62,783.9331,2124.95,771.6131" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[031a2811e980e04bb25a6d3a1f328743]
reverse link LegacySamReadTransactionManager to LegacySamFreeTransactionManager--><g id="link_LegacySamReadTransactionManager_LegacySamFreeTransactionManager"><path d="M2489.86,787.5331 C2495.3,804.5851 2500.35,820.4611 2504.6,833.7741 " fill="none" id="LegacySamReadTransactionManager-backto-LegacySamFreeTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="2483.12,789.4331,2483.72,768.2531,2496.46,785.1831,2483.12,789.4331" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[528c0e2c879dda1647f1abd7732b2860]
reverse link LegacySamFreeWriteTransactionManager to LegacySamFreeTransactionManager--><g id="link_LegacySamFreeWriteTransactionManager_LegacySamFreeTransactionManager"><path d="M1985.79,402.1331 C2010.62,415.4631 2033.22,432.4831 2051,454.2031 C2140,562.9431 1994.86,662.9831 2088,768.2031 C2112.71,796.1131 2180.55,817.8991 2255.19,834.1851 " fill="none" id="LegacySamFreeWriteTransactionManager-backto-LegacySamFreeTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="1982.65,408.3931,1967.81,393.2731,1988.84,395.8331,1982.65,408.3931" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[6914754a0680d6b255ec09e573377449]
reverse link LegacySamWriteTransactionManager to LegacySamSecureWriteTransactionManager--><g id="link_LegacySamWriteTransactionManager_LegacySamSecureWriteTransactionManager"><path d="M1563.46,749.2331 C1571.83,788.1831 1580.03,826.3111 1585.05,849.6571 " fill="none" id="LegacySamWriteTransactionManager-backto-LegacySamSecureWriteTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="1556.57,750.5231,1559.22,729.4931,1570.26,747.5831,1556.57,750.5231" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[1249c0992cb8db592722e1a172749617]
reverse link LegacySamTransactionManager to LegacyTargetSamStaticTransactionManager--><g id="link_LegacySamTransactionManager_LegacyTargetSamStaticTransactionManager"><path d="M1532.57,257.7531 C1466.84,273.1031 1394.79,292.1531 1330,314.2031 C939.227,447.1831 529.41,744.8631 402.091,841.6531 " fill="none" id="LegacySamTransactionManager-backto-LegacyTargetSamStaticTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="1531.24,250.8731,1552.3,253.2031,1534.38,264.5231,1531.24,250.8731" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[31266345cd46030056c746b41eb8ed73]
reverse link LegacySamWriteTransactionManager to LegacyControlSamStaticTransactionManager--><g id="link_LegacySamWriteTransactionManager_LegacyControlSamStaticTransactionManager"><path d="M1299.7,738.8331 C1235.52,773.5231 1170.71,808.5471 1123.48,834.0691 " fill="none" id="LegacySamWriteTransactionManager-backto-LegacyControlSamStaticTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="1296.4,732.6631,1317.32,729.3131,1303.06,744.9731,1296.4,732.6631" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[007eb89bfb10701b962958f5b6fc0ebb]
reverse link CommonSignatureComputationData to BasicSignatureComputationData--><g id="link_CommonSignatureComputationData_BasicSignatureComputationData"><path d="M2086.82,1099.8681 C2028.32,1116.8221 1969.72,1140.6671 1920,1174.2031 C1853.86,1218.8171 1807.52,1305.0131 1788.14,1346.2011 " fill="none" id="CommonSignatureComputationData-backto-BasicSignatureComputationData" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="2085.08,1093.0881,2106.22,1094.4911,2088.82,1106.5791,2085.08,1093.0881" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[f429252bb447dd4a1aa4e00c09503393]
reverse link CommonSignatureComputationData to TraceableSignatureComputationData--><g id="link_CommonSignatureComputationData_TraceableSignatureComputationData"><path d="M2361.98,1139.9071 C2347.8,1195.0541 2329.46,1266.3221 2317.03,1314.6621 " fill="none" id="CommonSignatureComputationData-backto-TraceableSignatureComputationData" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="2355.24,1138.0171,2367,1120.3911,2368.8,1141.5041,2355.24,1138.0171" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[e2b6e3fe5a6a0a5bd0ef8dd67224f7af]
reverse link CommonSignatureVerificationData to BasicSignatureVerificationData--><g id="link_CommonSignatureVerificationData_BasicSignatureVerificationData"><path d="M2999.82,1128.0461 C2986.26,1142.9591 2972.38,1158.8501 2960,1174.2031 C2912.07,1233.6191 2862.07,1308.6781 2837.88,1345.9711 " fill="none" id="CommonSignatureVerificationData-backto-BasicSignatureVerificationData" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="2995.05,1122.8881,3013.75,1112.9221,3005.35,1132.3741,2995.05,1122.8881" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[e31b41de38b178ddac6d238f38182a2b]
reverse link CommonSignatureVerificationData to TraceableSignatureVerificationData--><g id="link_CommonSignatureVerificationData_TraceableSignatureVerificationData"><path d="M3150.26,1125.6361 C3227.57,1188.2481 3339.97,1279.2811 3403.19,1330.4791 " fill="none" id="CommonSignatureVerificationData-backto-TraceableSignatureVerificationData" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="3145.46,1130.7581,3134.33,1112.7311,3154.27,1119.8791,3145.46,1130.7581" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[5eec432a2e7681a202b7f172e8f9a6f9]
reverse link LegacySamSecureReadTransactionManager to LegacySamTransactionManagerFactory--><g id="link_LegacySamSecureReadTransactionManager_LegacySamTransactionManagerFactory"><path codeLine="201" d="M1889.26,899.6661 C1854.94,912.3511 1811.62,927.1641 1772,937.2031 C1684.8,959.2961 1590.59,978.2881 1499.96,994.1991 " fill="none" id="LegacySamSecureReadTransactionManager-backto-LegacySamTransactionManagerFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="1894.25,897.8101,1884.4202,897.1976,1889.5635,899.5527,1887.2084,904.696,1894.25,897.8101" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="1723.8588,955.285,1714.3756,954.5634,1715.7626,960.2753,1723.8588,955.285" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="1728" y="960.9717">provide</text></g><!--MD5=[930cc0e3723a66cd8ccad631e2179266]
reverse link LegacySamFreeTransactionManager to LegacySamTransactionManagerFactory--><g id="link_LegacySamFreeTransactionManager_LegacySamTransactionManagerFactory"><path codeLine="202" d="M2288.65,914.0831 C2238.12,922.2321 2184.81,930.3971 2135,937.2031 C1965.28,960.3961 1780.1,982.0711 1611.65,1000.4011 " fill="none" id="LegacySamFreeTransactionManager-backto-LegacySamTransactionManagerFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="2293.84,913.2431,2284.3161,910.7342,2288.9044,914.0429,2285.5957,918.6312,2293.84,913.2431" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="2056.9598,955.8325,2047.6157,954.0611,2048.3591,959.8918,2056.9598,955.8325" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="2061" y="960.9717">provide</text></g><!--MD5=[44d345cd8829add454056d1b5883f290]
reverse link LegacySamSecureWriteTransactionManager to LegacySamTransactionManagerFactory--><g id="link_LegacySamSecureWriteTransactionManager_LegacySamTransactionManagerFactory"><path codeLine="203" d="M1518.99,899.4191 C1485.64,910.9801 1445.31,924.8841 1409,937.2031 C1353.94,955.8861 1294.01,975.9611 1239.26,994.2031 " fill="none" id="LegacySamSecureWriteTransactionManager-backto-LegacySamTransactionManagerFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="1523.86,897.7311,1514.0478,896.8826,1519.133,899.3606,1516.655,904.4459,1523.86,897.7311" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="1379.7355,954.8603,1370.2257,954.9795,1372.112,960.5465,1379.7355,954.8603" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="1384" y="960.9717">provide</text></g><!--MD5=[2229ecd762c36d538892dc7cff8dc00d]
reverse link LegacyControlSamStaticTransactionManager to LegacySamTransactionManagerFactory--><g id="link_LegacyControlSamStaticTransactionManager_LegacySamTransactionManagerFactory"><path codeLine="204" d="M1052,918.6821 C1052,941.3281 1052,969.3221 1052,994.1291 " fill="none" id="LegacyControlSamStaticTransactionManager-backto-LegacySamTransactionManagerFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="1052,913.6391,1048,922.6391,1052,918.6391,1056,922.6391,1052,913.6391" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="1057,951.4648,1054.0611,960.5099,1059.9389,960.5099,1057,951.4648" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="1066" y="960.9717">provide</text></g><!--MD5=[9833073e631068ca356ddb0b0d48cf85]
reverse link LegacyTargetSamStaticTransactionManager to LegacySamTransactionManagerFactory--><g id="link_LegacyTargetSamStaticTransactionManager_LegacySamTransactionManagerFactory"><path codeLine="205" d="M485.112,907.0871 C576.854,931.2191 704.957,964.9161 816.18,994.1721 " fill="none" id="LegacyTargetSamStaticTransactionManager-backto-LegacySamTransactionManagerFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="480.223,905.8011,487.9083,911.9603,485.0583,907.0739,489.9447,904.2238,480.223,905.8011" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="687.1645,955.1929,695.1644,960.3361,696.6596,954.6516,687.1645,955.1929" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="701" y="960.9717">provide</text></g><!--MD5=[6c1077641e5d6b0173b7fc2731bf85e3]
link LegacySamTransactionManagerFactory to LegacySam--><g id="link_LegacySamTransactionManagerFactory_LegacySam"><path codeLine="206" d="M1014.81,1120.3911 C998.93,1146.9401 979.606,1179.2491 960.213,1211.6741 " fill="none" id="LegacySamTransactionManagerFactory-to-LegacySam" style="stroke:#27AE60;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="957.601,1216.0421,965.6534,1210.3712,960.1674,1211.751,958.7876,1206.265,957.601,1216.0421" style="stroke:#27AE60;stroke-width:2.0;"/><polygon fill="#000000" points="993.4335,1162.7559,1000.5986,1156.5019,995.5541,1153.4848,993.4335,1162.7559" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="1005" y="1162.9717">use</text></g><!--MD5=[a622277c2ee75aae5c5fb37b0c7dc1dc]
link LegacySamTransactionManagerFactory to LegacySamSecuritySetting--><g id="link_LegacySamTransactionManagerFactory_LegacySamSecuritySetting"><path codeLine="207" d="M820.698,1120.2661 C771.83,1135.8921 721.117,1154.0401 675,1174.2031 C568.636,1220.7081 453.411,1292.8261 389.322,1335.0951 " fill="none" id="LegacySamTransactionManagerFactory-to-LegacySamSecuritySetting" style="stroke:#27AE60;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="384.797,1338.0861,394.5105,1336.459,388.9678,1335.3285,390.0983,1329.7857,384.797,1338.0861" style="stroke:#27AE60;stroke-width:2.0;"/><polygon fill="#000000" points="725.5243,1160.6938,734.931,1159.2923,732.3108,1154.0308,725.5243,1160.6938" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="739" y="1162.9717">use</text></g><!--MD5=[b61385103effde4c889419da2f560871]
link LegacySamFreeTransactionManager to CommonSignatureComputationData--><g id="link_LegacySamFreeTransactionManager_CommonSignatureComputationData"><path codeLine="209" d="M2488.25,913.6391 C2471.83,935.8861 2450.79,964.3791 2431.85,990.0371 " fill="none" id="LegacySamFreeTransactionManager-to-CommonSignatureComputationData" style="stroke:#27AE60;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="2428.83,994.1291,2437.3903,989.2586,2431.797,990.1046,2430.951,984.5114,2428.83,994.1291" style="stroke:#27AE60;stroke-width:2.0;"/><polygon fill="#000000" points="2464.0304,960.4874,2471.7669,954.956,2467.0381,951.465,2464.0304,960.4874" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="2476" y="960.9717">use</text></g><!--MD5=[422919c85a46836a095db3d27a5785f3]
link LegacySamFreeTransactionManager to CommonSignatureVerificationData--><g id="link_LegacySamFreeTransactionManager_CommonSignatureVerificationData"><path codeLine="210" d="M2633.98,913.3061 C2710.44,938.5371 2811.57,971.9101 2896.86,1000.0581 " fill="none" id="LegacySamFreeTransactionManager-to-CommonSignatureVerificationData" style="stroke:#27AE60;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="2901.69,1001.6491,2894.4024,995.0241,2896.9432,1000.0783,2891.889,1002.6191,2901.69,1001.6491" style="stroke:#27AE60;stroke-width:2.0;"/><polygon fill="#000000" points="2784.7481,958.0318,2777.0797,952.4063,2775.2377,957.9881,2784.7481,958.0318" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="2789" y="960.9717">use</text></g><!--MD5=[3226b1a528e01fe19bd12aca23b41295]
link LegacySamCardTransactionCryptoExtension to CommonSignatureComputationData--><g id="link_LegacySamCardTransactionCryptoExtension_CommonSignatureComputationData"><path codeLine="212" d="M3047.21,918.2131 C2997.78,925.4261 2946.38,932.1791 2898,937.2031 C2809.45,946.3981 2785.38,931.1611 2698,948.2031 C2645.92,958.3611 2590.69,975.1201 2541.26,992.4391 " fill="none" id="LegacySamCardTransactionCryptoExtension-to-CommonSignatureComputationData" style="stroke:#27AE60;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="2536.5,994.1161,2546.3171,994.907,2541.2174,992.4589,2543.6655,987.3592,2536.5,994.1161" style="stroke:#27AE60;stroke-width:2.0;"/><polygon fill="#000000" points="2698.053,957.1906,2707.4288,958.7855,2706.5757,952.9699,2698.053,957.1906" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="2712" y="960.9717">use</text></g><!--MD5=[97a4ee76ffcefc4f5b4f14314b57fc69]
link LegacySamCardTransactionCryptoExtension to CommonSignatureVerificationData--><g id="link_LegacySamCardTransactionCryptoExtension_CommonSignatureVerificationData"><path codeLine="213" d="M3248.45,918.4081 C3216.86,942.3971 3177.29,972.4491 3143.17,998.3611 " fill="none" id="LegacySamCardTransactionCryptoExtension-to-CommonSignatureVerificationData" style="stroke:#27AE60;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="3139.03,1001.5001,3148.6203,999.2584,3143.0169,998.4828,3143.7926,992.8793,3139.03,1001.5001" style="stroke:#27AE60;stroke-width:2.0;"/><polygon fill="#000000" points="3208.0181,959.4888,3216.9989,956.3589,3213.444,951.6779,3208.0181,959.4888" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="3221" y="960.9717">use</text></g><!--MD5=[d1441bb54ec12ef55a7fa9dacfe2aecf]
link LegacySamSelection to SamProductType--><g id="link_LegacySamSelection_SamProductType"><path codeLine="215" d="M1264.02,1430.2761 C1184.8,1486.6771 1066.94,1570.5821 993.64,1622.7581 " fill="none" id="LegacySamSelection-to-SamProductType" style="stroke:#27AE60;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="989.319,1625.8381,998.9705,1623.8763,993.392,1622.938,994.3303,1617.3595,989.319,1625.8381" style="stroke:#27AE60;stroke-width:2.0;"/><polygon fill="#000000" points="1087.9267,1565.3646,1096.9998,1562.5131,1093.5909,1557.7247,1087.9267,1565.3646" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="1101" y="1566.9717">use</text></g><!--MD5=[3c9b475e2700f2e5f333b2777b638756]
reverse link LegacySam to SamProductType--><g id="link_LegacySam_SamProductType"><path codeLine="217" d="M919.204,1539.3321 C920.22,1544.3271 921.157,1549.2911 922,1554.2031 C924.524,1568.9051 926.006,1584.7991 926.839,1599.9691 " fill="none" id="LegacySam-backto-SamProductType" style="stroke:#181818;stroke-width:2.0;"/><ellipse cx="917.6306" cy="1532.1013" fill="#FFFFFF" rx="8" ry="8" style="stroke:#181818;stroke-width:2.0;"/><line style="stroke:#181818;stroke-width:2.0;" x1="919.3312" x2="915.93" y1="1539.9185" y2="1524.2841"/><line style="stroke:#181818;stroke-width:2.0;" x1="909.8134" x2="925.4477" y1="1533.8019" y2="1530.4007"/></g><!--MD5=[5ecd342ac4874d804146f75452da1973]
link LegacySam to SamProductType--><g id="link_LegacySam_SamProductType"><path codeLine="218" d="M850.319,1524.4131 C851.765,1540.0711 854.5,1555.5831 859,1570.2031 C861.632,1578.7531 865.271,1587.2271 869.51,1595.4141 " fill="none" id="LegacySam-to-SamProductType" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="871.924,1599.9311,871.2092,1590.1082,869.5671,1595.5215,864.1538,1593.8794,871.924,1599.9311" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="865.3046,1567.2916,865.7816,1557.793,860.1074,1559.3267,865.3046,1567.2916" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="873" y="1566.9717">provide</text></g><!--MD5=[e7e3601070e19270b262a300261c917b]
@startuml
title
    Calypsonet - calypsonet-terminal-calypso-crypto-legacysam-java-api - 0.1.+ (2022-11-29) v3 FULL
end title

' == THEME ==

'Couleurs issues de : https://htmlcolorcodes.com/fr/tableau-de-couleur/tableau-de-couleur-design-plat/
!define C_GREY1 F8F9F9
!define C_GREY2 F2F3F4
!define C_GREY3 E5E7E9
!define C_GREY4 D7DBDD
!define C_GREY5 CACFD2
!define C_GREY6 BDC3C7
!define C_LINK 3498DB
!define C_USE 27AE60

' - - Styles that don't work with new version of plantuml - -
skinparam stereotypeABorderColor #A9DCDF
skinparam stereotypeIBorderColor #B4A7E5
skinparam stereotypeCBorderColor #ADD1B2
skinparam stereotypeEBorderColor #EB93DF
' - - END - -

skinparam ClassBorderThickness 2
skinparam ArrowThickness 2

' Yellow
skinparam ClassBackgroundColor #FEFECE
skinparam ClassBorderColor #D4AC0D
' Red
skinparam ClassBackgroundColor<<red>> #FDEDEC
skinparam ClassBorderColor<<red>> #E74C3C
hide <<red>> stereotype
' Purple
skinparam ClassBackgroundColor<<purple>> #F4ECF7
skinparam ClassBorderColor<<purple>> #8E44AD
hide <<purple>> stereotype
' blue
skinparam ClassBackgroundColor<<blue>> #EBF5FB
skinparam ClassBorderColor<<blue>> #3498DB
hide <<blue>> stereotype
' Green
skinparam ClassBackgroundColor<<green>> #E9F7EF
skinparam ClassBorderColor<<green>> #27AE60
hide <<green>> stereotype
' Grey
skinparam ClassBackgroundColor<<grey>> #EAECEE
skinparam ClassBorderColor<<grey>> #2C3E50
hide <<grey>> stereotype

' == CONTENT ==

legend top
    __Colors legend__ :
    * __External public API references__ :
    ** <back:yellow>**calypsonet-terminal-reader-java-api**</back>
    ** <back:pink>**calypsonet-terminal-calypso-java-api**</back>
end legend

package "org.calypsonet.terminal.calypso.crypto.symmetric.legacysam" as api {
    +class "**final** LegacySamApiProperties" as ApiProperties {
        +{static} **final** String VERSION
    }
    +interface "<<<back:pink>CardTransactionCryptoExtension</back>>>\nLegacySamCardTransactionCryptoExtension" as LegacySamCardTransactionCryptoExtension {
        +LegacySamCardTransactionCryptoExtension prepareComputeSignature (CommonSignatureComputationData<?> data)
        +LegacySamCardTransactionCryptoExtension prepareVerifySignature (CommonSignatureVerificationData<?> data)
    }
    +interface LegacySamTransactionManagerFactory {
        +LegacySamFreeTransactionManager createFreeTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
        +LegacySamSecureReadTransactionManager createSecureReadTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam, LegacySamSecuritySetting securitySetting)
        +LegacySamSecureWriteTransactionManager createSecureWriteTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam, LegacySamSecuritySetting securitySetting)
        +LegacyControlSamStaticTransactionManager createControlSamStaticTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
        +LegacyTargetSamStaticTransactionManager createTargetSamStaticTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
    }
    +interface LegacySamTransactionManager<T extends LegacySamTransactionManager<T>> {
        +List<byte[]> getTransactionAuditData ()
        +T processCommands ()
    }
    +interface LegacySamReadTransactionManager<T extends LegacySamReadTransactionManager<T>> extends LegacySamTransactionManager {
        +T prepareReadSamParameters ()

        +T prepareReadCaadRecord (int caadRecordNumber)
        +T prepareReadCaadRecords (int fromCaadRecordNumber, int toCaadRecordNumber)

        +T prepareReadSystemKeyParameters (LegacySystemKey systemKey)

        +T prepareReadWorkKeyParameter (int workKeyRecordNumber)
        +T prepareReadWorkKeyParameters (int fromWorkKeyRecordNumber, int toWorkKeyRecordNumber)

        +T prepareReadWorkKeyParameter (byte workKeyKif, byte workKeyKvc)

        +T prepareReadEventCounter (int eventCounterNumber)
        +T prepareReadEventCounters (int fromEventCounterNumber, int toEventCounterNumber)

        +T prepareReadEventCeiling (int eventCeilingNumber)
        +T prepareReadEventCeilings (int fromEventCeilingNumber, int toEventCeilingNumber)
    }
    +interface LegacySamFreeWriteTransactionManager<T extends LegacySamFreeWriteTransactionManager<T>> extends LegacySamTransactionManager {
        +T prepareWriteExternalPlainWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters, byte[] workKeyValue)
        +T prepareWriteRandomlyGeneratedWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters)
    }
    +interface LegacySamWriteTransactionManager<T extends LegacySamWriteTransactionManager<T>> extends LegacySamFreeWriteTransactionManager {
        +T prepareWriteExternalPlainWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters, byte[] workKeyValue)
        +T prepareWriteRandomlyGeneratedWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters)

        +T prepareWriteSamParameters (byte[] parameters)
        +T prepareWriteCaadRecord (int caadRecordNumber, byte[] caad)

        +T prepareWriteTransferredCipheredSystemKey (LegacySystemKey sourceSystemKey, byte sourceSystemKeyKif, byte sourceSystemKeyKvc)
        +T prepareWriteTransferredPlainWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters)
        +T prepareWriteTransferredCipheredWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters, byte cipheringSystemKeyKvc)

        +T prepareWriteEventCeiling (int eventCeilingNumber, int newValue)
        +T prepareWriteEventCeilings (int fromEventCeilingNumber, List<Integer> newValues)
    }
    together {
        +interface LegacySamSecureReadTransactionManager extends LegacySamReadTransactionManager {
        }
        +interface LegacySamFreeTransactionManager extends LegacySamReadTransactionManager, LegacySamFreeWriteTransactionManager {
            +LegacySamFreeTransactionManager prepareComputeSignature (CommonSignatureComputationData<?> data)
            +LegacySamFreeTransactionManager prepareVerifySignature (CommonSignatureVerificationData<?> data)
        }
        +interface LegacySamSecureWriteTransactionManager extends LegacySamWriteTransactionManager {
        }
        +interface LegacyTargetSamStaticTransactionManager extends LegacySamTransactionManager {
            +LegacyTargetSamStaticTransactionManager importCommands (String cipheredSamCommands)
        }
        +interface LegacyControlSamStaticTransactionManager extends LegacySamWriteTransactionManager {
            +LegacyControlSamStaticTransactionManager prepareGiveTargetSamPseudoRandom (? staticRandom)
            +String exportCommands ()
        }
    }
    package sam {
        +interface "<<<back:yellow>CardSelection</back>>>\nLegacySamSelection" as LegacySamSelection {
            +LegacySamSelection filterByProductType (LegacySam.ProductType productType)
            +LegacySamSelection filterBySerialNumber (String serialNumberRegex)

            +LegacySamSelection setUnlockData (String unlockData)
        }
        +interface "<<<back:yellow>SmartCard</back>>>\nLegacySam" as LegacySam {
            +ProductType getProductType ()
            +String getProductInfo ()

            +byte[] getSerialNumber ()
            +byte getPlatform ()
            +byte getApplicationType ()
            +byte getApplicationSubType ()
            +byte getSoftwareIssuer ()
            +byte getSoftwareVersion ()
            +byte getSoftwareRevision ()

            +Integer getEventCounter (int eventCounterNumber)
            +SortedMap<Integer, Integer> getEventCounters ()

            +Integer getEventCeiling (int eventCeilingNumber)
            +SortedMap<Integer, Integer> getEventCeilings ()
        }
        +enum "ProductType" as SamProductType {
            SAM_C1
            HSM_C1
            SAM_S1E1
            SAM_S1Dx
            CSAM_F
            UNKNOWN
        }
    }
    +interface LegacySamSecuritySetting {
        +LegacySamSecuritySetting setControlSamResource (<back:yellow>CardReader</back> samReader, LegacySam sam)
    }
    +interface CommonSignatureComputationData<T extends CommonSignatureComputationData<T>> {
        +T setData (byte[] data, byte kif, byte kvc)
        +T setSignatureSize (int size)
        +T setKeyDiversifier (byte[] diversifier)

        +byte[] getSignature ()
    }
    +interface BasicSignatureComputationData extends CommonSignatureComputationData {
    }
    +interface TraceableSignatureComputationData extends CommonSignatureComputationData {
        +TraceableSignatureComputationData withSamTraceabilityMode (int offset, boolean usePartialSamSerialNumber)
        +TraceableSignatureComputationData withoutBusyMode ()

        +byte[] getSignedData ()
    }
    +interface CommonSignatureVerificationData<T extends CommonSignatureVerificationData<T>> {
        +T setData (byte[] data, byte[] signature, byte kif, byte kvc)
        +T setKeyDiversifier (byte[] diversifier)

        +boolean isSignatureValid ()
    }
    +interface BasicSignatureVerificationData extends CommonSignatureVerificationData {
    }
    +interface TraceableSignatureVerificationData extends CommonSignatureVerificationData {
        +TraceableSignatureVerificationData withSamTraceabilityMode (int offset, boolean isPartialSamSerialNumber, boolean checkSamRevocationStatus)
        +TraceableSignatureVerificationData withoutBusyMode ()
    }
}

' Associations

LegacySamTransactionManagerFactory .up.> LegacySamSecureReadTransactionManager #C_LINK : provide >
LegacySamTransactionManagerFactory .up.> LegacySamFreeTransactionManager #C_LINK : provide >
LegacySamTransactionManagerFactory .up.> LegacySamSecureWriteTransactionManager #C_LINK : provide >
LegacySamTransactionManagerFactory .up.> LegacyControlSamStaticTransactionManager #C_LINK : provide >
LegacySamTransactionManagerFactory .up.> LegacyTargetSamStaticTransactionManager #C_LINK : provide >
LegacySamTransactionManagerFactory ..> LegacySam #C_USE : use >
LegacySamTransactionManagerFactory ..> LegacySamSecuritySetting #C_USE : use >

LegacySamFreeTransactionManager ..> CommonSignatureComputationData #C_USE : use >
LegacySamFreeTransactionManager ..> CommonSignatureVerificationData #C_USE : use >

LegacySamCardTransactionCryptoExtension ..> CommonSignatureComputationData #C_USE : use >
LegacySamCardTransactionCryptoExtension ..> CommonSignatureVerificationData #C_USE : use >

LegacySamSelection ..> SamProductType #C_USE : use >

LegacySam +- - SamProductType
LegacySam ..> SamProductType #C_LINK : provide >

' == LAYOUT ==



' == STYLE ==

package api #C_GREY1 {}

interface LegacySamSelection <<purple>>
interface LegacySam <<purple>>
interface SamProductType <<purple>>
interface LegacySamSecuritySetting <<purple>>
interface CommonSignatureComputationData <<purple>>
interface BasicSignatureComputationData <<purple>>
interface TraceableSignatureComputationData <<purple>>
interface CommonSignatureVerificationData <<purple>>
interface BasicSignatureVerificationData <<purple>>
interface TraceableSignatureVerificationData <<purple>>

interface LegacySamTransactionManagerFactory <<red>>
interface LegacySamCardTransactionCryptoExtension <<green>>

@enduml

@startuml
title
    Calypsonet - calypsonet-terminal-calypso-crypto-legacysam-java-api - 0.1.+ (2022-11-29) v3 FULL
end title



skinparam stereotypeABorderColor #A9DCDF
skinparam stereotypeIBorderColor #B4A7E5
skinparam stereotypeCBorderColor #ADD1B2
skinparam stereotypeEBorderColor #EB93DF

skinparam ClassBorderThickness 2
skinparam ArrowThickness 2

skinparam ClassBackgroundColor #FEFECE
skinparam ClassBorderColor #D4AC0D
skinparam ClassBackgroundColor<<red>> #FDEDEC
skinparam ClassBorderColor<<red>> #E74C3C
hide <<red>> stereotype
skinparam ClassBackgroundColor<<purple>> #F4ECF7
skinparam ClassBorderColor<<purple>> #8E44AD
hide <<purple>> stereotype
skinparam ClassBackgroundColor<<blue>> #EBF5FB
skinparam ClassBorderColor<<blue>> #3498DB
hide <<blue>> stereotype
skinparam ClassBackgroundColor<<green>> #E9F7EF
skinparam ClassBorderColor<<green>> #27AE60
hide <<green>> stereotype
skinparam ClassBackgroundColor<<grey>> #EAECEE
skinparam ClassBorderColor<<grey>> #2C3E50
hide <<grey>> stereotype


legend top
    __Colors legend__ :
    * __External public API references__ :
    ** <back:yellow>**calypsonet-terminal-reader-java-api**</back>
    ** <back:pink>**calypsonet-terminal-calypso-java-api**</back>
end legend

package "org.calypsonet.terminal.calypso.crypto.symmetric.legacysam" as api {
    +class "**final** LegacySamApiProperties" as ApiProperties {
        +{static} **final** String VERSION
    }
    +interface "<<<back:pink>CardTransactionCryptoExtension</back>>>\nLegacySamCardTransactionCryptoExtension" as LegacySamCardTransactionCryptoExtension {
        +LegacySamCardTransactionCryptoExtension prepareComputeSignature (CommonSignatureComputationData<?> data)
        +LegacySamCardTransactionCryptoExtension prepareVerifySignature (CommonSignatureVerificationData<?> data)
    }
    +interface LegacySamTransactionManagerFactory {
        +LegacySamFreeTransactionManager createFreeTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
        +LegacySamSecureReadTransactionManager createSecureReadTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam, LegacySamSecuritySetting securitySetting)
        +LegacySamSecureWriteTransactionManager createSecureWriteTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam, LegacySamSecuritySetting securitySetting)
        +LegacyControlSamStaticTransactionManager createControlSamStaticTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
        +LegacyTargetSamStaticTransactionManager createTargetSamStaticTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
    }
    +interface LegacySamTransactionManager<T extends LegacySamTransactionManager<T>> {
        +List<byte[]> getTransactionAuditData ()
        +T processCommands ()
    }
    +interface LegacySamReadTransactionManager<T extends LegacySamReadTransactionManager<T>> extends LegacySamTransactionManager {
        +T prepareReadSamParameters ()

        +T prepareReadCaadRecord (int caadRecordNumber)
        +T prepareReadCaadRecords (int fromCaadRecordNumber, int toCaadRecordNumber)

        +T prepareReadSystemKeyParameters (LegacySystemKey systemKey)

        +T prepareReadWorkKeyParameter (int workKeyRecordNumber)
        +T prepareReadWorkKeyParameters (int fromWorkKeyRecordNumber, int toWorkKeyRecordNumber)

        +T prepareReadWorkKeyParameter (byte workKeyKif, byte workKeyKvc)

        +T prepareReadEventCounter (int eventCounterNumber)
        +T prepareReadEventCounters (int fromEventCounterNumber, int toEventCounterNumber)

        +T prepareReadEventCeiling (int eventCeilingNumber)
        +T prepareReadEventCeilings (int fromEventCeilingNumber, int toEventCeilingNumber)
    }
    +interface LegacySamFreeWriteTransactionManager<T extends LegacySamFreeWriteTransactionManager<T>> extends LegacySamTransactionManager {
        +T prepareWriteExternalPlainWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters, byte[] workKeyValue)
        +T prepareWriteRandomlyGeneratedWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters)
    }
    +interface LegacySamWriteTransactionManager<T extends LegacySamWriteTransactionManager<T>> extends LegacySamFreeWriteTransactionManager {
        +T prepareWriteExternalPlainWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters, byte[] workKeyValue)
        +T prepareWriteRandomlyGeneratedWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters)

        +T prepareWriteSamParameters (byte[] parameters)
        +T prepareWriteCaadRecord (int caadRecordNumber, byte[] caad)

        +T prepareWriteTransferredCipheredSystemKey (LegacySystemKey sourceSystemKey, byte sourceSystemKeyKif, byte sourceSystemKeyKvc)
        +T prepareWriteTransferredPlainWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters)
        +T prepareWriteTransferredCipheredWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters, byte cipheringSystemKeyKvc)

        +T prepareWriteEventCeiling (int eventCeilingNumber, int newValue)
        +T prepareWriteEventCeilings (int fromEventCeilingNumber, List<Integer> newValues)
    }
    together {
        +interface LegacySamSecureReadTransactionManager extends LegacySamReadTransactionManager {
        }
        +interface LegacySamFreeTransactionManager extends LegacySamReadTransactionManager, LegacySamFreeWriteTransactionManager {
            +LegacySamFreeTransactionManager prepareComputeSignature (CommonSignatureComputationData<?> data)
            +LegacySamFreeTransactionManager prepareVerifySignature (CommonSignatureVerificationData<?> data)
        }
        +interface LegacySamSecureWriteTransactionManager extends LegacySamWriteTransactionManager {
        }
        +interface LegacyTargetSamStaticTransactionManager extends LegacySamTransactionManager {
            +LegacyTargetSamStaticTransactionManager importCommands (String cipheredSamCommands)
        }
        +interface LegacyControlSamStaticTransactionManager extends LegacySamWriteTransactionManager {
            +LegacyControlSamStaticTransactionManager prepareGiveTargetSamPseudoRandom (? staticRandom)
            +String exportCommands ()
        }
    }
    package sam {
        +interface "<<<back:yellow>CardSelection</back>>>\nLegacySamSelection" as LegacySamSelection {
            +LegacySamSelection filterByProductType (LegacySam.ProductType productType)
            +LegacySamSelection filterBySerialNumber (String serialNumberRegex)

            +LegacySamSelection setUnlockData (String unlockData)
        }
        +interface "<<<back:yellow>SmartCard</back>>>\nLegacySam" as LegacySam {
            +ProductType getProductType ()
            +String getProductInfo ()

            +byte[] getSerialNumber ()
            +byte getPlatform ()
            +byte getApplicationType ()
            +byte getApplicationSubType ()
            +byte getSoftwareIssuer ()
            +byte getSoftwareVersion ()
            +byte getSoftwareRevision ()

            +Integer getEventCounter (int eventCounterNumber)
            +SortedMap<Integer, Integer> getEventCounters ()

            +Integer getEventCeiling (int eventCeilingNumber)
            +SortedMap<Integer, Integer> getEventCeilings ()
        }
        +enum "ProductType" as SamProductType {
            SAM_C1
            HSM_C1
            SAM_S1E1
            SAM_S1Dx
            CSAM_F
            UNKNOWN
        }
    }
    +interface LegacySamSecuritySetting {
        +LegacySamSecuritySetting setControlSamResource (<back:yellow>CardReader</back> samReader, LegacySam sam)
    }
    +interface CommonSignatureComputationData<T extends CommonSignatureComputationData<T>> {
        +T setData (byte[] data, byte kif, byte kvc)
        +T setSignatureSize (int size)
        +T setKeyDiversifier (byte[] diversifier)

        +byte[] getSignature ()
    }
    +interface BasicSignatureComputationData extends CommonSignatureComputationData {
    }
    +interface TraceableSignatureComputationData extends CommonSignatureComputationData {
        +TraceableSignatureComputationData withSamTraceabilityMode (int offset, boolean usePartialSamSerialNumber)
        +TraceableSignatureComputationData withoutBusyMode ()

        +byte[] getSignedData ()
    }
    +interface CommonSignatureVerificationData<T extends CommonSignatureVerificationData<T>> {
        +T setData (byte[] data, byte[] signature, byte kif, byte kvc)
        +T setKeyDiversifier (byte[] diversifier)

        +boolean isSignatureValid ()
    }
    +interface BasicSignatureVerificationData extends CommonSignatureVerificationData {
    }
    +interface TraceableSignatureVerificationData extends CommonSignatureVerificationData {
        +TraceableSignatureVerificationData withSamTraceabilityMode (int offset, boolean isPartialSamSerialNumber, boolean checkSamRevocationStatus)
        +TraceableSignatureVerificationData withoutBusyMode ()
    }
}


LegacySamTransactionManagerFactory .up.> LegacySamSecureReadTransactionManager #3498DB : provide >
LegacySamTransactionManagerFactory .up.> LegacySamFreeTransactionManager #3498DB : provide >
LegacySamTransactionManagerFactory .up.> LegacySamSecureWriteTransactionManager #3498DB : provide >
LegacySamTransactionManagerFactory .up.> LegacyControlSamStaticTransactionManager #3498DB : provide >
LegacySamTransactionManagerFactory .up.> LegacyTargetSamStaticTransactionManager #3498DB : provide >
LegacySamTransactionManagerFactory ..> LegacySam #27AE60 : use >
LegacySamTransactionManagerFactory ..> LegacySamSecuritySetting #27AE60 : use >

LegacySamFreeTransactionManager ..> CommonSignatureComputationData #27AE60 : use >
LegacySamFreeTransactionManager ..> CommonSignatureVerificationData #27AE60 : use >

LegacySamCardTransactionCryptoExtension ..> CommonSignatureComputationData #27AE60 : use >
LegacySamCardTransactionCryptoExtension ..> CommonSignatureVerificationData #27AE60 : use >

LegacySamSelection ..> SamProductType #27AE60 : use >

LegacySam +- - SamProductType
LegacySam ..> SamProductType #3498DB : provide >





package api #F8F9F9 {}

interface LegacySamSelection <<purple>>
interface LegacySam <<purple>>
interface SamProductType <<purple>>
interface LegacySamSecuritySetting <<purple>>
interface CommonSignatureComputationData <<purple>>
interface BasicSignatureComputationData <<purple>>
interface TraceableSignatureComputationData <<purple>>
interface CommonSignatureVerificationData <<purple>>
interface BasicSignatureVerificationData <<purple>>
interface TraceableSignatureVerificationData <<purple>>

interface LegacySamTransactionManagerFactory <<red>>
interface LegacySamCardTransactionCryptoExtension <<green>>

@enduml

PlantUML version 1.2022.12(Sun Oct 23 20:12:26 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: fr
Country: FR
--></g></svg>