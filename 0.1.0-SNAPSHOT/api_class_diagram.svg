<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1233px" preserveAspectRatio="none" style="width:3169px;height:1233px;background:#FFFFFF;" version="1.1" viewBox="0 0 3169 1233" width="3169.8px" zoomAndPan="magnify"><defs><filter height="1" id="bhzt9eew29ubw0" width="1" x="0" y="0"><feFlood flood-color="#FFFF00" result="flood"/><feComposite in="SourceGraphic" in2="flood" operator="over"/></filter><filter height="1" id="bhzt9eew29ubw1" width="1" x="0" y="0"><feFlood flood-color="#FFC0CB" result="flood"/><feComposite in="SourceGraphic" in2="flood" operator="over"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="8.4" font-weight="bold" lengthAdjust="spacing" textLength="364.2" x="1398.6" y="15.0645">Calypsonet - calypsonet-terminal-calypso-crypto-legacysam-java-api - 0.1.+ (2022-12-05)</text><rect fill="#DDDDDD" height="50.6906" id="_legend" rx="4.5" ry="4.5" style="stroke:#000000;stroke-width:0.6;" width="169.2" x="1496.1" y="30.9727"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" text-decoration="underline" textLength="52.8" x="1499.1" y="43.0371">Colors legend</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="1554.3" y="43.0371">:</text><ellipse cx="1502.4" cy="51.818" fill="#000000" rx="1.5" ry="1.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" text-decoration="underline" textLength="113.4" x="1506.3" y="54.2098">External public API references</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="1622.1" y="54.2098">:</text><rect fill="#000000" height="2.1" style="stroke:#000000;stroke-width:0.0;" width="2.1" x="1504.5" y="61.4906"/><text fill="#000000" filter="url(#bhzt9eew29ubw0)" font-family="sans-serif" font-size="8.4" font-weight="bold" lengthAdjust="spacing" textLength="150" x="1508.7" y="65.3824">calypsonet-terminal-reader-java-api</text><rect fill="#000000" height="2.1" style="stroke:#000000;stroke-width:0.0;" width="2.1" x="1504.5" y="72.6633"/><text fill="#000000" filter="url(#bhzt9eew29ubw1)" font-family="sans-serif" font-size="8.4" font-weight="bold" lengthAdjust="spacing" textLength="153.6" x="1508.7" y="76.5551">calypsonet-terminal-calypso-java-api</text><!--MD5=[7442f3b126ee602ae02566c1a49e158a]
cluster api--><g id="cluster_api"><path d="M5.1,93.0715 L213.9,93.0715 A2.25,2.25 0 0 1 215.4,94.5715 L219.6,107.8441 L3164.1,107.8441 A1.5,1.5 0 0 1 3165.6,109.3441 L3165.6,1227.6715 A1.5,1.5 0 0 1 3164.1,1229.1715 L5.1,1229.1715 A1.5,1.5 0 0 1 3.6,1227.6715 L3.6,94.5715 A1.5,1.5 0 0 1 5.1,93.0715 " fill="#F8F9F9" style="stroke:#000000;stroke-width:0.8999999999999999;"/><line style="stroke:#000000;stroke-width:0.8999999999999999;" x1="3.6" x2="219.6" y1="107.8441" y2="107.8441"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-weight="bold" lengthAdjust="spacing" textLength="208.2" x="6" y="103.3359">org.calypsonet.terminal.calypso.crypto.legacysam</text></g><!--MD5=[f9c58d90839a0c7c212d8c6553ac9eb7]
cluster transaction--><g id="cluster_transaction"><path d="M609.9,120.0715 L657.9,120.0715 A2.25,2.25 0 0 1 659.4,121.5715 L663.6,134.8441 L2862.9,134.8441 A1.5,1.5 0 0 1 2864.4,136.3441 L2864.4,1213.2715 A1.5,1.5 0 0 1 2862.9,1214.7715 L609.9,1214.7715 A1.5,1.5 0 0 1 608.4,1213.2715 L608.4,121.5715 A1.5,1.5 0 0 1 609.9,120.0715 " fill="#F2F3F4" style="stroke:#000000;stroke-width:0.8999999999999999;"/><line style="stroke:#000000;stroke-width:0.8999999999999999;" x1="608.4" x2="663.6" y1="134.8441" y2="134.8441"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-weight="bold" lengthAdjust="spacing" textLength="47.4" x="610.8" y="130.3359">transaction</text></g><!--MD5=[98d4fa74a8fc0b7c744d347d810a7562]
cluster sam--><g id="cluster_sam"><path d="M19.5,684.0715 L36.9,684.0715 A2.25,2.25 0 0 1 38.4,685.5715 L42.6,698.8441 L592.5,698.8441 A1.5,1.5 0 0 1 594,700.3441 L594,1074.3715 A1.5,1.5 0 0 1 592.5,1075.8715 L19.5,1075.8715 A1.5,1.5 0 0 1 18,1074.3715 L18,685.5715 A1.5,1.5 0 0 1 19.5,684.0715 " fill="#F2F3F4" style="stroke:#000000;stroke-width:0.8999999999999999;"/><line style="stroke:#000000;stroke-width:0.8999999999999999;" x1="18" x2="42.6" y1="698.8441" y2="698.8441"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-weight="bold" lengthAdjust="spacing" textLength="16.8" x="20.4" y="694.3359">sam</text></g><!--MD5=[f7e0e2453c87923036c1ac2adfb9cbf0]
cluster spi--><g id="cluster_spi"><path d="M2880.3,1106.4715 L2893.5,1106.4715 A2.25,2.25 0 0 1 2895,1107.9715 L2899.2,1121.2441 L3149.7,1121.2441 A1.5,1.5 0 0 1 3151.2,1122.7441 L3151.2,1187.7715 A1.5,1.5 0 0 1 3149.7,1189.2715 L2880.3,1189.2715 A1.5,1.5 0 0 1 2878.8,1187.7715 L2878.8,1107.9715 A1.5,1.5 0 0 1 2880.3,1106.4715 " fill="#F2F3F4" style="stroke:#000000;stroke-width:0.8999999999999999;"/><line style="stroke:#000000;stroke-width:0.8999999999999999;" x1="2878.8" x2="2899.2" y1="1121.2441" y2="1121.2441"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-weight="bold" lengthAdjust="spacing" textLength="12.6" x="2881.2" y="1116.7359">spi</text></g><!--MD5=[120218adfd8782b0057db0a1b8294250]
class ApiProperties--><g id="elem_ApiProperties"><rect codeLine="61" fill="#FEFECE" height="39.9727" id="ApiProperties" rx="1.5" ry="1.5" style="stroke:#D4AC0D;stroke-width:1.2;" width="141.6" x="235.2" y="147.6715"/><ellipse cx="244.2" cy="157.2715" fill="#ADD1B2" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M245.8594,154.7965 Q245.9531,154.6652 246.0656,154.5996 Q246.1781,154.534 246.3094,154.534 Q246.5344,154.534 246.675,154.6934 Q246.8156,154.8434 246.8156,155.209 L246.8156,156.0809 Q246.8156,156.4465 246.675,156.6059 Q246.5344,156.7652 246.3094,156.7652 Q246.1031,156.7652 245.9813,156.6434 Q245.8594,156.5309 245.7938,156.2215 Q245.7656,156.0059 245.6531,155.8934 Q245.4562,155.6684 245.0906,155.5371 Q244.725,155.4059 244.35,155.4059 Q243.8906,155.4059 243.5063,155.6027 Q243.1313,155.7996 242.8312,156.2496 Q242.5406,156.6996 242.5406,157.3184 L242.5406,157.9746 Q242.5406,158.7152 243.075,159.2121 Q243.6094,159.6996 244.5656,159.6996 Q245.1281,159.6996 245.5219,159.5496 Q245.7563,159.4559 246.0094,159.1934 Q246.1688,159.034 246.2531,158.9871 Q246.3469,158.9402 246.4688,158.9402 Q246.6656,158.9402 246.8156,159.0996 Q246.975,159.2496 246.975,159.4559 Q246.975,159.6621 246.7687,159.9059 Q246.4688,160.2527 245.9906,160.4496 Q245.3438,160.7215 244.5656,160.7215 Q243.6563,160.7215 242.9344,160.3465 Q242.3438,160.0465 241.9312,159.409 Q241.5187,158.7621 241.5187,157.9934 L241.5187,157.2996 Q241.5187,156.5027 241.8844,155.8184 Q242.2594,155.1246 242.9156,154.759 Q243.5719,154.384 244.3125,154.384 Q244.7531,154.384 245.1375,154.4871 Q245.5313,154.5809 245.8594,154.7965 Z " fill="#000000"/><ellipse cx="255.6" cy="156.9715" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-weight="bold" lengthAdjust="spacing" textLength="18" x="259.2" y="160.7496">final</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="95.4" x="279.6" y="160.7496">LegacySamApiProperties</text><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="235.8" x2="376.2" y1="166.8715" y2="166.8715"/><ellipse cx="241.8" cy="175.7578" fill="none" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-weight="bold" lengthAdjust="spacing" text-decoration="underline" textLength="18" x="247.2" y="178.3359">final</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" text-decoration="underline" textLength="60.6" x="267.6" y="178.3359">String VERSION</text><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="235.8" x2="376.2" y1="182.8441" y2="182.8441"/></g><!--MD5=[3dfe6076040c9abfebce4121b80cdb8d]
class LegacySamTransactionManagerFactory--><g id="elem_LegacySamTransactionManagerFactory"><rect codeLine="273" fill="#FDEDEC" height="84.6633" id="LegacySamTransactionManagerFactory" rx="1.5" ry="1.5" style="stroke:#E74C3C;stroke-width:1.2;" width="671.4" x="708.9" y="772.2715"/><ellipse cx="962.55" cy="781.8715" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M963.1219,779.8559 L963.1219,783.8496 L964.1531,783.8496 Q964.5188,783.8496 964.6781,783.9902 Q964.8375,784.1309 964.8375,784.3652 Q964.8375,784.5902 964.6781,784.7309 Q964.5188,784.8715 964.1531,784.8715 L961.0687,784.8715 Q960.7031,784.8715 960.5437,784.7309 Q960.3844,784.5902 960.3844,784.3559 Q960.3844,784.1309 960.5437,783.9902 Q960.7031,783.8496 961.0687,783.8496 L962.1,783.8496 L962.1,779.8559 L961.0687,779.8559 Q960.7031,779.8559 960.5437,779.7152 Q960.3844,779.5746 960.3844,779.3402 Q960.3844,779.1152 960.5437,778.9746 Q960.7031,778.834 961.0687,778.834 L964.1531,778.834 Q964.5188,778.834 964.6781,778.9746 Q964.8375,779.1152 964.8375,779.3402 Q964.8375,779.5746 964.6781,779.7152 Q964.5188,779.8559 964.1531,779.8559 L963.1219,779.8559 Z " fill="#000000"/><ellipse cx="977.85" cy="781.5715" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="152.4" x="981.45" y="785.3496">LegacySamTransactionManagerFactory</text><line style="stroke:#E74C3C;stroke-width:1.2;" x1="709.5" x2="1379.7" y1="791.4715" y2="791.4715"/><line style="stroke:#E74C3C;stroke-width:1.2;" x1="709.5" x2="1379.7" y1="796.2715" y2="796.2715"/><ellipse cx="715.5" cy="805.1578" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="269.4" x="720.9" y="807.7359">LegacySamFreeTransactionManager createFreeTransactionManager (</text><text fill="#000000" filter="url(#bhzt9eew29ubw0)" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="46.8" x="990.3" y="807.7359">CardReader</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="114" x="1039.5" y="807.7359">samReader, LegacySam sam)</text><ellipse cx="715.5" cy="816.3305" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="328.2" x="720.9" y="818.9086">LegacySamSecureReadTransactionManager createSecureReadTransactionManager (</text><text fill="#808080" filter="url(#bhzt9eew29ubw0)" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="46.8" x="1049.1" y="818.9086">CardReader</text><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="278.4" x="1098.3" y="818.9086">samReader, LegacySam sam, LegacySamSecuritySetting securitySetting)</text><ellipse cx="715.5" cy="827.5031" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="327" x="720.9" y="830.0813">LegacySamSecureWriteTransactionManager createSecureWriteTransactionManager (</text><text fill="#808080" filter="url(#bhzt9eew29ubw0)" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="46.8" x="1047.9" y="830.0813">CardReader</text><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="278.4" x="1097.1" y="830.0813">samReader, LegacySam sam, LegacySamSecuritySetting securitySetting)</text><ellipse cx="715.5" cy="838.6758" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="351" x="720.9" y="841.2539">LegacyControlSamAsyncTransactionManager createControlSamAsyncTransactionManager (</text><text fill="#808080" filter="url(#bhzt9eew29ubw0)" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="46.8" x="1071.9" y="841.2539">CardReader</text><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="114" x="1121.1" y="841.2539">samReader, LegacySam sam)</text><ellipse cx="715.5" cy="849.8484" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="346.2" x="720.9" y="852.4266">LegacyTargetSamAsyncTransactionManager createTargetSamAsyncTransactionManager (</text><text fill="#808080" filter="url(#bhzt9eew29ubw0)" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="46.8" x="1067.1" y="852.4266">CardReader</text><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="114" x="1116.3" y="852.4266">samReader, LegacySam sam)</text></g><!--MD5=[0ca469eb9daf2ada2044bbaaac3ba003]
class LegacySamTransactionManager--><g id="elem_LegacySamTransactionManager"><rect codeLine="263" fill="#EBF5FB" height="51.1453" id="LegacySamTransactionManager" rx="1.5" ry="1.5" style="stroke:#3498DB;stroke-width:1.2;" width="304.8" x="1625.4" y="142.2715"/><ellipse cx="1634.4" cy="151.8715" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M1634.9719,149.8559 L1634.9719,153.8496 L1636.0031,153.8496 Q1636.3687,153.8496 1636.5281,153.9902 Q1636.6875,154.1309 1636.6875,154.3652 Q1636.6875,154.5902 1636.5281,154.7309 Q1636.3687,154.8715 1636.0031,154.8715 L1632.9188,154.8715 Q1632.5531,154.8715 1632.3938,154.7309 Q1632.2344,154.5902 1632.2344,154.3559 Q1632.2344,154.1309 1632.3938,153.9902 Q1632.5531,153.8496 1632.9188,153.8496 L1633.95,153.8496 L1633.95,149.8559 L1632.9188,149.8559 Q1632.5531,149.8559 1632.3938,149.7152 Q1632.2344,149.5746 1632.2344,149.3402 Q1632.2344,149.1152 1632.3938,148.9746 Q1632.5531,148.834 1632.9188,148.834 L1636.0031,148.834 Q1636.3687,148.834 1636.5281,148.9746 Q1636.6875,149.1152 1636.6875,149.3402 Q1636.6875,149.5746 1636.5281,149.7152 Q1636.3687,149.8559 1636.0031,149.8559 L1634.9719,149.8559 Z " fill="#000000"/><ellipse cx="1645.8" cy="151.5715" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="123.6" x="1649.4" y="155.3496">LegacySamTransactionManager</text><rect fill="#FFFFFF" height="10.7766" style="stroke:#3498DB;stroke-width:0.6;stroke-dasharray:2.0,2.0;" width="154.2" x="1777.8" y="140.4715"/><text fill="#000000" font-family="sans-serif" font-size="7.2" font-style="italic" lengthAdjust="spacing" textLength="153" x="1778.4" y="148.841">T extends LegacySamTransactionManager&lt;T&gt;</text><line style="stroke:#3498DB;stroke-width:1.2;" x1="1626" x2="1929.6" y1="161.4715" y2="161.4715"/><line style="stroke:#3498DB;stroke-width:1.2;" x1="1626" x2="1929.6" y1="166.2715" y2="166.2715"/><ellipse cx="1632" cy="175.1578" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="148.8" x="1637.4" y="177.7359">List&lt;byte[]&gt; getTransactionAuditData ()</text><ellipse cx="1632" cy="186.3305" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="88.8" x="1637.4" y="188.9086">T processCommands ()</text></g><!--MD5=[8560ba9595df2db95e6096dd1b62c14e]
class LegacySamReadTransactionManager--><g id="elem_LegacySamReadTransactionManager"><rect codeLine="266" fill="#EBF5FB" height="218.7352" id="LegacySamReadTransactionManager" rx="1.5" ry="1.5" style="stroke:#3498DB;stroke-width:1.2;" width="394.2" x="1808.7" y="317.4715"/><ellipse cx="1841.25" cy="327.0715" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M1841.8219,325.0559 L1841.8219,329.0496 L1842.8531,329.0496 Q1843.2188,329.0496 1843.3781,329.1902 Q1843.5375,329.3309 1843.5375,329.5652 Q1843.5375,329.7902 1843.3781,329.9309 Q1843.2188,330.0715 1842.8531,330.0715 L1839.7688,330.0715 Q1839.4031,330.0715 1839.2437,329.9309 Q1839.0844,329.7902 1839.0844,329.5559 Q1839.0844,329.3309 1839.2437,329.1902 Q1839.4031,329.0496 1839.7688,329.0496 L1840.8,329.0496 L1840.8,325.0559 L1839.7688,325.0559 Q1839.4031,325.0559 1839.2437,324.9152 Q1839.0844,324.7746 1839.0844,324.5402 Q1839.0844,324.3152 1839.2437,324.1746 Q1839.4031,324.034 1839.7688,324.034 L1842.8531,324.034 Q1843.2188,324.034 1843.3781,324.1746 Q1843.5375,324.3152 1843.5375,324.5402 Q1843.5375,324.7746 1843.3781,324.9152 Q1843.2188,325.0559 1842.8531,325.0559 L1841.8219,325.0559 Z " fill="#000000"/><ellipse cx="1856.55" cy="326.7715" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="144" x="1860.15" y="330.5496">LegacySamReadTransactionManager</text><rect fill="#FFFFFF" height="10.7766" style="stroke:#3498DB;stroke-width:0.6;stroke-dasharray:2.0,2.0;" width="172.2" x="2032.5" y="315.6715"/><text fill="#000000" font-family="sans-serif" font-size="7.2" font-style="italic" lengthAdjust="spacing" textLength="171" x="2033.1" y="324.041">T extends LegacySamReadTransactionManager&lt;T&gt;</text><line style="stroke:#3498DB;stroke-width:1.2;" x1="1809.3" x2="2202.3" y1="336.6715" y2="336.6715"/><line style="stroke:#3498DB;stroke-width:1.2;" x1="1809.3" x2="2202.3" y1="341.4715" y2="341.4715"/><ellipse cx="1815.3" cy="350.3578" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="127.2" x="1820.7" y="352.9359">T prepareReadSamParameters ()</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="1820.7" y="364.1086"> </text><ellipse cx="1815.3" cy="372.7031" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="201.6" x="1820.7" y="375.2813">T prepareReadCaadRecord (int caadRecordNumber)</text><ellipse cx="1815.3" cy="383.8758" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="325.2" x="1820.7" y="386.4539">T prepareReadCaadRecords (int fromCaadRecordNumber, int toCaadRecordNumber)</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="1820.7" y="397.6266"> </text><ellipse cx="1815.3" cy="406.2211" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="265.2" x="1820.7" y="408.7992">T prepareReadSystemKeyParameters (LegacySystemKey systemKey)</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="1820.7" y="419.9719"> </text><ellipse cx="1815.3" cy="428.5664" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="240.6" x="1820.7" y="431.1445">T prepareReadWorkKeyParameter (int workKeyRecordNumber)</text><ellipse cx="1815.3" cy="439.7391" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="378.6" x="1820.7" y="442.3172">T prepareReadWorkKeyParameters (int fromWorkKeyRecordNumber, int toWorkKeyRecordNumber)</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="1820.7" y="453.4898"> </text><ellipse cx="1815.3" cy="462.0844" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="269.4" x="1820.7" y="464.6625">T prepareReadWorkKeyParameter (byte workKeyKif, byte workKeyKvc)</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="1820.7" y="475.8352"> </text><ellipse cx="1815.3" cy="484.4297" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="211.2" x="1820.7" y="487.0078">T prepareReadEventCounter (int eventCounterNumber)</text><ellipse cx="1815.3" cy="495.6023" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="337.8" x="1820.7" y="498.1805">T prepareReadEventCounters (int fromEventCounterNumber, int toEventCounterNumber)</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="1820.7" y="509.3531"> </text><ellipse cx="1815.3" cy="517.9477" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="201.6" x="1820.7" y="520.5258">T prepareReadEventCeiling (int eventCeilingNumber)</text><ellipse cx="1815.3" cy="529.1203" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="323.4" x="1820.7" y="531.6984">T prepareReadEventCeilings (int fromEventCeilingNumber, int toEventCeilingNumber)</text></g><!--MD5=[155746c58e5d7251cb5fc63eeff736cd]
class LegacySamFreeWriteTransactionManager--><g id="elem_LegacySamFreeWriteTransactionManager"><rect codeLine="265" fill="#EBF5FB" height="51.1453" id="LegacySamFreeWriteTransactionManager" rx="1.5" ry="1.5" style="stroke:#3498DB;stroke-width:1.2;" width="479.4" x="1276.5" y="229.8715"/><ellipse cx="1335.75" cy="239.4715" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M1336.3219,237.4559 L1336.3219,241.4496 L1337.3531,241.4496 Q1337.7188,241.4496 1337.8781,241.5902 Q1338.0375,241.7309 1338.0375,241.9652 Q1338.0375,242.1902 1337.8781,242.3309 Q1337.7188,242.4715 1337.3531,242.4715 L1334.2688,242.4715 Q1333.9031,242.4715 1333.7437,242.3309 Q1333.5844,242.1902 1333.5844,241.9559 Q1333.5844,241.7309 1333.7437,241.5902 Q1333.9031,241.4496 1334.2688,241.4496 L1335.3,241.4496 L1335.3,237.4559 L1334.2688,237.4559 Q1333.9031,237.4559 1333.7437,237.3152 Q1333.5844,237.1746 1333.5844,236.9402 Q1333.5844,236.7152 1333.7437,236.5746 Q1333.9031,236.434 1334.2688,236.434 L1337.3531,236.434 Q1337.7188,236.434 1337.8781,236.5746 Q1338.0375,236.7152 1338.0375,236.9402 Q1338.0375,237.1746 1337.8781,237.3152 Q1337.7188,237.4559 1337.3531,237.4559 L1336.3219,237.4559 Z " fill="#000000"/><ellipse cx="1351.05" cy="239.1715" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="162" x="1354.65" y="242.9496">LegacySamFreeWriteTransactionManager</text><rect fill="#FFFFFF" height="10.7766" style="stroke:#3498DB;stroke-width:0.6;stroke-dasharray:2.0,2.0;" width="186" x="1571.7" y="228.0715"/><text fill="#000000" font-family="sans-serif" font-size="7.2" font-style="italic" lengthAdjust="spacing" textLength="184.8" x="1572.3" y="236.441">T extends LegacySamFreeWriteTransactionManager&lt;T&gt;</text><line style="stroke:#3498DB;stroke-width:1.2;" x1="1277.1" x2="1755.3" y1="249.0715" y2="249.0715"/><line style="stroke:#3498DB;stroke-width:1.2;" x1="1277.1" x2="1755.3" y1="253.8715" y2="253.8715"/><ellipse cx="1283.1" cy="262.7578" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="463.8" x="1288.5" y="265.3359">T prepareWriteExternalPlainWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters, byte[] workKeyValue)</text><ellipse cx="1283.1" cy="273.9305" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="411.6" x="1288.5" y="276.5086">T prepareWriteRandomlyGeneratedWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters)</text></g><!--MD5=[289fd8b2248dd9124bc1cfda0abe149c]
class LegacySamWriteTransactionManager--><g id="elem_LegacySamWriteTransactionManager"><rect codeLine="267" fill="#EBF5FB" height="129.3539" id="LegacySamWriteTransactionManager" rx="1.5" ry="1.5" style="stroke:#3498DB;stroke-width:1.2;" width="598.8" x="864" y="362.1715"/><ellipse cx="999.45" cy="371.7715" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M1000.0219,369.7559 L1000.0219,373.7496 L1001.0531,373.7496 Q1001.4187,373.7496 1001.5781,373.8902 Q1001.7375,374.0309 1001.7375,374.2652 Q1001.7375,374.4902 1001.5781,374.6309 Q1001.4187,374.7715 1001.0531,374.7715 L997.9688,374.7715 Q997.6031,374.7715 997.4437,374.6309 Q997.2844,374.4902 997.2844,374.2559 Q997.2844,374.0309 997.4437,373.8902 Q997.6031,373.7496 997.9688,373.7496 L999,373.7496 L999,369.7559 L997.9688,369.7559 Q997.6031,369.7559 997.4437,369.6152 Q997.2844,369.4746 997.2844,369.2402 Q997.2844,369.0152 997.4437,368.8746 Q997.6031,368.734 997.9688,368.734 L1001.0531,368.734 Q1001.4187,368.734 1001.5781,368.8746 Q1001.7375,369.0152 1001.7375,369.2402 Q1001.7375,369.4746 1001.5781,369.6152 Q1001.4187,369.7559 1001.0531,369.7559 L1000.0219,369.7559 Z " fill="#000000"/><ellipse cx="1014.75" cy="371.4715" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="144" x="1018.35" y="375.2496">LegacySamWriteTransactionManager</text><rect fill="#FFFFFF" height="10.7766" style="stroke:#3498DB;stroke-width:0.6;stroke-dasharray:2.0,2.0;" width="171" x="1293.6" y="360.3715"/><text fill="#000000" font-family="sans-serif" font-size="7.2" font-style="italic" lengthAdjust="spacing" textLength="169.8" x="1294.2" y="368.741">T extends LegacySamWriteTransactionManager&lt;T&gt;</text><line style="stroke:#3498DB;stroke-width:1.2;" x1="864.6" x2="1462.2" y1="381.3715" y2="381.3715"/><line style="stroke:#3498DB;stroke-width:1.2;" x1="864.6" x2="1462.2" y1="386.1715" y2="386.1715"/><ellipse cx="870.6" cy="395.0578" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="193.2" x="876" y="397.6359">T prepareWriteSamParameters (byte[] parameters)</text><ellipse cx="870.6" cy="406.2305" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="247.8" x="876" y="408.8086">T prepareWriteCaadRecord (int caadRecordNumber, byte[] caad)</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="876" y="419.9813"> </text><ellipse cx="870.6" cy="428.5758" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="533.4" x="876" y="431.1539">T prepareWriteTransferredCipheredSystemKey (LegacySystemKey sourceSystemKey, byte sourceSystemKeyKif, byte sourceSystemKeyKvc)</text><ellipse cx="870.6" cy="439.7484" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="453" x="876" y="442.3266">T prepareWriteTransferredPlainWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters)</text><ellipse cx="870.6" cy="450.9211" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="583.2" x="876" y="453.4992">T prepareWriteTransferredCipheredWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters, byte cipheringSystemKeyKvc)</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="876" y="464.6719"> </text><ellipse cx="870.6" cy="473.2664" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="253.8" x="876" y="475.8445">T prepareWriteEventCeiling (int eventCeilingNumber, int newValue)</text><ellipse cx="870.6" cy="484.4391" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="319.8" x="876" y="487.0172">T prepareWriteEventCeilings (int fromEventCeilingNumber, List&lt;Integer&gt; newValues)</text></g><!--MD5=[99f79a410af283d07bb019eb71d4383a]
class LegacySamSecuritySettingFactory--><g id="elem_LegacySamSecuritySettingFactory"><rect codeLine="276" fill="#FDEDEC" height="39.9727" id="LegacySamSecuritySettingFactory" rx="1.5" ry="1.5" style="stroke:#E74C3C;stroke-width:1.2;" width="208.8" x="940.2" y="1134.0715"/><ellipse cx="973.65" cy="1143.6715" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M974.2219,1141.6559 L974.2219,1145.6496 L975.2531,1145.6496 Q975.6188,1145.6496 975.7781,1145.7902 Q975.9375,1145.9309 975.9375,1146.1652 Q975.9375,1146.3902 975.7781,1146.5309 Q975.6188,1146.6715 975.2531,1146.6715 L972.1687,1146.6715 Q971.8031,1146.6715 971.6438,1146.5309 Q971.4844,1146.3902 971.4844,1146.1559 Q971.4844,1145.9309 971.6438,1145.7902 Q971.8031,1145.6496 972.1687,1145.6496 L973.2,1145.6496 L973.2,1141.6559 L972.1687,1141.6559 Q971.8031,1141.6559 971.6438,1141.5152 Q971.4844,1141.3746 971.4844,1141.1402 Q971.4844,1140.9152 971.6438,1140.7746 Q971.8031,1140.634 972.1687,1140.634 L975.2531,1140.634 Q975.6188,1140.634 975.7781,1140.7746 Q975.9375,1140.9152 975.9375,1141.1402 Q975.9375,1141.3746 975.7781,1141.5152 Q975.6188,1141.6559 975.2531,1141.6559 L974.2219,1141.6559 Z " fill="#000000"/><ellipse cx="988.95" cy="1143.3715" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="130.2" x="992.55" y="1147.1496">LegacySamSecuritySettingFactory</text><line style="stroke:#E74C3C;stroke-width:1.2;" x1="940.8" x2="1148.4" y1="1153.2715" y2="1153.2715"/><line style="stroke:#E74C3C;stroke-width:1.2;" x1="940.8" x2="1148.4" y1="1158.0715" y2="1158.0715"/><ellipse cx="946.8" cy="1166.9578" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="193.2" x="952.2" y="1169.5359">LegacySamSecuritySetting createSecuritySetting ()</text></g><!--MD5=[cdba2e3b2692f0a974bd83ada5baadec]
class LegacySamSecuritySetting--><g id="elem_LegacySamSecuritySetting"><rect codeLine="130" fill="#FEFECE" height="39.9727" id="LegacySamSecuritySetting" rx="1.5" ry="1.5" style="stroke:#D4AC0D;stroke-width:1.2;" width="380.4" x="854.4" y="998.1715"/><ellipse cx="988.05" cy="1007.7715" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M988.6219,1005.7559 L988.6219,1009.7496 L989.6531,1009.7496 Q990.0188,1009.7496 990.1781,1009.8902 Q990.3375,1010.0309 990.3375,1010.2652 Q990.3375,1010.4902 990.1781,1010.6309 Q990.0188,1010.7715 989.6531,1010.7715 L986.5687,1010.7715 Q986.2031,1010.7715 986.0437,1010.6309 Q985.8844,1010.4902 985.8844,1010.2559 Q985.8844,1010.0309 986.0437,1009.8902 Q986.2031,1009.7496 986.5687,1009.7496 L987.6,1009.7496 L987.6,1005.7559 L986.5687,1005.7559 Q986.2031,1005.7559 986.0437,1005.6152 Q985.8844,1005.4746 985.8844,1005.2402 Q985.8844,1005.0152 986.0437,1004.8746 Q986.2031,1004.734 986.5687,1004.734 L989.6531,1004.734 Q990.0188,1004.734 990.1781,1004.8746 Q990.3375,1005.0152 990.3375,1005.2402 Q990.3375,1005.4746 990.1781,1005.6152 Q990.0188,1005.7559 989.6531,1005.7559 L988.6219,1005.7559 Z " fill="#000000"/><ellipse cx="1003.35" cy="1007.4715" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="101.4" x="1006.95" y="1011.2496">LegacySamSecuritySetting</text><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="855" x2="1234.2" y1="1017.3715" y2="1017.3715"/><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="855" x2="1234.2" y1="1022.1715" y2="1022.1715"/><ellipse cx="861" cy="1031.0578" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="201.6" x="866.4" y="1033.6359">LegacySamSecuritySetting setControlSamResource (</text><text fill="#000000" filter="url(#bhzt9eew29ubw0)" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="46.8" x="1068" y="1033.6359">CardReader</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="114" x="1117.2" y="1033.6359">samReader, LegacySam sam)</text></g><!--MD5=[3a04f400e335556ca7c4adcb3d92e310]
class LegacySamSecureReadTransactionManager--><g id="elem_LegacySamSecureReadTransactionManager"><rect codeLine="268" fill="#EBF5FB" height="28.8" id="LegacySamSecureReadTransactionManager" rx="1.5" ry="1.5" style="stroke:#3498DB;stroke-width:1.2;" width="196.8" x="1684.2" y="599.4715"/><ellipse cx="1693.2" cy="609.0715" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M1693.7719,607.0559 L1693.7719,611.0496 L1694.8031,611.0496 Q1695.1688,611.0496 1695.3281,611.1902 Q1695.4875,611.3309 1695.4875,611.5652 Q1695.4875,611.7902 1695.3281,611.9309 Q1695.1688,612.0715 1694.8031,612.0715 L1691.7188,612.0715 Q1691.3531,612.0715 1691.1938,611.9309 Q1691.0344,611.7902 1691.0344,611.5559 Q1691.0344,611.3309 1691.1938,611.1902 Q1691.3531,611.0496 1691.7188,611.0496 L1692.75,611.0496 L1692.75,607.0559 L1691.7188,607.0559 Q1691.3531,607.0559 1691.1938,606.9152 Q1691.0344,606.7746 1691.0344,606.5402 Q1691.0344,606.3152 1691.1938,606.1746 Q1691.3531,606.034 1691.7188,606.034 L1694.8031,606.034 Q1695.1688,606.034 1695.3281,606.1746 Q1695.4875,606.3152 1695.4875,606.5402 Q1695.4875,606.7746 1695.3281,606.9152 Q1695.1688,607.0559 1694.8031,607.0559 L1693.7719,607.0559 Z " fill="#000000"/><ellipse cx="1704.6" cy="608.7715" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="171" x="1708.2" y="612.5496">LegacySamSecureReadTransactionManager</text><line style="stroke:#3498DB;stroke-width:1.2;" x1="1684.8" x2="1880.4" y1="618.6715" y2="618.6715"/><line style="stroke:#3498DB;stroke-width:1.2;" x1="1684.8" x2="1880.4" y1="623.4715" y2="623.4715"/></g><!--MD5=[1628adf05aefa5de516c8137f2ec891f]
class LegacySamFreeTransactionManager--><g id="elem_LegacySamFreeTransactionManager"><rect codeLine="264" fill="#EBF5FB" height="51.1453" id="LegacySamFreeTransactionManager" rx="1.5" ry="1.5" style="stroke:#3498DB;stroke-width:1.2;" width="438" x="1902" y="588.3715"/><ellipse cx="2044.35" cy="597.9715" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M2044.9219,595.9559 L2044.9219,599.9496 L2045.9531,599.9496 Q2046.3188,599.9496 2046.4781,600.0902 Q2046.6375,600.2309 2046.6375,600.4652 Q2046.6375,600.6902 2046.4781,600.8309 Q2046.3188,600.9715 2045.9531,600.9715 L2042.8687,600.9715 Q2042.5031,600.9715 2042.3438,600.8309 Q2042.1844,600.6902 2042.1844,600.4559 Q2042.1844,600.2309 2042.3438,600.0902 Q2042.5031,599.9496 2042.8687,599.9496 L2043.9,599.9496 L2043.9,595.9559 L2042.8687,595.9559 Q2042.5031,595.9559 2042.3438,595.8152 Q2042.1844,595.6746 2042.1844,595.4402 Q2042.1844,595.2152 2042.3438,595.0746 Q2042.5031,594.934 2042.8687,594.934 L2045.9531,594.934 Q2046.3188,594.934 2046.4781,595.0746 Q2046.6375,595.2152 2046.6375,595.4402 Q2046.6375,595.6746 2046.4781,595.8152 Q2046.3188,595.9559 2045.9531,595.9559 L2044.9219,595.9559 Z " fill="#000000"/><ellipse cx="2059.65" cy="597.6715" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="141.6" x="2063.25" y="601.4496">LegacySamFreeTransactionManager</text><line style="stroke:#3498DB;stroke-width:1.2;" x1="1902.6" x2="2339.4" y1="607.5715" y2="607.5715"/><line style="stroke:#3498DB;stroke-width:1.2;" x1="1902.6" x2="2339.4" y1="612.3715" y2="612.3715"/><ellipse cx="1908.6" cy="621.2578" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="422.4" x="1914" y="623.8359">LegacySamFreeTransactionManager prepareComputeSignature (CommonSignatureComputationData&lt;?&gt; data)</text><ellipse cx="1908.6" cy="632.4305" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="403.8" x="1914" y="635.0086">LegacySamFreeTransactionManager prepareVerifySignature (CommonSignatureVerificationData&lt;?&gt; data)</text></g><!--MD5=[d1e88ceba10e2a9725069380c4ef5b88]
class LegacySamSecureWriteTransactionManager--><g id="elem_LegacySamSecureWriteTransactionManager"><rect codeLine="269" fill="#EBF5FB" height="28.8" id="LegacySamSecureWriteTransactionManager" rx="1.5" ry="1.5" style="stroke:#3498DB;stroke-width:1.2;" width="196.8" x="1065" y="599.4715"/><ellipse cx="1074" cy="609.0715" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M1074.5719,607.0559 L1074.5719,611.0496 L1075.6031,611.0496 Q1075.9688,611.0496 1076.1281,611.1902 Q1076.2875,611.3309 1076.2875,611.5652 Q1076.2875,611.7902 1076.1281,611.9309 Q1075.9688,612.0715 1075.6031,612.0715 L1072.5188,612.0715 Q1072.1531,612.0715 1071.9937,611.9309 Q1071.8344,611.7902 1071.8344,611.5559 Q1071.8344,611.3309 1071.9937,611.1902 Q1072.1531,611.0496 1072.5188,611.0496 L1073.55,611.0496 L1073.55,607.0559 L1072.5188,607.0559 Q1072.1531,607.0559 1071.9937,606.9152 Q1071.8344,606.7746 1071.8344,606.5402 Q1071.8344,606.3152 1071.9937,606.1746 Q1072.1531,606.034 1072.5188,606.034 L1075.6031,606.034 Q1075.9688,606.034 1076.1281,606.1746 Q1076.2875,606.3152 1076.2875,606.5402 Q1076.2875,606.7746 1076.1281,606.9152 Q1075.9688,607.0559 1075.6031,607.0559 L1074.5719,607.0559 Z " fill="#000000"/><ellipse cx="1085.4" cy="608.7715" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="171" x="1089" y="612.5496">LegacySamSecureWriteTransactionManager</text><line style="stroke:#3498DB;stroke-width:1.2;" x1="1065.6" x2="1261.2" y1="618.6715" y2="618.6715"/><line style="stroke:#3498DB;stroke-width:1.2;" x1="1065.6" x2="1261.2" y1="623.4715" y2="623.4715"/></g><!--MD5=[904e25234fc208011404775abfba51fe]
class LegacyTargetSamAsyncTransactionManager--><g id="elem_LegacyTargetSamAsyncTransactionManager"><rect codeLine="271" fill="#EBF5FB" height="39.9727" id="LegacyTargetSamAsyncTransactionManager" rx="1.5" ry="1.5" style="stroke:#3498DB;stroke-width:1.2;" width="380.4" x="1282.8" y="593.7715"/><ellipse cx="1381.35" cy="603.3715" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M1381.9219,601.3559 L1381.9219,605.3496 L1382.9531,605.3496 Q1383.3188,605.3496 1383.4781,605.4902 Q1383.6375,605.6309 1383.6375,605.8652 Q1383.6375,606.0902 1383.4781,606.2309 Q1383.3188,606.3715 1382.9531,606.3715 L1379.8687,606.3715 Q1379.5031,606.3715 1379.3438,606.2309 Q1379.1844,606.0902 1379.1844,605.8559 Q1379.1844,605.6309 1379.3438,605.4902 Q1379.5031,605.3496 1379.8687,605.3496 L1380.9,605.3496 L1380.9,601.3559 L1379.8687,601.3559 Q1379.5031,601.3559 1379.3438,601.2152 Q1379.1844,601.0746 1379.1844,600.8402 Q1379.1844,600.6152 1379.3438,600.4746 Q1379.5031,600.334 1379.8687,600.334 L1382.9531,600.334 Q1383.3188,600.334 1383.4781,600.4746 Q1383.6375,600.6152 1383.6375,600.8402 Q1383.6375,601.0746 1383.4781,601.2152 Q1383.3188,601.3559 1382.9531,601.3559 L1381.9219,601.3559 Z " fill="#000000"/><ellipse cx="1396.65" cy="603.0715" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="171.6" x="1400.25" y="606.8496">LegacyTargetSamAsyncTransactionManager</text><line style="stroke:#3498DB;stroke-width:1.2;" x1="1283.4" x2="1662.6" y1="612.9715" y2="612.9715"/><line style="stroke:#3498DB;stroke-width:1.2;" x1="1283.4" x2="1662.6" y1="617.7715" y2="617.7715"/><ellipse cx="1289.4" cy="626.6578" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="364.8" x="1294.8" y="629.2359">LegacyTargetSamAsyncTransactionManager importCommands (String cipheredSamCommands)</text></g><!--MD5=[e84cd48f86a8568123bff806a5851c6a]
class LegacyControlSamAsyncTransactionManager--><g id="elem_LegacyControlSamAsyncTransactionManager"><rect codeLine="270" fill="#EBF5FB" height="51.1453" id="LegacyControlSamAsyncTransactionManager" rx="1.5" ry="1.5" style="stroke:#3498DB;stroke-width:1.2;" width="411" x="632.7" y="588.3715"/><ellipse cx="745.35" cy="597.9715" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M745.9219,595.9559 L745.9219,599.9496 L746.9531,599.9496 Q747.3188,599.9496 747.4781,600.0902 Q747.6375,600.2309 747.6375,600.4652 Q747.6375,600.6902 747.4781,600.8309 Q747.3188,600.9715 746.9531,600.9715 L743.8688,600.9715 Q743.5031,600.9715 743.3438,600.8309 Q743.1844,600.6902 743.1844,600.4559 Q743.1844,600.2309 743.3438,600.0902 Q743.5031,599.9496 743.8688,599.9496 L744.9,599.9496 L744.9,595.9559 L743.8688,595.9559 Q743.5031,595.9559 743.3438,595.8152 Q743.1844,595.6746 743.1844,595.4402 Q743.1844,595.2152 743.3438,595.0746 Q743.5031,594.934 743.8688,594.934 L746.9531,594.934 Q747.3188,594.934 747.4781,595.0746 Q747.6375,595.2152 747.6375,595.4402 Q747.6375,595.6746 747.4781,595.8152 Q747.3188,595.9559 746.9531,595.9559 L745.9219,595.9559 Z " fill="#000000"/><ellipse cx="760.65" cy="597.6715" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="174" x="764.25" y="601.4496">LegacyControlSamAsyncTransactionManager</text><line style="stroke:#3498DB;stroke-width:1.2;" x1="633.3" x2="1043.1" y1="607.5715" y2="607.5715"/><line style="stroke:#3498DB;stroke-width:1.2;" x1="633.3" x2="1043.1" y1="612.3715" y2="612.3715"/><ellipse cx="639.3" cy="621.2578" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="395.4" x="644.7" y="623.8359">LegacyControlSamAsyncTransactionManager prepareGiveTargetSamPseudoRandom (? asyncRandom)</text><ellipse cx="639.3" cy="632.4305" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="99" x="644.7" y="635.0086">String exportCommands ()</text></g><!--MD5=[9b6b3b24aacb5f7ad15454d200b51d2a]
class CardTransactionCryptoExtensionFactory--><g id="elem_CardTransactionCryptoExtensionFactory"><rect codeLine="274" fill="#FDEDEC" height="39.9727" id="CardTransactionCryptoExtensionFactory" rx="1.5" ry="1.5" style="stroke:#E74C3C;stroke-width:1.2;" width="345.6" x="2434.2" y="406.8715"/><ellipse cx="2524.05" cy="416.4715" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M2524.6219,414.4559 L2524.6219,418.4496 L2525.6531,418.4496 Q2526.0187,418.4496 2526.1781,418.5902 Q2526.3375,418.7309 2526.3375,418.9652 Q2526.3375,419.1902 2526.1781,419.3309 Q2526.0187,419.4715 2525.6531,419.4715 L2522.5688,419.4715 Q2522.2031,419.4715 2522.0438,419.3309 Q2521.8844,419.1902 2521.8844,418.9559 Q2521.8844,418.7309 2522.0438,418.5902 Q2522.2031,418.4496 2522.5688,418.4496 L2523.6,418.4496 L2523.6,414.4559 L2522.5688,414.4559 Q2522.2031,414.4559 2522.0438,414.3152 Q2521.8844,414.1746 2521.8844,413.9402 Q2521.8844,413.7152 2522.0438,413.5746 Q2522.2031,413.434 2522.5688,413.434 L2525.6531,413.434 Q2526.0187,413.434 2526.1781,413.5746 Q2526.3375,413.7152 2526.3375,413.9402 Q2526.3375,414.1746 2526.1781,414.3152 Q2526.0187,414.4559 2525.6531,414.4559 L2524.6219,414.4559 Z " fill="#000000"/><ellipse cx="2539.35" cy="416.1715" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="154.2" x="2542.95" y="419.9496">CardTransactionCryptoExtensionFactory</text><line style="stroke:#E74C3C;stroke-width:1.2;" x1="2434.8" x2="2779.2" y1="426.0715" y2="426.0715"/><line style="stroke:#E74C3C;stroke-width:1.2;" x1="2434.8" x2="2779.2" y1="430.8715" y2="430.8715"/><ellipse cx="2440.8" cy="439.7578" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="330" x="2446.2" y="442.3359">LegacySamCardTransactionCryptoExtension createCardTransactionCryptoExtension ()</text></g><!--MD5=[dbd049b1aac9d758f526265ceb7ce91b]
class LegacySamCardTransactionCryptoExtension--><g id="elem_LegacySamCardTransactionCryptoExtension"><rect codeLine="278" fill="#E9F7EF" height="60.2906" id="LegacySamCardTransactionCryptoExtension" rx="1.5" ry="1.5" style="stroke:#27AE60;stroke-width:1.2;" width="466.8" x="2373.6" y="583.8715"/><ellipse cx="2516.25" cy="598.0441" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M2516.8219,596.0285 L2516.8219,600.0223 L2517.8531,600.0223 Q2518.2188,600.0223 2518.3781,600.1629 Q2518.5375,600.3035 2518.5375,600.5379 Q2518.5375,600.7629 2518.3781,600.9035 Q2518.2188,601.0441 2517.8531,601.0441 L2514.7687,601.0441 Q2514.4031,601.0441 2514.2438,600.9035 Q2514.0844,600.7629 2514.0844,600.5285 Q2514.0844,600.3035 2514.2438,600.1629 Q2514.4031,600.0223 2514.7687,600.0223 L2515.8,600.0223 L2515.8,596.0285 L2514.7687,596.0285 Q2514.4031,596.0285 2514.2438,595.8879 Q2514.0844,595.7473 2514.0844,595.5129 Q2514.0844,595.2879 2514.2438,595.1473 Q2514.4031,595.0066 2514.7687,595.0066 L2517.8531,595.0066 Q2518.2188,595.0066 2518.3781,595.1473 Q2518.5375,595.2879 2518.5375,595.5129 Q2518.5375,595.7473 2518.3781,595.8879 Q2518.2188,596.0285 2517.8531,596.0285 L2516.8219,596.0285 Z " fill="#000000"/><ellipse cx="2531.55" cy="597.7441" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="9.6" x="2547.75" y="595.9359">&lt;&lt;</text><text fill="#000000" filter="url(#bhzt9eew29ubw1)" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="125.4" x="2557.35" y="595.9359">CardTransactionCryptoExtension</text><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="9.6" x="2682.75" y="595.9359">&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="169.8" x="2535.15" y="607.1086">LegacySamCardTransactionCryptoExtension</text><line style="stroke:#27AE60;stroke-width:1.2;" x1="2374.2" x2="2839.8" y1="612.2168" y2="612.2168"/><line style="stroke:#27AE60;stroke-width:1.2;" x1="2374.2" x2="2839.8" y1="617.0168" y2="617.0168"/><ellipse cx="2380.2" cy="625.9031" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="451.2" x="2385.6" y="628.4812">LegacySamCardTransactionCryptoExtension prepareComputeSignature (CommonSignatureComputationData&lt;?&gt; data)</text><ellipse cx="2380.2" cy="637.0758" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#808080" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="432.6" x="2385.6" y="639.6539">LegacySamCardTransactionCryptoExtension prepareVerifySignature (CommonSignatureVerificationData&lt;?&gt; data)</text></g><!--MD5=[c17ae2c2af60537b87d9abee834860c0]
class CommonSignatureComputationData--><g id="elem_CommonSignatureComputationData"><rect codeLine="143" fill="#FEFECE" height="84.6633" id="CommonSignatureComputationData" rx="1.5" ry="1.5" style="stroke:#D4AC0D;stroke-width:1.2;" width="331.8" x="1816.5" y="772.2715"/><ellipse cx="1825.5" cy="781.8715" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M1826.0719,779.8559 L1826.0719,783.8496 L1827.1031,783.8496 Q1827.4688,783.8496 1827.6281,783.9902 Q1827.7875,784.1309 1827.7875,784.3652 Q1827.7875,784.5902 1827.6281,784.7309 Q1827.4688,784.8715 1827.1031,784.8715 L1824.0188,784.8715 Q1823.6531,784.8715 1823.4937,784.7309 Q1823.3344,784.5902 1823.3344,784.3559 Q1823.3344,784.1309 1823.4937,783.9902 Q1823.6531,783.8496 1824.0188,783.8496 L1825.05,783.8496 L1825.05,779.8559 L1824.0188,779.8559 Q1823.6531,779.8559 1823.4937,779.7152 Q1823.3344,779.5746 1823.3344,779.3402 Q1823.3344,779.1152 1823.4937,778.9746 Q1823.6531,778.834 1824.0188,778.834 L1827.1031,778.834 Q1827.4688,778.834 1827.6281,778.9746 Q1827.7875,779.1152 1827.7875,779.3402 Q1827.7875,779.5746 1827.6281,779.7152 Q1827.4688,779.8559 1827.1031,779.8559 L1826.0719,779.8559 Z " fill="#000000"/><ellipse cx="1836.9" cy="781.5715" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="136.2" x="1840.5" y="785.3496">CommonSignatureComputationData</text><rect fill="#FFFFFF" height="10.7766" style="stroke:#D4AC0D;stroke-width:0.6;stroke-dasharray:2.0,2.0;" width="168.6" x="1981.5" y="770.4715"/><text fill="#000000" font-family="sans-serif" font-size="7.2" font-style="italic" lengthAdjust="spacing" textLength="167.4" x="1982.1" y="778.841">T extends CommonSignatureComputationData&lt;T&gt;</text><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="1817.1" x2="2147.7" y1="791.4715" y2="791.4715"/><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="1817.1" x2="2147.7" y1="796.2715" y2="796.2715"/><ellipse cx="1823.1" cy="805.1578" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="153.6" x="1828.5" y="807.7359">T setData (byte[] data, byte kif, byte kvc)</text><ellipse cx="1823.1" cy="816.3305" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="105.6" x="1828.5" y="818.9086">T setSignatureSize (int size)</text><ellipse cx="1823.1" cy="827.5031" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="139.8" x="1828.5" y="830.0813">T setKeyDiversifier (byte[] diversifier)</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="1828.5" y="841.2539"> </text><ellipse cx="1823.1" cy="849.8484" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="80.4" x="1828.5" y="852.4266">byte[] getSignature ()</text></g><!--MD5=[c644258d6e85feb715526e24ebfc93b6]
class BasicSignatureComputationData--><g id="elem_BasicSignatureComputationData"><rect codeLine="150" fill="#FEFECE" height="28.8" id="BasicSignatureComputationData" rx="1.5" ry="1.5" style="stroke:#D4AC0D;stroke-width:1.2;" width="148.8" x="1860" y="1003.8715"/><ellipse cx="1869" cy="1013.4715" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M1869.5719,1011.4559 L1869.5719,1015.4496 L1870.6031,1015.4496 Q1870.9688,1015.4496 1871.1281,1015.5902 Q1871.2875,1015.7309 1871.2875,1015.9652 Q1871.2875,1016.1902 1871.1281,1016.3309 Q1870.9688,1016.4715 1870.6031,1016.4715 L1867.5188,1016.4715 Q1867.1531,1016.4715 1866.9937,1016.3309 Q1866.8344,1016.1902 1866.8344,1015.9559 Q1866.8344,1015.7309 1866.9937,1015.5902 Q1867.1531,1015.4496 1867.5188,1015.4496 L1868.55,1015.4496 L1868.55,1011.4559 L1867.5188,1011.4559 Q1867.1531,1011.4559 1866.9937,1011.3152 Q1866.8344,1011.1746 1866.8344,1010.9402 Q1866.8344,1010.7152 1866.9937,1010.5746 Q1867.1531,1010.434 1867.5188,1010.434 L1870.6031,1010.434 Q1870.9688,1010.434 1871.1281,1010.5746 Q1871.2875,1010.7152 1871.2875,1010.9402 Q1871.2875,1011.1746 1871.1281,1011.3152 Q1870.9688,1011.4559 1870.6031,1011.4559 L1869.5719,1011.4559 Z " fill="#000000"/><ellipse cx="1880.4" cy="1013.1715" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="123" x="1884" y="1016.9496">BasicSignatureComputationData</text><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="1860.6" x2="2008.2" y1="1023.0715" y2="1023.0715"/><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="1860.6" x2="2008.2" y1="1027.8715" y2="1027.8715"/></g><!--MD5=[cdc2fcd8768bdabfe9b56e9f578bd14d]
class TraceableSignatureComputationData--><g id="elem_TraceableSignatureComputationData"><rect codeLine="152" fill="#FEFECE" height="73.4906" id="TraceableSignatureComputationData" rx="1.5" ry="1.5" style="stroke:#D4AC0D;stroke-width:1.2;" width="439.2" x="1399.8" y="981.6715"/><ellipse cx="1543.05" cy="991.2715" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M1543.6219,989.2559 L1543.6219,993.2496 L1544.6531,993.2496 Q1545.0188,993.2496 1545.1781,993.3902 Q1545.3375,993.5309 1545.3375,993.7652 Q1545.3375,993.9902 1545.1781,994.1309 Q1545.0188,994.2715 1544.6531,994.2715 L1541.5688,994.2715 Q1541.2031,994.2715 1541.0438,994.1309 Q1540.8844,993.9902 1540.8844,993.7559 Q1540.8844,993.5309 1541.0438,993.3902 Q1541.2031,993.2496 1541.5688,993.2496 L1542.6,993.2496 L1542.6,989.2559 L1541.5688,989.2559 Q1541.2031,989.2559 1541.0438,989.1152 Q1540.8844,988.9746 1540.8844,988.7402 Q1540.8844,988.5152 1541.0438,988.3746 Q1541.2031,988.234 1541.5688,988.234 L1544.6531,988.234 Q1545.0188,988.234 1545.1781,988.3746 Q1545.3375,988.5152 1545.3375,988.7402 Q1545.3375,988.9746 1545.1781,989.1152 Q1545.0188,989.2559 1544.6531,989.2559 L1543.6219,989.2559 Z " fill="#000000"/><ellipse cx="1558.35" cy="990.9715" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="141" x="1561.95" y="994.7496">TraceableSignatureComputationData</text><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="1400.4" x2="1838.4" y1="1000.8715" y2="1000.8715"/><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="1400.4" x2="1838.4" y1="1005.6715" y2="1005.6715"/><ellipse cx="1406.4" cy="1014.5578" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="423.6" x="1411.8" y="1017.1359">TraceableSignatureComputationData withSamTraceabilityMode (int offset, boolean usePartialSamSerialNumber)</text><ellipse cx="1406.4" cy="1025.7305" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="217.8" x="1411.8" y="1028.3086">TraceableSignatureComputationData withoutBusyMode ()</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="1411.8" y="1039.4813"> </text><ellipse cx="1406.4" cy="1048.0758" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="88.2" x="1411.8" y="1050.6539">byte[] getSignedData ()</text></g><!--MD5=[49815161954875a46b9e77877b8c8585]
class CommonSignatureVerificationData--><g id="elem_CommonSignatureVerificationData"><rect codeLine="158" fill="#FEFECE" height="73.4906" id="CommonSignatureVerificationData" rx="1.5" ry="1.5" style="stroke:#D4AC0D;stroke-width:1.2;" width="319.8" x="2250.9" y="777.9715"/><ellipse cx="2259.9" cy="787.5715" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M2260.4719,785.5559 L2260.4719,789.5496 L2261.5031,789.5496 Q2261.8688,789.5496 2262.0281,789.6902 Q2262.1875,789.8309 2262.1875,790.0652 Q2262.1875,790.2902 2262.0281,790.4309 Q2261.8688,790.5715 2261.5031,790.5715 L2258.4188,790.5715 Q2258.0531,790.5715 2257.8937,790.4309 Q2257.7344,790.2902 2257.7344,790.0559 Q2257.7344,789.8309 2257.8937,789.6902 Q2258.0531,789.5496 2258.4188,789.5496 L2259.45,789.5496 L2259.45,785.5559 L2258.4188,785.5559 Q2258.0531,785.5559 2257.8937,785.4152 Q2257.7344,785.2746 2257.7344,785.0402 Q2257.7344,784.8152 2257.8937,784.6746 Q2258.0531,784.534 2258.4188,784.534 L2261.5031,784.534 Q2261.8688,784.534 2262.0281,784.6746 Q2262.1875,784.8152 2262.1875,785.0402 Q2262.1875,785.2746 2262.0281,785.4152 Q2261.8688,785.5559 2261.5031,785.5559 L2260.4719,785.5559 Z " fill="#000000"/><ellipse cx="2271.3" cy="787.2715" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="130.2" x="2274.9" y="791.0496">CommonSignatureVerificationData</text><rect fill="#FFFFFF" height="10.7766" style="stroke:#D4AC0D;stroke-width:0.6;stroke-dasharray:2.0,2.0;" width="162.6" x="2409.9" y="776.1715"/><text fill="#000000" font-family="sans-serif" font-size="7.2" font-style="italic" lengthAdjust="spacing" textLength="161.4" x="2410.5" y="784.541">T extends CommonSignatureVerificationData&lt;T&gt;</text><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="2251.5" x2="2570.1" y1="797.1715" y2="797.1715"/><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="2251.5" x2="2570.1" y1="801.9715" y2="801.9715"/><ellipse cx="2257.5" cy="810.8578" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="217.2" x="2262.9" y="813.4359">T setData (byte[] data, byte[] signature, byte kif, byte kvc)</text><ellipse cx="2257.5" cy="822.0305" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="139.8" x="2262.9" y="824.6086">T setKeyDiversifier (byte[] diversifier)</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="2262.9" y="835.7813"> </text><ellipse cx="2257.5" cy="844.3758" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="102.6" x="2262.9" y="846.9539">boolean isSignatureValid ()</text></g><!--MD5=[792b97716737da270761df73939131ae]
class BasicSignatureVerificationData--><g id="elem_BasicSignatureVerificationData"><rect codeLine="164" fill="#FEFECE" height="28.8" id="BasicSignatureVerificationData" rx="1.5" ry="1.5" style="stroke:#D4AC0D;stroke-width:1.2;" width="142.8" x="2029.8" y="1003.8715"/><ellipse cx="2038.8" cy="1013.4715" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M2039.3719,1011.4559 L2039.3719,1015.4496 L2040.4031,1015.4496 Q2040.7688,1015.4496 2040.9281,1015.5902 Q2041.0875,1015.7309 2041.0875,1015.9652 Q2041.0875,1016.1902 2040.9281,1016.3309 Q2040.7688,1016.4715 2040.4031,1016.4715 L2037.3188,1016.4715 Q2036.9531,1016.4715 2036.7937,1016.3309 Q2036.6344,1016.1902 2036.6344,1015.9559 Q2036.6344,1015.7309 2036.7937,1015.5902 Q2036.9531,1015.4496 2037.3188,1015.4496 L2038.35,1015.4496 L2038.35,1011.4559 L2037.3188,1011.4559 Q2036.9531,1011.4559 2036.7937,1011.3152 Q2036.6344,1011.1746 2036.6344,1010.9402 Q2036.6344,1010.7152 2036.7937,1010.5746 Q2036.9531,1010.434 2037.3188,1010.434 L2040.4031,1010.434 Q2040.7688,1010.434 2040.9281,1010.5746 Q2041.0875,1010.7152 2041.0875,1010.9402 Q2041.0875,1011.1746 2040.9281,1011.3152 Q2040.7688,1011.4559 2040.4031,1011.4559 L2039.3719,1011.4559 Z " fill="#000000"/><ellipse cx="2050.2" cy="1013.1715" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="117" x="2053.8" y="1016.9496">BasicSignatureVerificationData</text><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="2030.4" x2="2172" y1="1023.0715" y2="1023.0715"/><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="2030.4" x2="2172" y1="1027.8715" y2="1027.8715"/></g><!--MD5=[2fc7953a0035a8aa989ea0d75f9f7d1b]
class TraceableSignatureVerificationData--><g id="elem_TraceableSignatureVerificationData"><rect codeLine="166" fill="#FEFECE" height="51.1453" id="TraceableSignatureVerificationData" rx="1.5" ry="1.5" style="stroke:#D4AC0D;stroke-width:1.2;" width="646.2" x="2193.9" y="992.7715"/><ellipse cx="2443.65" cy="1002.3715" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M2444.2219,1000.3559 L2444.2219,1004.3496 L2445.2531,1004.3496 Q2445.6188,1004.3496 2445.7781,1004.4902 Q2445.9375,1004.6309 2445.9375,1004.8652 Q2445.9375,1005.0902 2445.7781,1005.2309 Q2445.6188,1005.3715 2445.2531,1005.3715 L2442.1688,1005.3715 Q2441.8031,1005.3715 2441.6437,1005.2309 Q2441.4844,1005.0902 2441.4844,1004.8559 Q2441.4844,1004.6309 2441.6437,1004.4902 Q2441.8031,1004.3496 2442.1688,1004.3496 L2443.2,1004.3496 L2443.2,1000.3559 L2442.1688,1000.3559 Q2441.8031,1000.3559 2441.6437,1000.2152 Q2441.4844,1000.0746 2441.4844,999.8402 Q2441.4844,999.6152 2441.6437,999.4746 Q2441.8031,999.334 2442.1688,999.334 L2445.2531,999.334 Q2445.6188,999.334 2445.7781,999.4746 Q2445.9375,999.6152 2445.9375,999.8402 Q2445.9375,1000.0746 2445.7781,1000.2152 Q2445.6188,1000.3559 2445.2531,1000.3559 L2444.2219,1000.3559 Z " fill="#000000"/><ellipse cx="2458.95" cy="1002.0715" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="135" x="2462.55" y="1005.8496">TraceableSignatureVerificationData</text><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="2194.5" x2="2839.5" y1="1011.9715" y2="1011.9715"/><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="2194.5" x2="2839.5" y1="1016.7715" y2="1016.7715"/><ellipse cx="2200.5" cy="1025.6578" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="630.6" x="2205.9" y="1028.2359">TraceableSignatureVerificationData withSamTraceabilityMode (int offset, boolean isPartialSamSerialNumber, LegacySamRevocationServiceSpi samRevocationService)</text><ellipse cx="2200.5" cy="1036.8305" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="211.8" x="2205.9" y="1039.4086">TraceableSignatureVerificationData withoutBusyMode ()</text></g><!--MD5=[aa01caadf6d9a83d859979c9253c2540]
class SignatureDataFactory--><g id="elem_SignatureDataFactory"><rect codeLine="275" fill="#FDEDEC" height="73.4906" id="SignatureDataFactory" rx="1.5" ry="1.5" style="stroke:#E74C3C;stroke-width:1.2;" width="332.4" x="1851.6" y="1117.5715"/><ellipse cx="1970.25" cy="1127.1715" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M1970.8219,1125.1559 L1970.8219,1129.1496 L1971.8531,1129.1496 Q1972.2188,1129.1496 1972.3781,1129.2902 Q1972.5375,1129.4309 1972.5375,1129.6652 Q1972.5375,1129.8902 1972.3781,1130.0309 Q1972.2188,1130.1715 1971.8531,1130.1715 L1968.7688,1130.1715 Q1968.4031,1130.1715 1968.2437,1130.0309 Q1968.0844,1129.8902 1968.0844,1129.6559 Q1968.0844,1129.4309 1968.2437,1129.2902 Q1968.4031,1129.1496 1968.7688,1129.1496 L1969.8,1129.1496 L1969.8,1125.1559 L1968.7688,1125.1559 Q1968.4031,1125.1559 1968.2437,1125.0152 Q1968.0844,1124.8746 1968.0844,1124.6402 Q1968.0844,1124.4152 1968.2437,1124.2746 Q1968.4031,1124.134 1968.7688,1124.134 L1971.8531,1124.134 Q1972.2188,1124.134 1972.3781,1124.2746 Q1972.5375,1124.4152 1972.5375,1124.6402 Q1972.5375,1124.8746 1972.3781,1125.0152 Q1972.2188,1125.1559 1971.8531,1125.1559 L1970.8219,1125.1559 Z " fill="#000000"/><ellipse cx="1985.55" cy="1126.8715" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="83.4" x="1989.15" y="1130.6496">SignatureDataFactory</text><line style="stroke:#E74C3C;stroke-width:1.2;" x1="1852.2" x2="2183.4" y1="1136.7715" y2="1136.7715"/><line style="stroke:#E74C3C;stroke-width:1.2;" x1="1852.2" x2="2183.4" y1="1141.5715" y2="1141.5715"/><ellipse cx="1858.2" cy="1150.4578" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="280.8" x="1863.6" y="1153.0359">BasicSignatureComputationData createBasicSignatureComputationData ()</text><ellipse cx="1858.2" cy="1161.6305" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="316.8" x="1863.6" y="1164.2086">TraceableSignatureComputationData createTraceableSignatureComputationData ()</text><ellipse cx="1858.2" cy="1172.8031" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="268.8" x="1863.6" y="1175.3813">BasicSignatureVerificationData createBasicSignatureVerificationData ()</text><ellipse cx="1858.2" cy="1183.9758" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="304.8" x="1863.6" y="1186.5539">TraceableSignatureVerificationData createTraceableSignatureVerificationData ()</text></g><!--MD5=[f828a509400a69824ac8cdade397711f]
class LegacySamSelection--><g id="elem_LegacySamSelection"><rect codeLine="280" fill="#E9F7EF" height="82.6359" id="LegacySamSelection" rx="1.5" ry="1.5" style="stroke:#27AE60;stroke-width:1.2;" width="325.8" x="27.9" y="773.1715"/><ellipse cx="145.35" cy="787.3441" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M145.9219,785.3285 L145.9219,789.3223 L146.9531,789.3223 Q147.3188,789.3223 147.4781,789.4629 Q147.6375,789.6035 147.6375,789.8379 Q147.6375,790.0629 147.4781,790.2035 Q147.3188,790.3441 146.9531,790.3441 L143.8688,790.3441 Q143.5031,790.3441 143.3438,790.2035 Q143.1844,790.0629 143.1844,789.8285 Q143.1844,789.6035 143.3438,789.4629 Q143.5031,789.3223 143.8688,789.3223 L144.9,789.3223 L144.9,785.3285 L143.8688,785.3285 Q143.5031,785.3285 143.3438,785.1879 Q143.1844,785.0473 143.1844,784.8129 Q143.1844,784.5879 143.3438,784.4473 Q143.5031,784.3066 143.8688,784.3066 L146.9531,784.3066 Q147.3188,784.3066 147.4781,784.4473 Q147.6375,784.5879 147.6375,784.8129 Q147.6375,785.0473 147.4781,785.1879 Q147.3188,785.3285 146.9531,785.3285 L145.9219,785.3285 Z " fill="#000000"/><ellipse cx="160.65" cy="787.0441" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="9.6" x="167.55" y="785.2359">&lt;&lt;</text><text fill="#000000" filter="url(#bhzt9eew29ubw0)" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="53.4" x="177.15" y="785.2359">CardSelection</text><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="9.6" x="230.55" y="785.2359">&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="79.2" x="164.25" y="796.4086">LegacySamSelection</text><line style="stroke:#27AE60;stroke-width:1.2;" x1="28.5" x2="353.1" y1="801.5168" y2="801.5168"/><line style="stroke:#27AE60;stroke-width:1.2;" x1="28.5" x2="353.1" y1="806.3168" y2="806.3168"/><ellipse cx="34.5" cy="815.2031" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="310.2" x="39.9" y="817.7813">LegacySamSelection filterByProductType (LegacySam.ProductType productType)</text><ellipse cx="34.5" cy="826.3758" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="265.2" x="39.9" y="828.9539">LegacySamSelection filterBySerialNumber (String serialNumberRegex)</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="39.9" y="840.1266"> </text><ellipse cx="34.5" cy="848.7211" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="211.8" x="39.9" y="851.2992">LegacySamSelection setUnlockData (String unlockData)</text></g><!--MD5=[756cbdb2eeffdcd67180b97f5e83c8e0]
class LegacySam--><g id="elem_LegacySam"><rect codeLine="185" fill="#FEFECE" height="216.7078" id="LegacySam" rx="1.5" ry="1.5" style="stroke:#D4AC0D;stroke-width:1.2;" width="209.4" x="374.7" y="706.2715"/><ellipse cx="443.55" cy="720.4441" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M444.1219,718.4285 L444.1219,722.4223 L445.1531,722.4223 Q445.5188,722.4223 445.6781,722.5629 Q445.8375,722.7035 445.8375,722.9379 Q445.8375,723.1629 445.6781,723.3035 Q445.5188,723.4441 445.1531,723.4441 L442.0687,723.4441 Q441.7031,723.4441 441.5438,723.3035 Q441.3844,723.1629 441.3844,722.9285 Q441.3844,722.7035 441.5438,722.5629 Q441.7031,722.4223 442.0687,722.4223 L443.1,722.4223 L443.1,718.4285 L442.0687,718.4285 Q441.7031,718.4285 441.5438,718.2879 Q441.3844,718.1473 441.3844,717.9129 Q441.3844,717.6879 441.5438,717.5473 Q441.7031,717.4066 442.0687,717.4066 L445.1531,717.4066 Q445.5188,717.4066 445.6781,717.5473 Q445.8375,717.6879 445.8375,717.9129 Q445.8375,718.1473 445.6781,718.2879 Q445.5188,718.4285 445.1531,718.4285 L444.1219,718.4285 Z " fill="#000000"/><ellipse cx="458.85" cy="720.1441" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="9.6" x="462.45" y="718.3359">&lt;&lt;</text><text fill="#000000" filter="url(#bhzt9eew29ubw0)" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="40.8" x="472.05" y="718.3359">SmartCard</text><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="9.6" x="512.85" y="718.3359">&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="44.4" x="470.25" y="729.5086">LegacySam</text><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="375.3" x2="583.5" y1="734.6168" y2="734.6168"/><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="375.3" x2="583.5" y1="739.4168" y2="739.4168"/><ellipse cx="381.3" cy="748.3031" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="120" x="386.7" y="750.8813">ProductType getProductType ()</text><ellipse cx="381.3" cy="759.4758" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="88.2" x="386.7" y="762.0539">String getProductInfo ()</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="386.7" y="773.2266"> </text><ellipse cx="381.3" cy="781.8211" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="94.8" x="386.7" y="784.3992">byte[] getSerialNumber ()</text><ellipse cx="381.3" cy="792.9938" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="70.2" x="386.7" y="795.5719">byte getPlatform ()</text><ellipse cx="381.3" cy="804.1664" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="99.6" x="386.7" y="806.7445">byte getApplicationType ()</text><ellipse cx="381.3" cy="815.3391" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="114.6" x="386.7" y="817.9172">byte getApplicationSubType ()</text><ellipse cx="381.3" cy="826.5117" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="94.8" x="386.7" y="829.0898">byte getSoftwareIssuer ()</text><ellipse cx="381.3" cy="837.6844" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="100.8" x="386.7" y="840.2625">byte getSoftwareVersion ()</text><ellipse cx="381.3" cy="848.857" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="104.4" x="386.7" y="851.4352">byte getSoftwareRevision ()</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="386.7" y="862.6078"> </text><ellipse cx="381.3" cy="871.2023" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="193.8" x="386.7" y="873.7805">Integer getEventCounter (int eventCounterNumber)</text><ellipse cx="381.3" cy="882.375" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="187.8" x="386.7" y="884.9531">SortedMap&lt;Integer, Integer&gt; getEventCounters ()</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="386.7" y="896.1258"> </text><ellipse cx="381.3" cy="904.7203" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="184.2" x="386.7" y="907.2984">Integer getEventCeiling (int eventCeilingNumber)</text><ellipse cx="381.3" cy="915.893" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="183" x="386.7" y="918.4711">SortedMap&lt;Integer, Integer&gt; getEventCeilings ()</text></g><!--MD5=[64db2d10778acf6b7b903aeb76cb16f8]
class SamProductType--><g id="elem_SamProductType"><rect codeLine="203" fill="#FEFECE" height="95.8359" id="SamProductType" rx="1.5" ry="1.5" style="stroke:#D4AC0D;stroke-width:1.2;" width="74.4" x="417.6" y="970.2715"/><ellipse cx="426.6" cy="979.8715" fill="#EB937F" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M425.9156,980.3496 L425.9156,981.8496 L428.5125,981.8496 L428.5125,981.2965 Q428.5125,980.9309 428.6531,980.7715 Q428.8031,980.6121 429.0281,980.6121 Q429.2531,980.6121 429.3938,980.7715 Q429.5344,980.9309 429.5344,981.2965 L429.5344,982.8715 L424.7344,982.8715 Q424.3594,982.8715 424.2,982.7309 Q424.05,982.5902 424.05,982.3559 Q424.05,982.1309 424.2094,981.9902 Q424.3688,981.8496 424.7344,981.8496 L424.8938,981.8496 L424.8938,977.8559 L424.7344,977.8559 Q424.3594,977.8559 424.2,977.7152 Q424.05,977.5746 424.05,977.3402 Q424.05,977.1152 424.2,976.9746 Q424.3594,976.834 424.7344,976.834 L429.3094,976.834 L429.3094,978.3902 Q429.3094,978.7559 429.1688,978.9152 Q429.0375,979.0652 428.8031,979.0652 Q428.5781,979.0652 428.4375,978.9152 Q428.2969,978.7559 428.2969,978.3902 L428.2969,977.8559 L425.9156,977.8559 L425.9156,979.3277 L426.8063,979.3277 Q426.8063,978.934 426.8812,978.8215 Q427.0406,978.5777 427.3219,978.5777 Q427.5469,978.5777 427.6875,978.7371 Q427.8281,978.8871 427.8281,979.2527 L427.8281,980.434 Q427.8281,980.7621 427.7531,980.8746 Q427.5938,981.109 427.3219,981.109 Q427.0406,981.109 426.8812,980.8652 Q426.8063,980.7527 426.8063,980.3496 L425.9156,980.3496 Z " fill="#000000"/><ellipse cx="438" cy="979.5715" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="48.6" x="441.6" y="983.3496">ProductType</text><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="418.2" x2="491.4" y1="989.4715" y2="989.4715"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="33" x="421.2" y="1000.9359">SAM_C1</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="33" x="421.2" y="1012.1086">HSM_C1</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="42.6" x="421.2" y="1023.2813">SAM_S1E1</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="42" x="421.2" y="1034.4539">SAM_S1Dx</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="33.6" x="421.2" y="1045.6266">CSAM_F</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="41.4" x="421.2" y="1056.7992">UNKNOWN</text><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="418.2" x2="491.4" y1="1061.3074" y2="1061.3074"/></g><!--MD5=[a91ea8a99ecb7d51266e633c607a59bb]
class LegacySamRevocationServiceSpi--><g id="elem_LegacySamRevocationServiceSpi"><rect codeLine="213" fill="#FEFECE" height="51.1453" id="LegacySamRevocationServiceSpi" rx="1.5" ry="1.5" style="stroke:#D4AC0D;stroke-width:1.2;" width="253.2" x="2888.4" y="1128.6715"/><ellipse cx="2946.15" cy="1138.2715" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M2946.7219,1136.2559 L2946.7219,1140.2496 L2947.7531,1140.2496 Q2948.1188,1140.2496 2948.2781,1140.3902 Q2948.4375,1140.5309 2948.4375,1140.7652 Q2948.4375,1140.9902 2948.2781,1141.1309 Q2948.1188,1141.2715 2947.7531,1141.2715 L2944.6688,1141.2715 Q2944.3031,1141.2715 2944.1437,1141.1309 Q2943.9844,1140.9902 2943.9844,1140.7559 Q2943.9844,1140.5309 2944.1437,1140.3902 Q2944.3031,1140.2496 2944.6688,1140.2496 L2945.7,1140.2496 L2945.7,1136.2559 L2944.6688,1136.2559 Q2944.3031,1136.2559 2944.1437,1136.1152 Q2943.9844,1135.9746 2943.9844,1135.7402 Q2943.9844,1135.5152 2944.1437,1135.3746 Q2944.3031,1135.234 2944.6688,1135.234 L2947.7531,1135.234 Q2948.1188,1135.234 2948.2781,1135.3746 Q2948.4375,1135.5152 2948.4375,1135.7402 Q2948.4375,1135.9746 2948.2781,1136.1152 Q2948.1188,1136.2559 2947.7531,1136.2559 L2946.7219,1136.2559 Z " fill="#000000"/><ellipse cx="2961.45" cy="1137.9715" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="126" x="2965.05" y="1141.7496">LegacySamRevocationServiceSpi</text><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="2889" x2="3141" y1="1147.8715" y2="1147.8715"/><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="2889" x2="3141" y1="1152.6715" y2="1152.6715"/><ellipse cx="2895" cy="1161.5578" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="171" x="2900.4" y="1164.1359">boolean isSamRevoked (byte[] serialNumber)</text><ellipse cx="2895" cy="1172.7305" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="237.6" x="2900.4" y="1175.3086">boolean isSamRevoked (byte[] serialNumber, int counterValue)</text></g><!--MD5=[9f9e452891b394849e9149e2c852154b]
reverse link LegacySamTransactionManager to LegacySamReadTransactionManager--><g id="link_LegacySamTransactionManager_LegacySamReadTransactionManager"><path d="M1807.836,202.3555 C1833.84,231.7855 1872.936,276.0235 1909.53,317.4295 " fill="none" id="LegacySamTransactionManager-backto-LegacySamReadTransactionManager" style="stroke:#181818;stroke-width:1.2;"/><polygon fill="none" points="1804.668,205.1155,1799.868,193.3435,1810.962,199.5535,1804.668,205.1155" style="stroke:#181818;stroke-width:1.2;"/></g><!--MD5=[f7ac68152805076048aaa8013cf2a34e]
reverse link LegacySamTransactionManager to LegacySamFreeWriteTransactionManager--><g id="link_LegacySamTransactionManager_LegacySamFreeWriteTransactionManager"><path d="M1690.71,197.1355 C1658.688,207.7135 1622.718,219.5935 1591.794,229.8055 " fill="none" id="LegacySamTransactionManager-backto-LegacySamFreeWriteTransactionManager" style="stroke:#181818;stroke-width:1.2;"/><polygon fill="none" points="1689.6,193.0795,1702.308,193.3015,1692.234,201.0535,1689.6,193.0795" style="stroke:#181818;stroke-width:1.2;"/></g><!--MD5=[0f8f45f4589ff3d71cd79e03f4a5e8af]
reverse link LegacySamFreeWriteTransactionManager to LegacySamWriteTransactionManager--><g id="link_LegacySamFreeWriteTransactionManager_LegacySamWriteTransactionManager"><path d="M1453.53,286.2415 C1409.97,307.2775 1350.288,336.1075 1296.378,362.1475 " fill="none" id="LegacySamFreeWriteTransactionManager-backto-LegacySamWriteTransactionManager" style="stroke:#181818;stroke-width:1.2;"/><polygon fill="none" points="1451.892,282.3715,1464.522,280.9315,1455.546,289.9315,1451.892,282.3715" style="stroke:#181818;stroke-width:1.2;"/></g><!--MD5=[20d25d6eaea103eca888d235be4725d2]
reverse link LegacySamReadTransactionManager to LegacySamSecureReadTransactionManager--><g id="link_LegacySamReadTransactionManager_LegacySamSecureReadTransactionManager"><path d="M1865.526,544.2775 C1838.886,566.4415 1814.586,586.6555 1799.274,599.3995 " fill="none" id="LegacySamReadTransactionManager-backto-LegacySamSecureReadTransactionManager" style="stroke:#181818;stroke-width:1.2;"/><polygon fill="none" points="1862.922,540.9775,1874.832,536.5315,1868.298,547.4395,1862.922,540.9775" style="stroke:#181818;stroke-width:1.2;"/></g><!--MD5=[031a2811e980e04bb25a6d3a1f328743]
reverse link LegacySamReadTransactionManager to LegacySamFreeTransactionManager--><g id="link_LegacySamReadTransactionManager_LegacySamFreeTransactionManager"><path d="M2079.876,546.9835 C2089.482,562.4695 2098.422,576.8815 2105.496,588.2815 " fill="none" id="LegacySamReadTransactionManager-backto-LegacySamFreeTransactionManager" style="stroke:#181818;stroke-width:1.2;"/><polygon fill="none" points="2076.234,549.0775,2073.48,536.6695,2083.374,544.6495,2076.234,549.0775" style="stroke:#181818;stroke-width:1.2;"/></g><!--MD5=[528c0e2c879dda1647f1abd7732b2860]
reverse link LegacySamFreeWriteTransactionManager to LegacySamFreeTransactionManager--><g id="link_LegacySamFreeWriteTransactionManager_LegacySamFreeTransactionManager"><path d="M1540.728,290.6695 C1584.996,350.5675 1684.284,473.0275 1798.2,536.4715 C1830.438,554.4295 1911.27,573.6475 1983.972,588.3715 " fill="none" id="LegacySamFreeWriteTransactionManager-backto-LegacySamFreeTransactionManager" style="stroke:#181818;stroke-width:1.2;"/><polygon fill="none" points="1537.296,293.0935,1533.606,280.9255,1544.082,288.1375,1537.296,293.0935" style="stroke:#181818;stroke-width:1.2;"/></g><!--MD5=[6914754a0680d6b255ec09e573377449]
reverse link LegacySamWriteTransactionManager to LegacySamSecureWriteTransactionManager--><g id="link_LegacySamWriteTransactionManager_LegacySamSecureWriteTransactionManager"><path d="M1163.4,504.0055 C1163.4,539.8735 1163.4,579.1255 1163.4,599.4055 " fill="none" id="LegacySamWriteTransactionManager-backto-LegacySamSecureWriteTransactionManager" style="stroke:#181818;stroke-width:1.2;"/><polygon fill="none" points="1159.2,503.9995,1163.4,491.9995,1167.6,503.9995,1159.2,503.9995" style="stroke:#181818;stroke-width:1.2;"/></g><!--MD5=[504edd26467f0771a9311e605d7d25b3]
reverse link LegacySamTransactionManager to LegacyTargetSamAsyncTransactionManager--><g id="link_LegacySamTransactionManager_LegacyTargetSamAsyncTransactionManager"><path d="M1779.672,205.4095 C1779.474,228.0715 1776.756,257.1715 1766.4,280.8715 C1704.36,422.8135 1558.542,547.0075 1499.004,593.6395 " fill="none" id="LegacySamTransactionManager-backto-LegacyTargetSamAsyncTransactionManager" style="stroke:#181818;stroke-width:1.2;"/><polygon fill="none" points="1775.472,205.4275,1779.546,193.3855,1783.872,205.3435,1775.472,205.4275" style="stroke:#181818;stroke-width:1.2;"/></g><!--MD5=[3a156483b371d7bcf5bd0077bcf92dbb]
reverse link LegacySamWriteTransactionManager to LegacyControlSamAsyncTransactionManager--><g id="link_LegacySamWriteTransactionManager_LegacyControlSamAsyncTransactionManager"><path d="M1040.31,497.8615 C984.654,529.6435 922.422,565.1755 881.91,588.3115 " fill="none" id="LegacySamWriteTransactionManager-backto-LegacyControlSamAsyncTransactionManager" style="stroke:#181818;stroke-width:1.2;"/><polygon fill="none" points="1038.3,494.1715,1050.804,491.8675,1042.464,501.4675,1038.3,494.1715" style="stroke:#181818;stroke-width:1.2;"/></g><!--MD5=[007eb89bfb10701b962958f5b6fc0ebb]
reverse link CommonSignatureComputationData to BasicSignatureComputationData--><g id="link_CommonSignatureComputationData_BasicSignatureComputationData"><path d="M1969.728,868.6405 C1958.946,914.1217 1944.21,976.2931 1937.706,1003.7119 " fill="none" id="CommonSignatureComputationData-backto-BasicSignatureComputationData" style="stroke:#181818;stroke-width:1.2;"/><polygon fill="none" points="1965.66,867.5917,1972.512,856.8841,1973.832,869.5291,1965.66,867.5917" style="stroke:#181818;stroke-width:1.2;"/></g><!--MD5=[f429252bb447dd4a1aa4e00c09503393]
reverse link CommonSignatureComputationData to TraceableSignatureComputationData--><g id="link_CommonSignatureComputationData_TraceableSignatureComputationData"><path d="M1917.486,864.1189 C1878.714,892.0465 1827.78,926.5087 1779.6,952.2715 C1759.8,962.8597 1737.9,972.8407 1716.822,981.6661 " fill="none" id="CommonSignatureComputationData-backto-TraceableSignatureComputationData" style="stroke:#181818;stroke-width:1.2;"/><polygon fill="none" points="1915.146,860.6287,1927.326,856.9843,1920.072,867.4291,1915.146,860.6287" style="stroke:#181818;stroke-width:1.2;"/></g><!--MD5=[e2b6e3fe5a6a0a5bd0ef8dd67224f7af]
reverse link CommonSignatureVerificationData to BasicSignatureVerificationData--><g id="link_CommonSignatureVerificationData_BasicSignatureVerificationData"><path d="M2345.556,857.8471 C2275.35,903.7657 2167.686,974.1835 2122.416,1003.7953 " fill="none" id="CommonSignatureVerificationData-backto-BasicSignatureVerificationData" style="stroke:#181818;stroke-width:1.2;"/><polygon fill="none" points="2343.288,854.3113,2355.63,851.2579,2347.884,861.3415,2343.288,854.3113" style="stroke:#181818;stroke-width:1.2;"/></g><!--MD5=[e31b41de38b178ddac6d238f38182a2b]
reverse link CommonSignatureVerificationData to TraceableSignatureVerificationData--><g id="link_CommonSignatureVerificationData_TraceableSignatureVerificationData"><path d="M2435.424,862.1191 C2456.766,902.8231 2486.838,960.1561 2503.872,992.6413 " fill="none" id="CommonSignatureVerificationData-backto-TraceableSignatureVerificationData" style="stroke:#181818;stroke-width:1.2;"/><polygon fill="none" points="2431.638,863.9521,2429.784,851.3743,2439.078,860.0509,2431.638,863.9521" style="stroke:#181818;stroke-width:1.2;"/></g><!--MD5=[5eec432a2e7681a202b7f172e8f9a6f9]
reverse link LegacySamSecureReadTransactionManager to LegacySamTransactionManagerFactory--><g id="link_LegacySamSecureReadTransactionManager_LegacySamTransactionManagerFactory"><path codeLine="222" d="M1752.024,629.6935 C1730.574,639.6253 1700.916,651.8941 1673.4,658.2715 C1550.448,686.7667 1513.29,651.3799 1390.2,679.2715 C1298.508,700.0489 1198.992,740.9389 1130.4,772.2427 " fill="none" id="LegacySamSecureReadTransactionManager-backto-LegacySamTransactionManagerFactory" style="stroke:#3498DB;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="1754.862,628.3675,1748.9537,628.4772,1752.1437,629.6366,1750.9843,632.8266,1754.862,628.3675" style="stroke:#3498DB;stroke-width:1.2;"/><polygon fill="#000000" points="1651.7241,668.1882,1646.0402,667.6825,1646.8285,671.12,1651.7241,668.1882" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="24" x="1654.2" y="672.0885">provide</text></g><!--MD5=[930cc0e3723a66cd8ccad631e2179266]
reverse link LegacySamFreeTransactionManager to LegacySamTransactionManagerFactory--><g id="link_LegacySamFreeTransactionManager_LegacySamTransactionManagerFactory"><path codeLine="223" d="M2000.946,639.9469 C1965.714,646.7191 1927.026,653.4745 1891.2,658.2715 C1799.472,670.5541 1776.042,670.1125 1683.6,674.4715 C1651.032,676.0069 1422.192,672.9859 1390.2,679.2715 C1296.522,697.6765 1195.446,739.9375 1126.95,772.2523 " fill="none" id="LegacySamFreeTransactionManager-backto-LegacySamTransactionManagerFactory" style="stroke:#3498DB;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="2003.91,639.3757,1998.1543,638.0371,2000.9638,639.9414,1999.0595,642.751,2003.91,639.3757" style="stroke:#3498DB;stroke-width:1.2;"/><polygon fill="#000000" points="1858.1662,668.4098,1852.5364,667.4786,1853.0642,670.9655,1858.1662,668.4098" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="24" x="1860.6" y="672.0885">provide</text></g><!--MD5=[44d345cd8829add454056d1b5883f290]
reverse link LegacySamSecureWriteTransactionManager to LegacySamTransactionManagerFactory--><g id="link_LegacySamSecureWriteTransactionManager_LegacySamTransactionManagerFactory"><path codeLine="224" d="M1153.542,631.0195 C1135.266,661.7203 1095.588,728.3431 1069.506,772.1515 " fill="none" id="LegacySamSecureWriteTransactionManager-backto-LegacySamTransactionManagerFactory" style="stroke:#3498DB;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="1155.138,628.3435,1150.3151,631.7581,1153.6046,630.922,1154.4407,634.2115,1155.138,628.3435" style="stroke:#3498DB;stroke-width:1.2;"/><polygon fill="#000000" points="1136.1348,666.2811,1131.8432,670.042,1134.8734,671.8463,1136.1348,666.2811" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="24" x="1140" y="672.0885">provide</text></g><!--MD5=[cc6f50cc5c136908bea67ca390bbeeef]
reverse link LegacyControlSamAsyncTransactionManager to LegacySamTransactionManagerFactory--><g id="link_LegacyControlSamAsyncTransactionManager_LegacySamTransactionManagerFactory"><path codeLine="225" d="M866.388,641.7169 C901.188,675.3517 960.732,732.9073 1001.334,772.1527 " fill="none" id="LegacyControlSamAsyncTransactionManager-backto-LegacySamTransactionManagerFactory" style="stroke:#3498DB;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="864.132,639.5365,866.35,645.0138,866.2903,641.6202,869.6839,641.5605,864.132,639.5365" style="stroke:#3498DB;stroke-width:1.2;"/><polygon fill="#000000" points="900.2429,666.7738,902.9196,671.8135,905.3706,669.2777,900.2429,666.7738" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="24" x="907.8" y="672.0885">provide</text></g><!--MD5=[c4abfb60445517bf9515839c1a244717]
reverse link LegacyTargetSamAsyncTransactionManager to LegacySamTransactionManagerFactory--><g id="link_LegacyTargetSamAsyncTransactionManager_LegacySamTransactionManagerFactory"><path codeLine="226" d="M1428.096,635.3815 C1358.688,667.7047 1223.982,730.4347 1134.144,772.2709 " fill="none" id="LegacyTargetSamAsyncTransactionManager-backto-LegacySamTransactionManagerFactory" style="stroke:#3498DB;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="1430.946,634.0555,1425.0376,634.1581,1428.2261,635.3213,1427.0629,638.5099,1430.946,634.0555" style="stroke:#3498DB;stroke-width:1.2;"/><polygon fill="#000000" points="1364.1196,667.5923,1358.4554,668.2849,1359.9442,671.4819,1364.1196,667.5923" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="24" x="1366.8" y="672.0885">provide</text></g><!--MD5=[ee4c6bba2bffa26e564d306e93d46670]
reverse link LegacySam to LegacySamTransactionManagerFactory--><g id="link_LegacySam_LegacySamTransactionManagerFactory"><path codeLine="227" d="M587.226,814.5715 C623.046,814.5715 665.028,814.5715 708.78,814.5715 " fill="none" id="LegacySam-backto-LegacySamTransactionManagerFactory" style="stroke:#27AE60;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="584.22,814.5715,589.62,816.9715,587.22,814.5715,589.62,812.1715,584.22,814.5715" style="stroke:#27AE60;stroke-width:1.2;"/><polygon fill="#000000" points="635.7,807.1588,641.1271,808.9221,641.1271,805.3954,635.7,807.1588" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="12.6" x="644.1" y="810.3885">use</text></g><!--MD5=[a622277c2ee75aae5c5fb37b0c7dc1dc]
link LegacySamTransactionManagerFactory to LegacySamSecuritySetting--><g id="link_LegacySamTransactionManagerFactory_LegacySamSecuritySetting"><path codeLine="228" d="M1044.6,856.8841 C1044.6,898.7203 1044.6,961.5901 1044.6,994.9669 " fill="none" id="LegacySamTransactionManagerFactory-to-LegacySamSecuritySetting" style="stroke:#27AE60;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="1044.6,998.1031,1047,992.7031,1044.6,995.1031,1042.2,992.7031,1044.6,998.1031" style="stroke:#27AE60;stroke-width:1.2;"/><polygon fill="#000000" points="1047.6,949.6588,1049.3634,944.2317,1045.8366,944.2317,1047.6,949.6588" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="12.6" x="1053" y="949.8885">use</text></g><!--MD5=[95f889152f0a4a19f624999d24485cd4]
reverse link BasicSignatureComputationData to SignatureDataFactory--><g id="link_BasicSignatureComputationData_SignatureDataFactory"><path codeLine="230" d="M1944.654,1035.4291 C1957.248,1055.7781 1978.986,1090.8853 1995.498,1117.5559 " fill="none" id="BasicSignatureComputationData-backto-SignatureDataFactory" style="stroke:#3498DB;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="1943.01,1032.7795,1943.8166,1038.6335,1944.5912,1035.329,1947.8957,1036.1036,1943.01,1032.7795" style="stroke:#3498DB;stroke-width:1.2;"/><polygon fill="#000000" points="1982.6209,1088.708,1983.9783,1094.2506,1986.9768,1092.3942,1982.6209,1088.708" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="24" x="1989.6" y="1094.4885">provide</text></g><!--MD5=[5611ae606054a3f7e7b10be21e59bbdf]
reverse link TraceableSignatureComputationData to SignatureDataFactory--><g id="link_TraceableSignatureComputationData_SignatureDataFactory"><path codeLine="231" d="M1728.774,1055.8501 C1785.636,1075.0765 1854.858,1098.4801 1911.3,1117.5631 " fill="none" id="TraceableSignatureComputationData-backto-SignatureDataFactory" style="stroke:#3498DB;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="1725.9,1054.8799,1730.2481,1058.8817,1728.7423,1055.8399,1731.7841,1054.3341,1725.9,1054.8799" style="stroke:#3498DB;stroke-width:1.2;"/><polygon fill="#000000" points="1842.758,1090.2979,1847.3344,1093.7066,1848.464,1090.3657,1842.758,1090.2979" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="24" x="1851" y="1094.4885">provide</text></g><!--MD5=[e429e759152b7b30cb622ecc13f90125]
reverse link BasicSignatureVerificationData to SignatureDataFactory--><g id="link_BasicSignatureVerificationData_SignatureDataFactory"><path codeLine="232" d="M2090.946,1035.4291 C2078.352,1055.7781 2056.614,1090.8853 2040.102,1117.5559 " fill="none" id="BasicSignatureVerificationData-backto-SignatureDataFactory" style="stroke:#3498DB;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="2092.59,1032.7795,2087.7043,1036.1036,2091.0088,1035.329,2091.7834,1038.6335,2092.59,1032.7795" style="stroke:#3498DB;stroke-width:1.2;"/><polygon fill="#000000" points="2064.3791,1088.708,2060.0232,1092.3942,2063.0217,1094.2506,2064.3791,1088.708" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="24" x="2068.2" y="1094.4885">provide</text></g><!--MD5=[1801bd2c1037142f6a9306da71264c39]
reverse link TraceableSignatureVerificationData to SignatureDataFactory--><g id="link_TraceableSignatureVerificationData_SignatureDataFactory"><path codeLine="233" d="M2421.63,1044.6061 C2345.04,1065.2713 2236.596,1094.5327 2151.372,1117.5301 " fill="none" id="TraceableSignatureVerificationData-backto-SignatureDataFactory" style="stroke:#3498DB;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="2424.564,1043.8129,2418.7257,1042.8993,2421.6672,1044.5928,2419.9736,1047.5342,2424.564,1043.8129" style="stroke:#3498DB;stroke-width:1.2;"/><polygon fill="#000000" points="2273.2964,1090.4772,2267.5974,1090.1886,2268.5161,1093.5935,2273.2964,1090.4772" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="24" x="2275.8" y="1094.4885">provide</text></g><!--MD5=[50dc2a56e0e850668b2b0d357b7a17bc]
link TraceableSignatureVerificationData to LegacySamRevocationServiceSpi--><g id="link_TraceableSignatureVerificationData_LegacySamRevocationServiceSpi"><path codeLine="235" d="M2624.292,1043.7901 C2689.764,1059.4327 2775.018,1080.5785 2850,1101.6715 C2878.242,1109.6155 2908.956,1119.0547 2936.142,1127.6905 " fill="none" id="TraceableSignatureVerificationData-to-LegacySamRevocationServiceSpi" style="stroke:#27AE60;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="2939.1,1128.6313,2934.6914,1124.6963,2936.2434,1127.7148,2933.225,1129.2668,2939.1,1128.6313" style="stroke:#27AE60;stroke-width:1.2;"/><polygon fill="#000000" points="2837.897,1092.0382,2833.1144,1088.9254,2832.1982,1092.331,2837.897,1092.0382" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="12.6" x="2840.4" y="1094.4885">use</text></g><!--MD5=[f64af45210638694a6e6cc2e547c64cf]
reverse link LegacySamSecuritySetting to LegacySamSecuritySettingFactory--><g id="link_LegacySamSecuritySetting_LegacySamSecuritySettingFactory"><path codeLine="237" d="M1044.6,1041.5347 C1044.6,1067.4373 1044.6,1109.4097 1044.6,1133.9611 " fill="none" id="LegacySamSecuritySetting-backto-LegacySamSecuritySettingFactory" style="stroke:#3498DB;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="1044.6,1038.4579,1042.2,1043.8579,1044.6,1041.4579,1047,1043.8579,1044.6,1038.4579" style="stroke:#3498DB;stroke-width:1.2;"/><polygon fill="#000000" points="1047.6,1088.2588,1045.8366,1093.6858,1049.3634,1093.6858,1047.6,1088.2588" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="24" x="1053" y="1094.4885">provide</text></g><!--MD5=[b61385103effde4c889419da2f560871]
link LegacySamFreeTransactionManager to CommonSignatureComputationData--><g id="link_LegacySamFreeTransactionManager_CommonSignatureComputationData"><path codeLine="239" d="M2084.778,639.4471 C2076.138,646.4527 2067.402,654.5143 2060.4,663.0715 C2034.108,695.1913 2013.15,737.6077 1999.608,769.2883 " fill="none" id="LegacySamFreeTransactionManager-to-CommonSignatureComputationData" style="stroke:#27AE60;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="1998.402,772.1269,2002.7224,768.0953,1999.5751,769.3657,1998.3046,766.2184,1998.402,772.1269" style="stroke:#27AE60;stroke-width:1.2;"/><polygon fill="#000000" points="2061.7545,671.3673,2066.2056,667.7966,2063.2567,665.8622,2061.7545,671.3673" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="12.6" x="2068.8" y="672.0885">use</text></g><!--MD5=[422919c85a46836a095db3d27a5785f3]
link LegacySamFreeTransactionManager to CommonSignatureVerificationData--><g id="link_LegacySamFreeTransactionManager_CommonSignatureVerificationData"><path codeLine="240" d="M2157.408,639.5365 C2207.364,673.9261 2297.58,736.0285 2355.792,776.1031 " fill="none" id="LegacySamFreeTransactionManager-to-CommonSignatureVerificationData" style="stroke:#27AE60;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="2358.366,777.8761,2355.2734,772.8406,2355.893,776.1777,2352.556,776.7974,2358.366,777.8761" style="stroke:#27AE60;stroke-width:1.2;"/><polygon fill="#000000" points="2212.2711,670.5599,2208.8007,666.0301,2206.801,668.9351,2212.2711,670.5599" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="12.6" x="2215.2" y="672.0885">use</text></g><!--MD5=[b965dc537a07ca6882db16269756c131]
link CardTransactionCryptoExtensionFactory to LegacySamCardTransactionCryptoExtension--><g id="link_CardTransactionCryptoExtensionFactory_LegacySamCardTransactionCryptoExtension"><path codeLine="242" d="M2607,447.0955 C2607,478.8415 2607,541.9855 2607,580.6435 " fill="none" id="CardTransactionCryptoExtensionFactory-to-LegacySamCardTransactionCryptoExtension" style="stroke:#3498DB;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="2607,583.8415,2609.4,578.4415,2607,580.8415,2604.6,578.4415,2607,583.8415" style="stroke:#3498DB;stroke-width:1.2;"/><polygon fill="#000000" points="2610,563.2588,2611.7634,557.8317,2608.2366,557.8317,2610,563.2588" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="24" x="2615.4" y="563.4885">provide</text></g><!--MD5=[3226b1a528e01fe19bd12aca23b41295]
link LegacySamCardTransactionCryptoExtension to CommonSignatureComputationData--><g id="link_LegacySamCardTransactionCryptoExtension_CommonSignatureComputationData"><path codeLine="244" d="M2455.722,643.8793 C2420.982,649.6105 2384.112,654.8845 2349.6,658.2715 C2330.022,660.1933 2191.086,656.3455 2172.6,663.0715 C2112.714,684.8563 2057.226,733.5373 2021.832,769.7503 " fill="none" id="LegacySamCardTransactionCryptoExtension-to-CommonSignatureComputationData" style="stroke:#27AE60;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="2019.528,772.1167,2025.0133,769.9187,2021.6196,769.966,2021.5723,766.5722,2019.528,772.1167" style="stroke:#27AE60;stroke-width:1.2;"/><polygon fill="#000000" points="2172.7188,669.6946,2178.4222,669.8761,2177.4397,666.489,2172.7188,669.6946" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="12.6" x="2181" y="672.0885">use</text></g><!--MD5=[97a4ee76ffcefc4f5b4f14314b57fc69]
link LegacySamCardTransactionCryptoExtension to CommonSignatureVerificationData--><g id="link_LegacySamCardTransactionCryptoExtension_CommonSignatureVerificationData"><path codeLine="245" d="M2578.05,643.9087 C2543.718,678.8185 2486.394,737.1055 2448.594,775.5433 " fill="none" id="LegacySamCardTransactionCryptoExtension-to-CommonSignatureVerificationData" style="stroke:#27AE60;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="2446.356,777.8167,2451.8515,775.6442,2448.4575,775.6758,2448.426,772.2818,2446.356,777.8167" style="stroke:#27AE60;stroke-width:1.2;"/><polygon fill="#000000" points="2555.0965,670.9977,2560.159,668.3648,2557.6446,665.8919,2555.0965,670.9977" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="12.6" x="2562.6" y="672.0885">use</text></g><!--MD5=[d1441bb54ec12ef55a7fa9dacfe2aecf]
link LegacySamSelection to SamProductType--><g id="link_LegacySamSelection_SamProductType"><path codeLine="247" d="M244.0656,856.0285 C294.672,894.8461 369.609,952.3261 415.1514,987.2593 " fill="none" id="LegacySamSelection-to-SamProductType" style="stroke:#27AE60;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="417.5676,989.1121,414.7435,983.9213,415.1872,987.2863,411.8222,987.7299,417.5676,989.1121" style="stroke:#27AE60;stroke-width:1.2;"/><polygon fill="#000000" points="374.9804,948.4847,371.7474,943.7825,369.601,946.5808,374.9804,948.4847" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="12.6" x="378" y="949.8885">use</text></g><!--MD5=[3c9b475e2700f2e5f333b2777b638756]
reverse link LegacySam to SamProductType--><g id="link_LegacySam_SamProductType"><path codeLine="249" d="M458.7942,932.0251 C458.439,935.0011 458.1066,937.9537 457.8,940.8715 C456.8106,950.2933 456.1392,960.3967 455.6856,970.0783 " fill="none" id="LegacySam-backto-SamProductType" style="stroke:#181818;stroke-width:1.2;"/><ellipse cx="459.3251" cy="927.802" fill="#FFFFFF" rx="4.8" ry="4.8" style="stroke:#181818;stroke-width:1.2;"/><line style="stroke:#181818;stroke-width:1.2;" x1="458.7263" x2="459.924" y1="932.5645" y2="923.0395"/><line style="stroke:#181818;stroke-width:1.2;" x1="454.5626" x2="464.0876" y1="927.2031" y2="928.4008"/></g><!--MD5=[5ecd342ac4874d804146f75452da1973]
link LegacySam to SamProductType--><g id="link_LegacySam_SamProductType"><path codeLine="250" d="M466.308,922.9435 C464.4408,938.3107 462.5988,953.4763 460.9536,967.0177 " fill="none" id="LegacySam-to-SamProductType" style="stroke:#3498DB;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="460.584,970.0615,463.6175,964.9902,460.9457,967.0834,458.8525,964.4115,460.584,970.0615" style="stroke:#3498DB;stroke-width:1.2;"/><polygon fill="#000000" points="466.4382,949.6369,468.8432,944.4621,465.3422,944.0368,466.4382,949.6369" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="24" x="472.2" y="949.8885">provide</text></g><!--MD5=[2ac2a433017a09e5ede72d451eb2a6a0]
@startuml
title
    Calypsonet - calypsonet-terminal-calypso-crypto-legacysam-java-api - 0.1.+ (2022-12-05)
end title

' == THEME ==

'Couleurs issues de : https://htmlcolorcodes.com/fr/tableau-de-couleur/tableau-de-couleur-design-plat/
!define C_GREY1 F8F9F9
!define C_GREY2 F2F3F4
!define C_GREY3 E5E7E9
!define C_GREY4 D7DBDD
!define C_GREY5 CACFD2
!define C_GREY6 BDC3C7
!define C_LINK 3498DB
!define C_USE 27AE60

' - - Styles that don't work with new version of plantuml - -
skinparam stereotypeABorderColor #A9DCDF
skinparam stereotypeIBorderColor #B4A7E5
skinparam stereotypeCBorderColor #ADD1B2
skinparam stereotypeEBorderColor #EB93DF
' - - END - -

skinparam ClassBorderThickness 2
skinparam ArrowThickness 2

' Yellow
skinparam ClassBackgroundColor #FEFECE
skinparam ClassBorderColor #D4AC0D
' Red
skinparam ClassBackgroundColor<<red>> #FDEDEC
skinparam ClassBorderColor<<red>> #E74C3C
hide <<red>> stereotype
' Purple
skinparam ClassBackgroundColor<<purple>> #F4ECF7
skinparam ClassBorderColor<<purple>> #8E44AD
hide <<purple>> stereotype
' blue
skinparam ClassBackgroundColor<<blue>> #EBF5FB
skinparam ClassBorderColor<<blue>> #3498DB
hide <<blue>> stereotype
' Green
skinparam ClassBackgroundColor<<green>> #E9F7EF
skinparam ClassBorderColor<<green>> #27AE60
hide <<green>> stereotype
' Grey
skinparam ClassBackgroundColor<<grey>> #EAECEE
skinparam ClassBorderColor<<grey>> #2C3E50
hide <<grey>> stereotype

' == CONTENT ==

legend top
    __Colors legend__ :
    * __External public API references__ :
    ** <back:yellow>**calypsonet-terminal-reader-java-api**</back>
    ** <back:pink>**calypsonet-terminal-calypso-java-api**</back>
end legend

package "org.calypsonet.terminal.calypso.crypto.legacysam" as api {
    +class "**final** LegacySamApiProperties" as ApiProperties {
        +{static} **final** String VERSION
    }
    package transaction {
        +interface LegacySamTransactionManagerFactory {
            +LegacySamFreeTransactionManager createFreeTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
            +<color:grey>LegacySamSecureReadTransactionManager createSecureReadTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam, LegacySamSecuritySetting securitySetting)
            +<color:grey>LegacySamSecureWriteTransactionManager createSecureWriteTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam, LegacySamSecuritySetting securitySetting)
            +<color:grey>LegacyControlSamAsyncTransactionManager createControlSamAsyncTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
            +<color:grey>LegacyTargetSamAsyncTransactionManager createTargetSamAsyncTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
        }
        +interface LegacySamTransactionManager<T extends LegacySamTransactionManager<T>> {
            +List<byte[]> getTransactionAuditData ()
            +T processCommands ()
        }
        +interface LegacySamReadTransactionManager<T extends LegacySamReadTransactionManager<T>> extends LegacySamTransactionManager {
            +<color:grey>T prepareReadSamParameters ()

            +<color:grey>T prepareReadCaadRecord (int caadRecordNumber)
            +<color:grey>T prepareReadCaadRecords (int fromCaadRecordNumber, int toCaadRecordNumber)

            +<color:grey>T prepareReadSystemKeyParameters (LegacySystemKey systemKey)

            +<color:grey>T prepareReadWorkKeyParameter (int workKeyRecordNumber)
            +<color:grey>T prepareReadWorkKeyParameters (int fromWorkKeyRecordNumber, int toWorkKeyRecordNumber)

            +<color:grey>T prepareReadWorkKeyParameter (byte workKeyKif, byte workKeyKvc)

            +T prepareReadEventCounter (int eventCounterNumber)
            +T prepareReadEventCounters (int fromEventCounterNumber, int toEventCounterNumber)

            +T prepareReadEventCeiling (int eventCeilingNumber)
            +T prepareReadEventCeilings (int fromEventCeilingNumber, int toEventCeilingNumber)
        }
        +interface LegacySamFreeWriteTransactionManager<T extends LegacySamFreeWriteTransactionManager<T>> extends LegacySamTransactionManager {
            +<color:grey>T prepareWriteExternalPlainWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters, byte[] workKeyValue)
            +<color:grey>T prepareWriteRandomlyGeneratedWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters)
        }
        +interface LegacySamWriteTransactionManager<T extends LegacySamWriteTransactionManager<T>> extends LegacySamFreeWriteTransactionManager {
            +<color:grey>T prepareWriteSamParameters (byte[] parameters)
            +<color:grey>T prepareWriteCaadRecord (int caadRecordNumber, byte[] caad)

            +<color:grey>T prepareWriteTransferredCipheredSystemKey (LegacySystemKey sourceSystemKey, byte sourceSystemKeyKif, byte sourceSystemKeyKvc)
            +<color:grey>T prepareWriteTransferredPlainWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters)
            +<color:grey>T prepareWriteTransferredCipheredWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters, byte cipheringSystemKeyKvc)

            +<color:grey>T prepareWriteEventCeiling (int eventCeilingNumber, int newValue)
            +<color:grey>T prepareWriteEventCeilings (int fromEventCeilingNumber, List<Integer> newValues)
        }
        together {
            +interface LegacySamSecureReadTransactionManager extends LegacySamReadTransactionManager {
            }
            +interface LegacySamFreeTransactionManager extends LegacySamReadTransactionManager, LegacySamFreeWriteTransactionManager {
                +LegacySamFreeTransactionManager prepareComputeSignature (CommonSignatureComputationData<?> data)
                +LegacySamFreeTransactionManager prepareVerifySignature (CommonSignatureVerificationData<?> data)
            }
            +interface LegacySamSecureWriteTransactionManager extends LegacySamWriteTransactionManager {
            }
            +interface LegacyTargetSamAsyncTransactionManager extends LegacySamTransactionManager {
                +<color:grey>LegacyTargetSamAsyncTransactionManager importCommands (String cipheredSamCommands)
            }
            +interface LegacyControlSamAsyncTransactionManager extends LegacySamWriteTransactionManager {
                +<color:grey>LegacyControlSamAsyncTransactionManager prepareGiveTargetSamPseudoRandom (? asyncRandom)
                +<color:grey>String exportCommands ()
            }
        }
        +interface LegacySamSecuritySettingFactory {
            +LegacySamSecuritySetting createSecuritySetting ()
        }
        +interface LegacySamSecuritySetting {
            +LegacySamSecuritySetting setControlSamResource (<back:yellow>CardReader</back> samReader, LegacySam sam)
        }
        together {
            +interface CardTransactionCryptoExtensionFactory {
                +<color:grey>LegacySamCardTransactionCryptoExtension createCardTransactionCryptoExtension ()
            }
            +interface "<<<back:pink>CardTransactionCryptoExtension</back>>>\nLegacySamCardTransactionCryptoExtension" as LegacySamCardTransactionCryptoExtension {
                +<color:grey>LegacySamCardTransactionCryptoExtension prepareComputeSignature (CommonSignatureComputationData<?> data)
                +<color:grey>LegacySamCardTransactionCryptoExtension prepareVerifySignature (CommonSignatureVerificationData<?> data)
            }
        }
        together {
            +interface CommonSignatureComputationData<T extends CommonSignatureComputationData<T>> {
                +T setData (byte[] data, byte kif, byte kvc)
                +T setSignatureSize (int size)
                +T setKeyDiversifier (byte[] diversifier)

                +byte[] getSignature ()
            }
            +interface BasicSignatureComputationData extends CommonSignatureComputationData {
            }
            +interface TraceableSignatureComputationData extends CommonSignatureComputationData {
                +TraceableSignatureComputationData withSamTraceabilityMode (int offset, boolean usePartialSamSerialNumber)
                +TraceableSignatureComputationData withoutBusyMode ()

                +byte[] getSignedData ()
            }
            +interface CommonSignatureVerificationData<T extends CommonSignatureVerificationData<T>> {
                +T setData (byte[] data, byte[] signature, byte kif, byte kvc)
                +T setKeyDiversifier (byte[] diversifier)

                +boolean isSignatureValid ()
            }
            +interface BasicSignatureVerificationData extends CommonSignatureVerificationData {
            }
            +interface TraceableSignatureVerificationData extends CommonSignatureVerificationData {
                +TraceableSignatureVerificationData withSamTraceabilityMode (int offset, boolean isPartialSamSerialNumber, LegacySamRevocationServiceSpi samRevocationService)
                +TraceableSignatureVerificationData withoutBusyMode ()
            }
            +interface SignatureDataFactory {
                +BasicSignatureComputationData createBasicSignatureComputationData ()
                +TraceableSignatureComputationData createTraceableSignatureComputationData ()
                +BasicSignatureVerificationData createBasicSignatureVerificationData ()
                +TraceableSignatureVerificationData createTraceableSignatureVerificationData ()
            }
        }
    }
    package sam {
        +interface "<<<back:yellow>CardSelection</back>>>\nLegacySamSelection" as LegacySamSelection {
            +LegacySamSelection filterByProductType (LegacySam.ProductType productType)
            +LegacySamSelection filterBySerialNumber (String serialNumberRegex)

            +LegacySamSelection setUnlockData (String unlockData)
        }
        +interface "<<<back:yellow>SmartCard</back>>>\nLegacySam" as LegacySam {
            +ProductType getProductType ()
            +String getProductInfo ()

            +byte[] getSerialNumber ()
            +byte getPlatform ()
            +byte getApplicationType ()
            +byte getApplicationSubType ()
            +byte getSoftwareIssuer ()
            +byte getSoftwareVersion ()
            +byte getSoftwareRevision ()

            +Integer getEventCounter (int eventCounterNumber)
            +SortedMap<Integer, Integer> getEventCounters ()

            +Integer getEventCeiling (int eventCeilingNumber)
            +SortedMap<Integer, Integer> getEventCeilings ()
        }
        +enum "ProductType" as SamProductType {
            SAM_C1
            HSM_C1
            SAM_S1E1
            SAM_S1Dx
            CSAM_F
            UNKNOWN
        }
    }
    package spi {
        +interface LegacySamRevocationServiceSpi {
            +boolean isSamRevoked (byte[] serialNumber)
            +boolean isSamRevoked (byte[] serialNumber, int counterValue)
        }
    }
}

' Associations

LegacySamTransactionManagerFactory .up.> LegacySamSecureReadTransactionManager #C_LINK : provide >
LegacySamTransactionManagerFactory .up.> LegacySamFreeTransactionManager #C_LINK : provide >
LegacySamTransactionManagerFactory .up.> LegacySamSecureWriteTransactionManager #C_LINK : provide >
LegacySamTransactionManagerFactory .up.> LegacyControlSamAsyncTransactionManager #C_LINK : provide >
LegacySamTransactionManagerFactory .up.> LegacyTargetSamAsyncTransactionManager #C_LINK : provide >
LegacySamTransactionManagerFactory .left.> LegacySam #C_USE : use >
LegacySamTransactionManagerFactory ..> LegacySamSecuritySetting #C_USE : use >

SignatureDataFactory .up.> BasicSignatureComputationData #C_LINK : provide >
SignatureDataFactory .up.> TraceableSignatureComputationData #C_LINK : provide >
SignatureDataFactory .up.> BasicSignatureVerificationData #C_LINK : provide >
SignatureDataFactory .up.> TraceableSignatureVerificationData #C_LINK : provide >

TraceableSignatureVerificationData ..> LegacySamRevocationServiceSpi #C_USE : use >

LegacySamSecuritySettingFactory .up.> LegacySamSecuritySetting #C_LINK : provide >

LegacySamFreeTransactionManager ..> CommonSignatureComputationData #C_USE : use >
LegacySamFreeTransactionManager ..> CommonSignatureVerificationData #C_USE : use >

CardTransactionCryptoExtensionFactory ..> LegacySamCardTransactionCryptoExtension #C_LINK : provide >

LegacySamCardTransactionCryptoExtension ..> CommonSignatureComputationData #C_USE : use >
LegacySamCardTransactionCryptoExtension ..> CommonSignatureVerificationData #C_USE : use >

LegacySamSelection ..> SamProductType #C_USE : use >

LegacySam +- - SamProductType
LegacySam ..> SamProductType #C_LINK : provide >

' == LAYOUT ==

'SamProductType .[hidden]. LegacySamRevocationServiceSpi

' == STYLE ==

package api #C_GREY1 {}
package spi #C_GREY2 {}
package sam #C_GREY2 {}
package transaction #C_GREY2 {}

interface LegacySamTransactionManager <<blue>>
interface LegacySamFreeTransactionManager <<blue>>
interface LegacySamFreeWriteTransactionManager <<blue>>
interface LegacySamReadTransactionManager <<blue>>
interface LegacySamWriteTransactionManager <<blue>>
interface LegacySamSecureReadTransactionManager <<blue>>
interface LegacySamSecureWriteTransactionManager <<blue>>
interface LegacyControlSamAsyncTransactionManager <<blue>>
interface LegacyTargetSamAsyncTransactionManager <<blue>>

interface LegacySamTransactionManagerFactory <<red>>
interface CardTransactionCryptoExtensionFactory <<red>>
interface SignatureDataFactory <<red>>
interface LegacySamSecuritySettingFactory <<red>>

interface LegacySamCardTransactionCryptoExtension <<green>>

interface LegacySamSelection <<green>>

@enduml

@startuml
title
    Calypsonet - calypsonet-terminal-calypso-crypto-legacysam-java-api - 0.1.+ (2022-12-05)
end title



skinparam stereotypeABorderColor #A9DCDF
skinparam stereotypeIBorderColor #B4A7E5
skinparam stereotypeCBorderColor #ADD1B2
skinparam stereotypeEBorderColor #EB93DF

skinparam ClassBorderThickness 2
skinparam ArrowThickness 2

skinparam ClassBackgroundColor #FEFECE
skinparam ClassBorderColor #D4AC0D
skinparam ClassBackgroundColor<<red>> #FDEDEC
skinparam ClassBorderColor<<red>> #E74C3C
hide <<red>> stereotype
skinparam ClassBackgroundColor<<purple>> #F4ECF7
skinparam ClassBorderColor<<purple>> #8E44AD
hide <<purple>> stereotype
skinparam ClassBackgroundColor<<blue>> #EBF5FB
skinparam ClassBorderColor<<blue>> #3498DB
hide <<blue>> stereotype
skinparam ClassBackgroundColor<<green>> #E9F7EF
skinparam ClassBorderColor<<green>> #27AE60
hide <<green>> stereotype
skinparam ClassBackgroundColor<<grey>> #EAECEE
skinparam ClassBorderColor<<grey>> #2C3E50
hide <<grey>> stereotype


legend top
    __Colors legend__ :
    * __External public API references__ :
    ** <back:yellow>**calypsonet-terminal-reader-java-api**</back>
    ** <back:pink>**calypsonet-terminal-calypso-java-api**</back>
end legend

package "org.calypsonet.terminal.calypso.crypto.legacysam" as api {
    +class "**final** LegacySamApiProperties" as ApiProperties {
        +{static} **final** String VERSION
    }
    package transaction {
        +interface LegacySamTransactionManagerFactory {
            +LegacySamFreeTransactionManager createFreeTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
            +<color:grey>LegacySamSecureReadTransactionManager createSecureReadTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam, LegacySamSecuritySetting securitySetting)
            +<color:grey>LegacySamSecureWriteTransactionManager createSecureWriteTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam, LegacySamSecuritySetting securitySetting)
            +<color:grey>LegacyControlSamAsyncTransactionManager createControlSamAsyncTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
            +<color:grey>LegacyTargetSamAsyncTransactionManager createTargetSamAsyncTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
        }
        +interface LegacySamTransactionManager<T extends LegacySamTransactionManager<T>> {
            +List<byte[]> getTransactionAuditData ()
            +T processCommands ()
        }
        +interface LegacySamReadTransactionManager<T extends LegacySamReadTransactionManager<T>> extends LegacySamTransactionManager {
            +<color:grey>T prepareReadSamParameters ()

            +<color:grey>T prepareReadCaadRecord (int caadRecordNumber)
            +<color:grey>T prepareReadCaadRecords (int fromCaadRecordNumber, int toCaadRecordNumber)

            +<color:grey>T prepareReadSystemKeyParameters (LegacySystemKey systemKey)

            +<color:grey>T prepareReadWorkKeyParameter (int workKeyRecordNumber)
            +<color:grey>T prepareReadWorkKeyParameters (int fromWorkKeyRecordNumber, int toWorkKeyRecordNumber)

            +<color:grey>T prepareReadWorkKeyParameter (byte workKeyKif, byte workKeyKvc)

            +T prepareReadEventCounter (int eventCounterNumber)
            +T prepareReadEventCounters (int fromEventCounterNumber, int toEventCounterNumber)

            +T prepareReadEventCeiling (int eventCeilingNumber)
            +T prepareReadEventCeilings (int fromEventCeilingNumber, int toEventCeilingNumber)
        }
        +interface LegacySamFreeWriteTransactionManager<T extends LegacySamFreeWriteTransactionManager<T>> extends LegacySamTransactionManager {
            +<color:grey>T prepareWriteExternalPlainWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters, byte[] workKeyValue)
            +<color:grey>T prepareWriteRandomlyGeneratedWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters)
        }
        +interface LegacySamWriteTransactionManager<T extends LegacySamWriteTransactionManager<T>> extends LegacySamFreeWriteTransactionManager {
            +<color:grey>T prepareWriteSamParameters (byte[] parameters)
            +<color:grey>T prepareWriteCaadRecord (int caadRecordNumber, byte[] caad)

            +<color:grey>T prepareWriteTransferredCipheredSystemKey (LegacySystemKey sourceSystemKey, byte sourceSystemKeyKif, byte sourceSystemKeyKvc)
            +<color:grey>T prepareWriteTransferredPlainWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters)
            +<color:grey>T prepareWriteTransferredCipheredWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters, byte cipheringSystemKeyKvc)

            +<color:grey>T prepareWriteEventCeiling (int eventCeilingNumber, int newValue)
            +<color:grey>T prepareWriteEventCeilings (int fromEventCeilingNumber, List<Integer> newValues)
        }
        together {
            +interface LegacySamSecureReadTransactionManager extends LegacySamReadTransactionManager {
            }
            +interface LegacySamFreeTransactionManager extends LegacySamReadTransactionManager, LegacySamFreeWriteTransactionManager {
                +LegacySamFreeTransactionManager prepareComputeSignature (CommonSignatureComputationData<?> data)
                +LegacySamFreeTransactionManager prepareVerifySignature (CommonSignatureVerificationData<?> data)
            }
            +interface LegacySamSecureWriteTransactionManager extends LegacySamWriteTransactionManager {
            }
            +interface LegacyTargetSamAsyncTransactionManager extends LegacySamTransactionManager {
                +<color:grey>LegacyTargetSamAsyncTransactionManager importCommands (String cipheredSamCommands)
            }
            +interface LegacyControlSamAsyncTransactionManager extends LegacySamWriteTransactionManager {
                +<color:grey>LegacyControlSamAsyncTransactionManager prepareGiveTargetSamPseudoRandom (? asyncRandom)
                +<color:grey>String exportCommands ()
            }
        }
        +interface LegacySamSecuritySettingFactory {
            +LegacySamSecuritySetting createSecuritySetting ()
        }
        +interface LegacySamSecuritySetting {
            +LegacySamSecuritySetting setControlSamResource (<back:yellow>CardReader</back> samReader, LegacySam sam)
        }
        together {
            +interface CardTransactionCryptoExtensionFactory {
                +<color:grey>LegacySamCardTransactionCryptoExtension createCardTransactionCryptoExtension ()
            }
            +interface "<<<back:pink>CardTransactionCryptoExtension</back>>>\nLegacySamCardTransactionCryptoExtension" as LegacySamCardTransactionCryptoExtension {
                +<color:grey>LegacySamCardTransactionCryptoExtension prepareComputeSignature (CommonSignatureComputationData<?> data)
                +<color:grey>LegacySamCardTransactionCryptoExtension prepareVerifySignature (CommonSignatureVerificationData<?> data)
            }
        }
        together {
            +interface CommonSignatureComputationData<T extends CommonSignatureComputationData<T>> {
                +T setData (byte[] data, byte kif, byte kvc)
                +T setSignatureSize (int size)
                +T setKeyDiversifier (byte[] diversifier)

                +byte[] getSignature ()
            }
            +interface BasicSignatureComputationData extends CommonSignatureComputationData {
            }
            +interface TraceableSignatureComputationData extends CommonSignatureComputationData {
                +TraceableSignatureComputationData withSamTraceabilityMode (int offset, boolean usePartialSamSerialNumber)
                +TraceableSignatureComputationData withoutBusyMode ()

                +byte[] getSignedData ()
            }
            +interface CommonSignatureVerificationData<T extends CommonSignatureVerificationData<T>> {
                +T setData (byte[] data, byte[] signature, byte kif, byte kvc)
                +T setKeyDiversifier (byte[] diversifier)

                +boolean isSignatureValid ()
            }
            +interface BasicSignatureVerificationData extends CommonSignatureVerificationData {
            }
            +interface TraceableSignatureVerificationData extends CommonSignatureVerificationData {
                +TraceableSignatureVerificationData withSamTraceabilityMode (int offset, boolean isPartialSamSerialNumber, LegacySamRevocationServiceSpi samRevocationService)
                +TraceableSignatureVerificationData withoutBusyMode ()
            }
            +interface SignatureDataFactory {
                +BasicSignatureComputationData createBasicSignatureComputationData ()
                +TraceableSignatureComputationData createTraceableSignatureComputationData ()
                +BasicSignatureVerificationData createBasicSignatureVerificationData ()
                +TraceableSignatureVerificationData createTraceableSignatureVerificationData ()
            }
        }
    }
    package sam {
        +interface "<<<back:yellow>CardSelection</back>>>\nLegacySamSelection" as LegacySamSelection {
            +LegacySamSelection filterByProductType (LegacySam.ProductType productType)
            +LegacySamSelection filterBySerialNumber (String serialNumberRegex)

            +LegacySamSelection setUnlockData (String unlockData)
        }
        +interface "<<<back:yellow>SmartCard</back>>>\nLegacySam" as LegacySam {
            +ProductType getProductType ()
            +String getProductInfo ()

            +byte[] getSerialNumber ()
            +byte getPlatform ()
            +byte getApplicationType ()
            +byte getApplicationSubType ()
            +byte getSoftwareIssuer ()
            +byte getSoftwareVersion ()
            +byte getSoftwareRevision ()

            +Integer getEventCounter (int eventCounterNumber)
            +SortedMap<Integer, Integer> getEventCounters ()

            +Integer getEventCeiling (int eventCeilingNumber)
            +SortedMap<Integer, Integer> getEventCeilings ()
        }
        +enum "ProductType" as SamProductType {
            SAM_C1
            HSM_C1
            SAM_S1E1
            SAM_S1Dx
            CSAM_F
            UNKNOWN
        }
    }
    package spi {
        +interface LegacySamRevocationServiceSpi {
            +boolean isSamRevoked (byte[] serialNumber)
            +boolean isSamRevoked (byte[] serialNumber, int counterValue)
        }
    }
}


LegacySamTransactionManagerFactory .up.> LegacySamSecureReadTransactionManager #3498DB : provide >
LegacySamTransactionManagerFactory .up.> LegacySamFreeTransactionManager #3498DB : provide >
LegacySamTransactionManagerFactory .up.> LegacySamSecureWriteTransactionManager #3498DB : provide >
LegacySamTransactionManagerFactory .up.> LegacyControlSamAsyncTransactionManager #3498DB : provide >
LegacySamTransactionManagerFactory .up.> LegacyTargetSamAsyncTransactionManager #3498DB : provide >
LegacySamTransactionManagerFactory .left.> LegacySam #27AE60 : use >
LegacySamTransactionManagerFactory ..> LegacySamSecuritySetting #27AE60 : use >

SignatureDataFactory .up.> BasicSignatureComputationData #3498DB : provide >
SignatureDataFactory .up.> TraceableSignatureComputationData #3498DB : provide >
SignatureDataFactory .up.> BasicSignatureVerificationData #3498DB : provide >
SignatureDataFactory .up.> TraceableSignatureVerificationData #3498DB : provide >

TraceableSignatureVerificationData ..> LegacySamRevocationServiceSpi #27AE60 : use >

LegacySamSecuritySettingFactory .up.> LegacySamSecuritySetting #3498DB : provide >

LegacySamFreeTransactionManager ..> CommonSignatureComputationData #27AE60 : use >
LegacySamFreeTransactionManager ..> CommonSignatureVerificationData #27AE60 : use >

CardTransactionCryptoExtensionFactory ..> LegacySamCardTransactionCryptoExtension #3498DB : provide >

LegacySamCardTransactionCryptoExtension ..> CommonSignatureComputationData #27AE60 : use >
LegacySamCardTransactionCryptoExtension ..> CommonSignatureVerificationData #27AE60 : use >

LegacySamSelection ..> SamProductType #27AE60 : use >

LegacySam +- - SamProductType
LegacySam ..> SamProductType #3498DB : provide >




package api #F8F9F9 {}
package spi #F2F3F4 {}
package sam #F2F3F4 {}
package transaction #F2F3F4 {}

interface LegacySamTransactionManager <<blue>>
interface LegacySamFreeTransactionManager <<blue>>
interface LegacySamFreeWriteTransactionManager <<blue>>
interface LegacySamReadTransactionManager <<blue>>
interface LegacySamWriteTransactionManager <<blue>>
interface LegacySamSecureReadTransactionManager <<blue>>
interface LegacySamSecureWriteTransactionManager <<blue>>
interface LegacyControlSamAsyncTransactionManager <<blue>>
interface LegacyTargetSamAsyncTransactionManager <<blue>>

interface LegacySamTransactionManagerFactory <<red>>
interface CardTransactionCryptoExtensionFactory <<red>>
interface SignatureDataFactory <<red>>
interface LegacySamSecuritySettingFactory <<red>>

interface LegacySamCardTransactionCryptoExtension <<green>>

interface LegacySamSelection <<green>>

@enduml

PlantUML version 1.2022.13(Sat Nov 19 14:22:17 CET 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: fr
Country: FR
--></g></svg>