<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2129px" preserveAspectRatio="none" style="width:4999px;height:2129px;background:#FFFFFF;" version="1.1" viewBox="0 0 4999 2129" width="4999px" zoomAndPan="magnify"><defs><filter height="1" id="bg4rrzasnqk6a0" width="1" x="0" y="0"><feFlood flood-color="#FFFF00" result="flood"/><feComposite in="SourceGraphic" in2="flood" operator="over"/></filter><filter height="1" id="bg4rrzasnqk6a1" width="1" x="0" y="0"><feFlood flood-color="#FFC0CB" result="flood"/><feComposite in="SourceGraphic" in2="flood" operator="over"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="607" x="2189" y="25.1074">Calypsonet - calypsonet-terminal-calypso-crypto-legacysam-java-api - 0.1.+ (2022-12-12)</text><rect fill="#DDDDDD" height="103.1055" id="_legend" rx="7.5" ry="7.5" style="stroke:#000000;stroke-width:1.0;" width="282" x="2351.5" y="51.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="88" x="2356.5" y="71.7285">Colors legend</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2448.5" y="71.7285">:</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="2365.5" y="83.8633"/><text fill="#808080" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="133" x="2372.5" y="90.3496">Work in progress...</text><ellipse cx="2362" cy="104.9844" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="189" x="2368.5" y="108.9707">External public API references</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2561.5" y="108.9707">:</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="2365.5" y="121.1055"/><text fill="#000000" filter="url(#bg4rrzasnqk6a0)" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="250" x="2372.5" y="127.5918">calypsonet-terminal-reader-java-api</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="2365.5" y="139.7266"/><text fill="#000000" filter="url(#bg4rrzasnqk6a1)" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="256" x="2372.5" y="146.2129">calypsonet-terminal-calypso-java-api</text><!--MD5=[7442f3b126ee602ae02566c1a49e158a]
cluster api--><g id="cluster_api"><path d="M8.5,173.7402 L356.5,173.7402 A3.75,3.75 0 0 1 359,176.2402 L366,198.3613 L4989.5,198.3613 A2.5,2.5 0 0 1 4992,200.8613 L4992,2119.7402 A2.5,2.5 0 0 1 4989.5,2122.2402 L8.5,2122.2402 A2.5,2.5 0 0 1 6,2119.7402 L6,176.2402 A2.5,2.5 0 0 1 8.5,173.7402 " fill="#F8F9F9" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="6" x2="366" y1="198.3613" y2="198.3613"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="347" x="10" y="190.8477">org.calypsonet.terminal.calypso.crypto.legacysam</text></g><!--MD5=[f9c58d90839a0c7c212d8c6553ac9eb7]
cluster transaction--><g id="cluster_transaction"><path d="M1016.5,218.7402 L1096.5,218.7402 A3.75,3.75 0 0 1 1099,221.2402 L1106,243.3613 L4487.5,243.3613 A2.5,2.5 0 0 1 4490,245.8613 L4490,2095.7402 A2.5,2.5 0 0 1 4487.5,2098.2402 L1016.5,2098.2402 A2.5,2.5 0 0 1 1014,2095.7402 L1014,221.2402 A2.5,2.5 0 0 1 1016.5,218.7402 " fill="#F2F3F4" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="1014" x2="1106" y1="243.3613" y2="243.3613"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="79" x="1018" y="235.8477">transaction</text></g><!--MD5=[98d4fa74a8fc0b7c744d347d810a7562]
cluster sam--><g id="cluster_sam"><path d="M32.5,734.7402 L61.5,734.7402 A3.75,3.75 0 0 1 64,737.2402 L71,759.3613 L987.5,759.3613 A2.5,2.5 0 0 1 990,761.8613 L990,1663.2402 A2.5,2.5 0 0 1 987.5,1665.7402 L32.5,1665.7402 A2.5,2.5 0 0 1 30,1663.2402 L30,737.2402 A2.5,2.5 0 0 1 32.5,734.7402 " fill="#F2F3F4" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="30" x2="71" y1="759.3613" y2="759.3613"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="28" x="34" y="751.8477">sam</text></g><!--MD5=[f7e0e2453c87923036c1ac2adfb9cbf0]
cluster spi--><g id="cluster_spi"><path d="M4516.5,1917.7402 L4538.5,1917.7402 A3.75,3.75 0 0 1 4541,1920.2402 L4548,1942.3613 L4965.5,1942.3613 A2.5,2.5 0 0 1 4968,1944.8613 L4968,2053.2402 A2.5,2.5 0 0 1 4965.5,2055.7402 L4516.5,2055.7402 A2.5,2.5 0 0 1 4514,2053.2402 L4514,1920.2402 A2.5,2.5 0 0 1 4516.5,1917.7402 " fill="#F2F3F4" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="4514" x2="4548" y1="1942.3613" y2="1942.3613"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="21" x="4518" y="1934.8477">spi</text></g><!--MD5=[120218adfd8782b0057db0a1b8294250]
class ApiProperties--><g id="elem_ApiProperties"><rect codeLine="62" fill="#FEFECE" height="66.6211" id="ApiProperties" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="236" x="392" y="302.2402"/><ellipse cx="407" cy="318.2402" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M409.7656,314.1152 Q409.9219,313.8965 410.1094,313.7871 Q410.2969,313.6777 410.5156,313.6777 Q410.8906,313.6777 411.125,313.9434 Q411.3594,314.1934 411.3594,314.8027 L411.3594,316.2559 Q411.3594,316.8652 411.125,317.1309 Q410.8906,317.3965 410.5156,317.3965 Q410.1719,317.3965 409.9688,317.1934 Q409.7656,317.0059 409.6563,316.4902 Q409.6094,316.1309 409.4219,315.9434 Q409.0938,315.5684 408.4844,315.3496 Q407.875,315.1309 407.25,315.1309 Q406.4844,315.1309 405.8438,315.459 Q405.2188,315.7871 404.7188,316.5371 Q404.2344,317.2871 404.2344,318.3184 L404.2344,319.4121 Q404.2344,320.6465 405.125,321.4746 Q406.0156,322.2871 407.6094,322.2871 Q408.5469,322.2871 409.2031,322.0371 Q409.5938,321.8809 410.0156,321.4434 Q410.2813,321.1777 410.4219,321.0996 Q410.5781,321.0215 410.7813,321.0215 Q411.1094,321.0215 411.3594,321.2871 Q411.625,321.5371 411.625,321.8809 Q411.625,322.2246 411.2813,322.6309 Q410.7813,323.209 409.9844,323.5371 Q408.9063,323.9902 407.6094,323.9902 Q406.0938,323.9902 404.8906,323.3652 Q403.9063,322.8652 403.2188,321.8027 Q402.5313,320.7246 402.5313,319.4434 L402.5313,318.2871 Q402.5313,316.959 403.1406,315.8184 Q403.7656,314.6621 404.8594,314.0527 Q405.9531,313.4277 407.1875,313.4277 Q407.9219,313.4277 408.5625,313.5996 Q409.2188,313.7559 409.7656,314.1152 Z " fill="#000000"/><ellipse cx="426" cy="317.7402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="30" x="432" y="324.0371">final</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="159" x="466" y="324.0371">LegacySamApiProperties</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="393" x2="627" y1="334.2402" y2="334.2402"/><ellipse cx="403" cy="349.0508" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" text-decoration="underline" textLength="30" x="412" y="353.3477">final</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="101" x="446" y="353.3477">String VERSION</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="393" x2="627" y1="360.8613" y2="360.8613"/></g><!--MD5=[f04eed83d4327e21d30126b65a85dc6e]
class LSTransactionManagerFactory--><g id="elem_LSTransactionManagerFactory"><rect codeLine="287" fill="#FDEDEC" height="141.1055" id="LSTransactionManagerFactory" rx="2.5" ry="2.5" style="stroke:#E74C3C;stroke-width:2.0;" width="1005" x="1069.5" y="1508.7402"/><ellipse cx="1463.75" cy="1524.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1464.7031,1521.3809 L1464.7031,1528.0371 L1466.4219,1528.0371 Q1467.0313,1528.0371 1467.2969,1528.2715 Q1467.5625,1528.5059 1467.5625,1528.8965 Q1467.5625,1529.2715 1467.2969,1529.5059 Q1467.0313,1529.7402 1466.4219,1529.7402 L1461.2813,1529.7402 Q1460.6719,1529.7402 1460.4063,1529.5059 Q1460.1406,1529.2715 1460.1406,1528.8809 Q1460.1406,1528.5059 1460.4063,1528.2715 Q1460.6719,1528.0371 1461.2813,1528.0371 L1463,1528.0371 L1463,1521.3809 L1461.2813,1521.3809 Q1460.6719,1521.3809 1460.4063,1521.1465 Q1460.1406,1520.9121 1460.1406,1520.5215 Q1460.1406,1520.1465 1460.4063,1519.9121 Q1460.6719,1519.6777 1461.2813,1519.6777 L1466.4219,1519.6777 Q1467.0313,1519.6777 1467.2969,1519.9121 Q1467.5625,1520.1465 1467.5625,1520.5215 Q1467.5625,1520.9121 1467.2969,1521.1465 Q1467.0313,1521.3809 1466.4219,1521.3809 L1464.7031,1521.3809 Z " fill="#000000"/><ellipse cx="1489.25" cy="1524.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="197" x="1495.25" y="1530.5371">LSTransactionManagerFactory</text><line style="stroke:#E74C3C;stroke-width:2.0;" x1="1070.5" x2="2073.5" y1="1540.7402" y2="1540.7402"/><line style="stroke:#E74C3C;stroke-width:2.0;" x1="1070.5" x2="2073.5" y1="1548.7402" y2="1548.7402"/><ellipse cx="1080.5" cy="1563.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="392" x="1089.5" y="1567.8477">LSFreeTransactionManager createFreeTransactionManager (</text><text fill="#000000" filter="url(#bg4rrzasnqk6a0)" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="1481.5" y="1567.8477">CardReader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="190" x="1563.5" y="1567.8477">samReader, LegacySam sam)</text><ellipse cx="1080.5" cy="1582.1719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="490" x="1089.5" y="1586.4688">LSSecureReadTransactionManager createSecureReadTransactionManager (</text><text fill="#808080" filter="url(#bg4rrzasnqk6a0)" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="1579.5" y="1586.4688">CardReader</text><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="407" x="1661.5" y="1586.4688">samReader, LegacySam sam, LSSecuritySetting securitySetting)</text><ellipse cx="1080.5" cy="1600.793" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="488" x="1089.5" y="1605.0898">LSSecureWriteTransactionManager createSecureWriteTransactionManager (</text><text fill="#808080" filter="url(#bg4rrzasnqk6a0)" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="1577.5" y="1605.0898">CardReader</text><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="407" x="1659.5" y="1605.0898">samReader, LegacySam sam, LSSecuritySetting securitySetting)</text><ellipse cx="1080.5" cy="1619.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="556" x="1089.5" y="1623.7109">LSControlSamAsyncTransactionManager createControlSamAsyncTransactionManager (</text><text fill="#808080" filter="url(#bg4rrzasnqk6a0)" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="1645.5" y="1623.7109">CardReader</text><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="190" x="1727.5" y="1623.7109">samReader, LegacySam sam)</text><ellipse cx="1080.5" cy="1638.0352" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="548" x="1089.5" y="1642.332">LSTargetSamAsyncTransactionManager createTargetSamAsyncTransactionManager (</text><text fill="#808080" filter="url(#bg4rrzasnqk6a0)" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="1637.5" y="1642.332">CardReader</text><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="190" x="1719.5" y="1642.332">samReader, LegacySam sam)</text></g><!--MD5=[07532f1052e97258638ceb40647391f6]
class LSTransactionManager--><g id="elem_LSTransactionManager"><rect codeLine="276" fill="#EBF5FB" height="66.6211" id="LSTransactionManager" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:2.0;" width="400" x="1650" y="302.2402"/><ellipse cx="1665" cy="318.2402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1665.9531,314.8809 L1665.9531,321.5371 L1667.6719,321.5371 Q1668.2813,321.5371 1668.5469,321.7715 Q1668.8125,322.0059 1668.8125,322.3965 Q1668.8125,322.7715 1668.5469,323.0059 Q1668.2813,323.2402 1667.6719,323.2402 L1662.5313,323.2402 Q1661.9219,323.2402 1661.6563,323.0059 Q1661.3906,322.7715 1661.3906,322.3809 Q1661.3906,322.0059 1661.6563,321.7715 Q1661.9219,321.5371 1662.5313,321.5371 L1664.25,321.5371 L1664.25,314.8809 L1662.5313,314.8809 Q1661.9219,314.8809 1661.6563,314.6465 Q1661.3906,314.4121 1661.3906,314.0215 Q1661.3906,313.6465 1661.6563,313.4121 Q1661.9219,313.1777 1662.5313,313.1777 L1667.6719,313.1777 Q1668.2813,313.1777 1668.5469,313.4121 Q1668.8125,313.6465 1668.8125,314.0215 Q1668.8125,314.4121 1668.5469,314.6465 Q1668.2813,314.8809 1667.6719,314.8809 L1665.9531,314.8809 Z " fill="#000000"/><ellipse cx="1684" cy="317.7402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="149" x="1690" y="324.0371">LSTransactionManager</text><rect fill="#FFFFFF" height="17.9609" style="stroke:#3498DB;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="206" x="1847" y="299.2402"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="204" x="1848" y="313.1895">T extends LSTransactionManager&lt;T&gt;</text><line style="stroke:#3498DB;stroke-width:2.0;" x1="1651" x2="2049" y1="334.2402" y2="334.2402"/><line style="stroke:#3498DB;stroke-width:2.0;" x1="1651" x2="2049" y1="342.2402" y2="342.2402"/><ellipse cx="1661" cy="357.0508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="148" x="1670" y="361.3477">T processCommands ()</text></g><!--MD5=[347fc188e8588f456915e4671da10a34]
class LSReadTransactionManager--><g id="elem_LSReadTransactionManager"><rect codeLine="279" fill="#EBF5FB" height="364.5586" id="LSReadTransactionManager" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:2.0;" width="657" x="1521.5" y="622.7402"/><ellipse cx="1629.75" cy="638.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1630.7031,635.3809 L1630.7031,642.0371 L1632.4219,642.0371 Q1633.0313,642.0371 1633.2969,642.2715 Q1633.5625,642.5059 1633.5625,642.8965 Q1633.5625,643.2715 1633.2969,643.5059 Q1633.0313,643.7402 1632.4219,643.7402 L1627.2813,643.7402 Q1626.6719,643.7402 1626.4063,643.5059 Q1626.1406,643.2715 1626.1406,642.8809 Q1626.1406,642.5059 1626.4063,642.2715 Q1626.6719,642.0371 1627.2813,642.0371 L1629,642.0371 L1629,635.3809 L1627.2813,635.3809 Q1626.6719,635.3809 1626.4063,635.1465 Q1626.1406,634.9121 1626.1406,634.5215 Q1626.1406,634.1465 1626.4063,633.9121 Q1626.6719,633.6777 1627.2813,633.6777 L1632.4219,633.6777 Q1633.0313,633.6777 1633.2969,633.9121 Q1633.5625,634.1465 1633.5625,634.5215 Q1633.5625,634.9121 1633.2969,635.1465 Q1633.0313,635.3809 1632.4219,635.3809 L1630.7031,635.3809 Z " fill="#000000"/><ellipse cx="1655.25" cy="638.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="183" x="1661.25" y="644.5371">LSReadTransactionManager</text><rect fill="#FFFFFF" height="17.9609" style="stroke:#3498DB;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="236" x="1945.5" y="619.7402"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="234" x="1946.5" y="633.6895">T extends LSReadTransactionManager&lt;T&gt;</text><line style="stroke:#3498DB;stroke-width:2.0;" x1="1522.5" x2="2177.5" y1="654.7402" y2="654.7402"/><line style="stroke:#3498DB;stroke-width:2.0;" x1="1522.5" x2="2177.5" y1="662.7402" y2="662.7402"/><ellipse cx="1532.5" cy="677.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="212" x="1541.5" y="681.8477">T prepareReadSamParameters ()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1541.5" y="700.4688"> </text><ellipse cx="1532.5" cy="714.793" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="336" x="1541.5" y="719.0898">T prepareReadCaadRecord (int caadRecordNumber)</text><ellipse cx="1532.5" cy="733.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="542" x="1541.5" y="737.7109">T prepareReadCaadRecords (int fromCaadRecordNumber, int toCaadRecordNumber)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1541.5" y="756.332"> </text><ellipse cx="1532.5" cy="770.6563" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="442" x="1541.5" y="774.9531">T prepareReadSystemKeyParameters (LegacySystemKey systemKey)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1541.5" y="793.5742"> </text><ellipse cx="1532.5" cy="807.8984" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="401" x="1541.5" y="812.1953">T prepareReadWorkKeyParameter (int workKeyRecordNumber)</text><ellipse cx="1532.5" cy="826.5195" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="631" x="1541.5" y="830.8164">T prepareReadWorkKeyParameters (int fromWorkKeyRecordNumber, int toWorkKeyRecordNumber)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1541.5" y="849.4375"> </text><ellipse cx="1532.5" cy="863.7617" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="449" x="1541.5" y="868.0586">T prepareReadWorkKeyParameter (byte workKeyKif, byte workKeyKvc)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1541.5" y="886.6797"> </text><ellipse cx="1532.5" cy="901.0039" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="352" x="1541.5" y="905.3008">T prepareReadEventCounter (int eventCounterNumber)</text><ellipse cx="1532.5" cy="919.625" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="563" x="1541.5" y="923.9219">T prepareReadEventCounters (int fromEventCounterNumber, int toEventCounterNumber)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1541.5" y="942.543"> </text><ellipse cx="1532.5" cy="956.8672" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="336" x="1541.5" y="961.1641">T prepareReadEventCeiling (int eventCeilingNumber)</text><ellipse cx="1532.5" cy="975.4883" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="539" x="1541.5" y="979.7852">T prepareReadEventCeilings (int fromEventCeilingNumber, int toEventCeilingNumber)</text></g><!--MD5=[e51059604a057aadbf25364dd3cc8062]
class LSFreeWriteTransactionManager--><g id="elem_LSFreeWriteTransactionManager"><rect codeLine="278" fill="#EBF5FB" height="85.2422" id="LSFreeWriteTransactionManager" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:2.0;" width="799" x="2366.5" y="476.7402"/><ellipse cx="2519.25" cy="492.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2520.2031,489.3809 L2520.2031,496.0371 L2521.9219,496.0371 Q2522.5313,496.0371 2522.7969,496.2715 Q2523.0625,496.5059 2523.0625,496.8965 Q2523.0625,497.2715 2522.7969,497.5059 Q2522.5313,497.7402 2521.9219,497.7402 L2516.7813,497.7402 Q2516.1719,497.7402 2515.9063,497.5059 Q2515.6406,497.2715 2515.6406,496.8809 Q2515.6406,496.5059 2515.9063,496.2715 Q2516.1719,496.0371 2516.7813,496.0371 L2518.5,496.0371 L2518.5,489.3809 L2516.7813,489.3809 Q2516.1719,489.3809 2515.9063,489.1465 Q2515.6406,488.9121 2515.6406,488.5215 Q2515.6406,488.1465 2515.9063,487.9121 Q2516.1719,487.6777 2516.7813,487.6777 L2521.9219,487.6777 Q2522.5313,487.6777 2522.7969,487.9121 Q2523.0625,488.1465 2523.0625,488.5215 Q2523.0625,488.9121 2522.7969,489.1465 Q2522.5313,489.3809 2521.9219,489.3809 L2520.2031,489.3809 Z " fill="#000000"/><ellipse cx="2544.75" cy="492.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="213" x="2550.75" y="498.5371">LSFreeWriteTransactionManager</text><rect fill="#FFFFFF" height="17.9609" style="stroke:#3498DB;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="259" x="2909.5" y="473.7402"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="257" x="2910.5" y="487.6895">T extends LSFreeWriteTransactionManager&lt;T&gt;</text><line style="stroke:#3498DB;stroke-width:2.0;" x1="2367.5" x2="3164.5" y1="508.7402" y2="508.7402"/><line style="stroke:#3498DB;stroke-width:2.0;" x1="2367.5" x2="3164.5" y1="516.7402" y2="516.7402"/><ellipse cx="2377.5" cy="531.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="773" x="2386.5" y="535.8477">T prepareWriteExternalPlainWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters, byte[] workKeyValue)</text><ellipse cx="2377.5" cy="550.1719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="686" x="2386.5" y="554.4688">T prepareWriteRandomlyGeneratedWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters)</text></g><!--MD5=[6e80b32ff826f9401d430e2c02426a9f]
class LSWriteTransactionManager--><g id="elem_LSWriteTransactionManager"><rect codeLine="280" fill="#EBF5FB" height="215.5898" id="LSWriteTransactionManager" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:2.0;" width="998" x="2267" y="697.2402"/><ellipse cx="2546.75" cy="713.2402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2547.7031,709.8809 L2547.7031,716.5371 L2549.4219,716.5371 Q2550.0313,716.5371 2550.2969,716.7715 Q2550.5625,717.0059 2550.5625,717.3965 Q2550.5625,717.7715 2550.2969,718.0059 Q2550.0313,718.2402 2549.4219,718.2402 L2544.2813,718.2402 Q2543.6719,718.2402 2543.4063,718.0059 Q2543.1406,717.7715 2543.1406,717.3809 Q2543.1406,717.0059 2543.4063,716.7715 Q2543.6719,716.5371 2544.2813,716.5371 L2546,716.5371 L2546,709.8809 L2544.2813,709.8809 Q2543.6719,709.8809 2543.4063,709.6465 Q2543.1406,709.4121 2543.1406,709.0215 Q2543.1406,708.6465 2543.4063,708.4121 Q2543.6719,708.1777 2544.2813,708.1777 L2549.4219,708.1777 Q2550.0313,708.1777 2550.2969,708.4121 Q2550.5625,708.6465 2550.5625,709.0215 Q2550.5625,709.4121 2550.2969,709.6465 Q2550.0313,709.8809 2549.4219,709.8809 L2547.7031,709.8809 Z " fill="#000000"/><ellipse cx="2572.25" cy="712.7402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="183" x="2578.25" y="719.0371">LSWriteTransactionManager</text><rect fill="#FFFFFF" height="17.9609" style="stroke:#3498DB;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="234" x="3034" y="694.2402"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="232" x="3035" y="708.1895">T extends LSWriteTransactionManager&lt;T&gt;</text><line style="stroke:#3498DB;stroke-width:2.0;" x1="2268" x2="3264" y1="729.2402" y2="729.2402"/><line style="stroke:#3498DB;stroke-width:2.0;" x1="2268" x2="3264" y1="737.2402" y2="737.2402"/><ellipse cx="2278" cy="752.0508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="322" x="2287" y="756.3477">T prepareWriteSamParameters (byte[] parameters)</text><ellipse cx="2278" cy="770.6719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="413" x="2287" y="774.9688">T prepareWriteCaadRecord (int caadRecordNumber, byte[] caad)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2287" y="793.5898"> </text><ellipse cx="2278" cy="807.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="889" x="2287" y="812.2109">T prepareWriteTransferredCipheredSystemKey (LegacySystemKey sourceSystemKey, byte sourceSystemKeyKif, byte sourceSystemKeyKvc)</text><ellipse cx="2278" cy="826.5352" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="755" x="2287" y="830.832">T prepareWriteTransferredPlainWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters)</text><ellipse cx="2278" cy="845.1563" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="972" x="2287" y="849.4531">T prepareWriteTransferredCipheredWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters, byte cipheringSystemKeyKvc)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2287" y="868.0742"> </text><ellipse cx="2278" cy="882.3984" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="423" x="2287" y="886.6953">T prepareWriteEventCeiling (int eventCeilingNumber, int newValue)</text><ellipse cx="2278" cy="901.0195" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="533" x="2287" y="905.3164">T prepareWriteEventCeilings (int fromEventCeilingNumber, List&lt;Integer&gt; newValues)</text></g><!--MD5=[aafc33f8f8d6830d6a2a07a49f08d208]
class LSSecuritySettingFactory--><g id="elem_LSSecuritySettingFactory"><rect codeLine="290" fill="#FDEDEC" height="66.6211" id="LSSecuritySettingFactory" rx="2.5" ry="2.5" style="stroke:#E74C3C;stroke-width:2.0;" width="291" x="1426.5" y="1963.7402"/><ellipse cx="1482.25" cy="1979.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1483.2031,1976.3809 L1483.2031,1983.0371 L1484.9219,1983.0371 Q1485.5313,1983.0371 1485.7969,1983.2715 Q1486.0625,1983.5059 1486.0625,1983.8965 Q1486.0625,1984.2715 1485.7969,1984.5059 Q1485.5313,1984.7402 1484.9219,1984.7402 L1479.7813,1984.7402 Q1479.1719,1984.7402 1478.9063,1984.5059 Q1478.6406,1984.2715 1478.6406,1983.8809 Q1478.6406,1983.5059 1478.9063,1983.2715 Q1479.1719,1983.0371 1479.7813,1983.0371 L1481.5,1983.0371 L1481.5,1976.3809 L1479.7813,1976.3809 Q1479.1719,1976.3809 1478.9063,1976.1465 Q1478.6406,1975.9121 1478.6406,1975.5215 Q1478.6406,1975.1465 1478.9063,1974.9121 Q1479.1719,1974.6777 1479.7813,1974.6777 L1484.9219,1974.6777 Q1485.5313,1974.6777 1485.7969,1974.9121 Q1486.0625,1975.1465 1486.0625,1975.5215 Q1486.0625,1975.9121 1485.7969,1976.1465 Q1485.5313,1976.3809 1484.9219,1976.3809 L1483.2031,1976.3809 Z " fill="#000000"/><ellipse cx="1507.75" cy="1979.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="160" x="1513.75" y="1985.5371">LSSecuritySettingFactory</text><line style="stroke:#E74C3C;stroke-width:2.0;" x1="1427.5" x2="1716.5" y1="1995.7402" y2="1995.7402"/><line style="stroke:#E74C3C;stroke-width:2.0;" x1="1427.5" x2="1716.5" y1="2003.7402" y2="2003.7402"/><ellipse cx="1437.5" cy="2018.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="265" x="1446.5" y="2022.8477">LSSecuritySetting createSecuritySetting ()</text></g><!--MD5=[8727e1c0ff6388fab62d8f2e6216da7f]
class LSSecuritySetting--><g id="elem_LSSecuritySetting"><rect codeLine="130" fill="#FEFECE" height="66.6211" id="LSSecuritySetting" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="577" x="1283.5" y="1758.2402"/><ellipse cx="1506.25" cy="1774.2402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1507.2031,1770.8809 L1507.2031,1777.5371 L1508.9219,1777.5371 Q1509.5313,1777.5371 1509.7969,1777.7715 Q1510.0625,1778.0059 1510.0625,1778.3965 Q1510.0625,1778.7715 1509.7969,1779.0059 Q1509.5313,1779.2402 1508.9219,1779.2402 L1503.7813,1779.2402 Q1503.1719,1779.2402 1502.9063,1779.0059 Q1502.6406,1778.7715 1502.6406,1778.3809 Q1502.6406,1778.0059 1502.9063,1777.7715 Q1503.1719,1777.5371 1503.7813,1777.5371 L1505.5,1777.5371 L1505.5,1770.8809 L1503.7813,1770.8809 Q1503.1719,1770.8809 1502.9063,1770.6465 Q1502.6406,1770.4121 1502.6406,1770.0215 Q1502.6406,1769.6465 1502.9063,1769.4121 Q1503.1719,1769.1777 1503.7813,1769.1777 L1508.9219,1769.1777 Q1509.5313,1769.1777 1509.7969,1769.4121 Q1510.0625,1769.6465 1510.0625,1770.0215 Q1510.0625,1770.4121 1509.7969,1770.6465 Q1509.5313,1770.8809 1508.9219,1770.8809 L1507.2031,1770.8809 Z " fill="#000000"/><ellipse cx="1531.75" cy="1773.7402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="112" x="1537.75" y="1780.0371">LSSecuritySetting</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1284.5" x2="1859.5" y1="1790.2402" y2="1790.2402"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1284.5" x2="1859.5" y1="1798.2402" y2="1798.2402"/><ellipse cx="1294.5" cy="1813.0508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="279" x="1303.5" y="1817.3477">LSSecuritySetting setControlSamResource (</text><text fill="#808080" filter="url(#bg4rrzasnqk6a0)" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="1582.5" y="1817.3477">CardReader</text><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="190" x="1664.5" y="1817.3477">samReader, LegacySam sam)</text></g><!--MD5=[5c6c7d52e42032554528404b62c1d271]
class RuntimeException--><g id="elem_RuntimeException"><rect codeLine="178" fill="#FEFECE" height="159.7266" id="RuntimeException" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="498" x="1084" y="255.7402"/><ellipse cx="1258.75" cy="271.7402" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1261.5156,267.6152 Q1261.6719,267.3965 1261.8594,267.2871 Q1262.0469,267.1777 1262.2656,267.1777 Q1262.6406,267.1777 1262.875,267.4434 Q1263.1094,267.6934 1263.1094,268.3027 L1263.1094,269.7559 Q1263.1094,270.3652 1262.875,270.6309 Q1262.6406,270.8965 1262.2656,270.8965 Q1261.9219,270.8965 1261.7188,270.6934 Q1261.5156,270.5059 1261.4063,269.9902 Q1261.3594,269.6309 1261.1719,269.4434 Q1260.8438,269.0684 1260.2344,268.8496 Q1259.625,268.6309 1259,268.6309 Q1258.2344,268.6309 1257.5938,268.959 Q1256.9688,269.2871 1256.4688,270.0371 Q1255.9844,270.7871 1255.9844,271.8184 L1255.9844,272.9121 Q1255.9844,274.1465 1256.875,274.9746 Q1257.7656,275.7871 1259.3594,275.7871 Q1260.2969,275.7871 1260.9531,275.5371 Q1261.3438,275.3809 1261.7656,274.9434 Q1262.0313,274.6777 1262.1719,274.5996 Q1262.3281,274.5215 1262.5313,274.5215 Q1262.8594,274.5215 1263.1094,274.7871 Q1263.375,275.0371 1263.375,275.3809 Q1263.375,275.7246 1263.0313,276.1309 Q1262.5313,276.709 1261.7344,277.0371 Q1260.6563,277.4902 1259.3594,277.4902 Q1257.8438,277.4902 1256.6406,276.8652 Q1255.6563,276.3652 1254.9688,275.3027 Q1254.2813,274.2246 1254.2813,272.9434 L1254.2813,271.7871 Q1254.2813,270.459 1254.8906,269.3184 Q1255.5156,268.1621 1256.6094,267.5527 Q1257.7031,266.9277 1258.9375,266.9277 Q1259.6719,266.9277 1260.3125,267.0996 Q1260.9688,267.2559 1261.5156,267.6152 Z " fill="#000000"/><ellipse cx="1284.25" cy="271.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129" x="1290.25" y="277.5371">«RuntimeException»</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1085" x2="1581" y1="287.7402" y2="287.7402"/><ellipse cx="1095" cy="302.5508" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="162" x="1104" y="306.8477">SamRevokedException</text><ellipse cx="1095" cy="321.1719" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="188" x="1104" y="325.4688">InconsistentDataException</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="284" x="1292" y="325.4688">: Number of R-APDUs != number of C-APDUs</text><ellipse cx="1095" cy="339.793" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="185" x="1104" y="344.0898">InvalidSignatureException</text><ellipse cx="1095" cy="358.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="268" x="1104" y="362.7109">UnexpectedCommandStatusException</text><ellipse cx="1095" cy="377.0352" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="136" x="1104" y="381.332">ReaderIOException</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="247" x="1240" y="381.332">: SAM reader communication is broken.</text><ellipse cx="1095" cy="395.6563" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="114" x="1104" y="399.9531">SamIOException</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1085" x2="1581" y1="407.4668" y2="407.4668"/></g><!--MD5=[2185de78a62cf7ee4c18d008ebd59eb9]
class LSSecureReadTransactionManager--><g id="elem_LSSecureReadTransactionManager"><rect codeLine="281" fill="#EBF5FB" height="48" id="LSSecureReadTransactionManager" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:2.0;" width="271" x="1694.5" y="1223.2402"/><ellipse cx="1709.5" cy="1239.2402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1710.4531,1235.8809 L1710.4531,1242.5371 L1712.1719,1242.5371 Q1712.7813,1242.5371 1713.0469,1242.7715 Q1713.3125,1243.0059 1713.3125,1243.3965 Q1713.3125,1243.7715 1713.0469,1244.0059 Q1712.7813,1244.2402 1712.1719,1244.2402 L1707.0313,1244.2402 Q1706.4219,1244.2402 1706.1563,1244.0059 Q1705.8906,1243.7715 1705.8906,1243.3809 Q1705.8906,1243.0059 1706.1563,1242.7715 Q1706.4219,1242.5371 1707.0313,1242.5371 L1708.75,1242.5371 L1708.75,1235.8809 L1707.0313,1235.8809 Q1706.4219,1235.8809 1706.1563,1235.6465 Q1705.8906,1235.4121 1705.8906,1235.0215 Q1705.8906,1234.6465 1706.1563,1234.4121 Q1706.4219,1234.1777 1707.0313,1234.1777 L1712.1719,1234.1777 Q1712.7813,1234.1777 1713.0469,1234.4121 Q1713.3125,1234.6465 1713.3125,1235.0215 Q1713.3125,1235.4121 1713.0469,1235.6465 Q1712.7813,1235.8809 1712.1719,1235.8809 L1710.4531,1235.8809 Z " fill="#000000"/><ellipse cx="1728.5" cy="1238.7402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="228" x="1734.5" y="1245.0371">LSSecureReadTransactionManager</text><line style="stroke:#3498DB;stroke-width:2.0;" x1="1695.5" x2="1964.5" y1="1255.2402" y2="1255.2402"/><line style="stroke:#3498DB;stroke-width:2.0;" x1="1695.5" x2="1964.5" y1="1263.2402" y2="1263.2402"/></g><!--MD5=[a15107c19d982fb54c95bbb84d0c9a77]
class LSFreeTransactionManager--><g id="elem_LSFreeTransactionManager"><rect codeLine="277" fill="#EBF5FB" height="85.2422" id="LSFreeTransactionManager" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:2.0;" width="673" x="2998.5" y="1204.7402"/><ellipse cx="3235.75" cy="1220.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3236.7031,1217.3809 L3236.7031,1224.0371 L3238.4219,1224.0371 Q3239.0313,1224.0371 3239.2969,1224.2715 Q3239.5625,1224.5059 3239.5625,1224.8965 Q3239.5625,1225.2715 3239.2969,1225.5059 Q3239.0313,1225.7402 3238.4219,1225.7402 L3233.2813,1225.7402 Q3232.6719,1225.7402 3232.4063,1225.5059 Q3232.1406,1225.2715 3232.1406,1224.8809 Q3232.1406,1224.5059 3232.4063,1224.2715 Q3232.6719,1224.0371 3233.2813,1224.0371 L3235,1224.0371 L3235,1217.3809 L3233.2813,1217.3809 Q3232.6719,1217.3809 3232.4063,1217.1465 Q3232.1406,1216.9121 3232.1406,1216.5215 Q3232.1406,1216.1465 3232.4063,1215.9121 Q3232.6719,1215.6777 3233.2813,1215.6777 L3238.4219,1215.6777 Q3239.0313,1215.6777 3239.2969,1215.9121 Q3239.5625,1216.1465 3239.5625,1216.5215 Q3239.5625,1216.9121 3239.2969,1217.1465 Q3239.0313,1217.3809 3238.4219,1217.3809 L3236.7031,1217.3809 Z " fill="#000000"/><ellipse cx="3261.25" cy="1220.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="179" x="3267.25" y="1226.5371">LSFreeTransactionManager</text><line style="stroke:#3498DB;stroke-width:2.0;" x1="2999.5" x2="3670.5" y1="1236.7402" y2="1236.7402"/><line style="stroke:#3498DB;stroke-width:2.0;" x1="2999.5" x2="3670.5" y1="1244.7402" y2="1244.7402"/><ellipse cx="3009.5" cy="1259.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="647" x="3018.5" y="1263.8477">LSFreeTransactionManager prepareComputeSignature (CommonSignatureComputationData&lt;?&gt; data)</text><ellipse cx="3009.5" cy="1278.1719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="616" x="3018.5" y="1282.4688">LSFreeTransactionManager prepareVerifySignature (CommonSignatureVerificationData&lt;?&gt; data)</text></g><!--MD5=[4d9df6a4f49f5d022024f42c24edf9b8]
class LSSecureWriteTransactionManager--><g id="elem_LSSecureWriteTransactionManager"><rect codeLine="282" fill="#EBF5FB" height="48" id="LSSecureWriteTransactionManager" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:2.0;" width="271" x="2692.5" y="1223.2402"/><ellipse cx="2707.5" cy="1239.2402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2708.4531,1235.8809 L2708.4531,1242.5371 L2710.1719,1242.5371 Q2710.7813,1242.5371 2711.0469,1242.7715 Q2711.3125,1243.0059 2711.3125,1243.3965 Q2711.3125,1243.7715 2711.0469,1244.0059 Q2710.7813,1244.2402 2710.1719,1244.2402 L2705.0313,1244.2402 Q2704.4219,1244.2402 2704.1563,1244.0059 Q2703.8906,1243.7715 2703.8906,1243.3809 Q2703.8906,1243.0059 2704.1563,1242.7715 Q2704.4219,1242.5371 2705.0313,1242.5371 L2706.75,1242.5371 L2706.75,1235.8809 L2705.0313,1235.8809 Q2704.4219,1235.8809 2704.1563,1235.6465 Q2703.8906,1235.4121 2703.8906,1235.0215 Q2703.8906,1234.6465 2704.1563,1234.4121 Q2704.4219,1234.1777 2705.0313,1234.1777 L2710.1719,1234.1777 Q2710.7813,1234.1777 2711.0469,1234.4121 Q2711.3125,1234.6465 2711.3125,1235.0215 Q2711.3125,1235.4121 2711.0469,1235.6465 Q2710.7813,1235.8809 2710.1719,1235.8809 L2708.4531,1235.8809 Z " fill="#000000"/><ellipse cx="2726.5" cy="1238.7402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="228" x="2732.5" y="1245.0371">LSSecureWriteTransactionManager</text><line style="stroke:#3498DB;stroke-width:2.0;" x1="2693.5" x2="2962.5" y1="1255.2402" y2="1255.2402"/><line style="stroke:#3498DB;stroke-width:2.0;" x1="2693.5" x2="2962.5" y1="1263.2402" y2="1263.2402"/></g><!--MD5=[ef45bb1e18d403a7d85319e4423fd3a0]
class LSTargetSamAsyncTransactionManager--><g id="elem_LSTargetSamAsyncTransactionManager"><rect codeLine="284" fill="#EBF5FB" height="66.6211" id="LSTargetSamAsyncTransactionManager" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:2.0;" width="605" x="1054.5" y="1213.7402"/><ellipse cx="1218.75" cy="1229.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1219.7031,1226.3809 L1219.7031,1233.0371 L1221.4219,1233.0371 Q1222.0313,1233.0371 1222.2969,1233.2715 Q1222.5625,1233.5059 1222.5625,1233.8965 Q1222.5625,1234.2715 1222.2969,1234.5059 Q1222.0313,1234.7402 1221.4219,1234.7402 L1216.2813,1234.7402 Q1215.6719,1234.7402 1215.4063,1234.5059 Q1215.1406,1234.2715 1215.1406,1233.8809 Q1215.1406,1233.5059 1215.4063,1233.2715 Q1215.6719,1233.0371 1216.2813,1233.0371 L1218,1233.0371 L1218,1226.3809 L1216.2813,1226.3809 Q1215.6719,1226.3809 1215.4063,1226.1465 Q1215.1406,1225.9121 1215.1406,1225.5215 Q1215.1406,1225.1465 1215.4063,1224.9121 Q1215.6719,1224.6777 1216.2813,1224.6777 L1221.4219,1224.6777 Q1222.0313,1224.6777 1222.2969,1224.9121 Q1222.5625,1225.1465 1222.5625,1225.5215 Q1222.5625,1225.9121 1222.2969,1226.1465 Q1222.0313,1226.3809 1221.4219,1226.3809 L1219.7031,1226.3809 Z " fill="#000000"/><ellipse cx="1244.25" cy="1229.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="257" x="1250.25" y="1235.5371">LSTargetSamAsyncTransactionManager</text><line style="stroke:#3498DB;stroke-width:2.0;" x1="1055.5" x2="1658.5" y1="1245.7402" y2="1245.7402"/><line style="stroke:#3498DB;stroke-width:2.0;" x1="1055.5" x2="1658.5" y1="1253.7402" y2="1253.7402"/><ellipse cx="1065.5" cy="1268.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="579" x="1074.5" y="1272.8477">LSTargetSamAsyncTransactionManager importCommands (String cipheredSamCommands)</text></g><!--MD5=[4c31f83c554d59234dcbadf6d50b44e5]
class LSControlSamAsyncTransactionManager--><g id="elem_LSControlSamAsyncTransactionManager"><rect codeLine="283" fill="#EBF5FB" height="85.2422" id="LSControlSamAsyncTransactionManager" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:2.0;" width="656" x="2001" y="1204.7402"/><ellipse cx="2188.75" cy="1220.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2189.7031,1217.3809 L2189.7031,1224.0371 L2191.4219,1224.0371 Q2192.0313,1224.0371 2192.2969,1224.2715 Q2192.5625,1224.5059 2192.5625,1224.8965 Q2192.5625,1225.2715 2192.2969,1225.5059 Q2192.0313,1225.7402 2191.4219,1225.7402 L2186.2813,1225.7402 Q2185.6719,1225.7402 2185.4063,1225.5059 Q2185.1406,1225.2715 2185.1406,1224.8809 Q2185.1406,1224.5059 2185.4063,1224.2715 Q2185.6719,1224.0371 2186.2813,1224.0371 L2188,1224.0371 L2188,1217.3809 L2186.2813,1217.3809 Q2185.6719,1217.3809 2185.4063,1217.1465 Q2185.1406,1216.9121 2185.1406,1216.5215 Q2185.1406,1216.1465 2185.4063,1215.9121 Q2185.6719,1215.6777 2186.2813,1215.6777 L2191.4219,1215.6777 Q2192.0313,1215.6777 2192.2969,1215.9121 Q2192.5625,1216.1465 2192.5625,1216.5215 Q2192.5625,1216.9121 2192.2969,1217.1465 Q2192.0313,1217.3809 2191.4219,1217.3809 L2189.7031,1217.3809 Z " fill="#000000"/><ellipse cx="2214.25" cy="1220.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="261" x="2220.25" y="1226.5371">LSControlSamAsyncTransactionManager</text><line style="stroke:#3498DB;stroke-width:2.0;" x1="2002" x2="2656" y1="1236.7402" y2="1236.7402"/><line style="stroke:#3498DB;stroke-width:2.0;" x1="2002" x2="2656" y1="1244.7402" y2="1244.7402"/><ellipse cx="2012" cy="1259.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="630" x="2021" y="1263.8477">LSControlSamAsyncTransactionManager prepareGiveTargetSamPseudoRandom (? asyncRandom)</text><ellipse cx="2012" cy="1278.1719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="165" x="2021" y="1282.4688">String exportCommands ()</text></g><!--MD5=[01cd1e2f08b03d7a7441eac2a93088c3]
class LSCardTransactionCryptoExtensionFactory--><g id="elem_LSCardTransactionCryptoExtensionFactory"><rect codeLine="288" fill="#FDEDEC" height="66.6211" id="LSCardTransactionCryptoExtensionFactory" rx="2.5" ry="2.5" style="stroke:#E74C3C;stroke-width:2.0;" width="567" x="3805.5" y="771.7402"/><ellipse cx="3942.25" cy="787.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3943.2031,784.3809 L3943.2031,791.0371 L3944.9219,791.0371 Q3945.5313,791.0371 3945.7969,791.2715 Q3946.0625,791.5059 3946.0625,791.8965 Q3946.0625,792.2715 3945.7969,792.5059 Q3945.5313,792.7402 3944.9219,792.7402 L3939.7813,792.7402 Q3939.1719,792.7402 3938.9063,792.5059 Q3938.6406,792.2715 3938.6406,791.8809 Q3938.6406,791.5059 3938.9063,791.2715 Q3939.1719,791.0371 3939.7813,791.0371 L3941.5,791.0371 L3941.5,784.3809 L3939.7813,784.3809 Q3939.1719,784.3809 3938.9063,784.1465 Q3938.6406,783.9121 3938.6406,783.5215 Q3938.6406,783.1465 3938.9063,782.9121 Q3939.1719,782.6777 3939.7813,782.6777 L3944.9219,782.6777 Q3945.5313,782.6777 3945.7969,782.9121 Q3946.0625,783.1465 3946.0625,783.5215 Q3946.0625,783.9121 3945.7969,784.1465 Q3945.5313,784.3809 3944.9219,784.3809 L3943.2031,784.3809 Z " fill="#000000"/><ellipse cx="3967.75" cy="787.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="274" x="3973.75" y="793.5371">LSCardTransactionCryptoExtensionFactory</text><line style="stroke:#E74C3C;stroke-width:2.0;" x1="3806.5" x2="4371.5" y1="803.7402" y2="803.7402"/><line style="stroke:#E74C3C;stroke-width:2.0;" x1="3806.5" x2="4371.5" y1="811.7402" y2="811.7402"/><ellipse cx="3816.5" cy="826.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="541" x="3825.5" y="830.8477">LSCardTransactionCryptoExtensionFactory createCardTransactionCryptoExtension ()</text></g><!--MD5=[6f02cf5072742952965667ff83454085]
class LSCardTransactionCryptoExtension--><g id="elem_LSCardTransactionCryptoExtension"><rect codeLine="292" fill="#E9F7EF" height="100.4844" id="LSCardTransactionCryptoExtension" rx="2.5" ry="2.5" style="stroke:#27AE60;stroke-width:2.0;" width="721" x="3728.5" y="1197.2402"/><ellipse cx="3964.25" cy="1220.8613" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3965.2031,1217.502 L3965.2031,1224.1582 L3966.9219,1224.1582 Q3967.5313,1224.1582 3967.7969,1224.3926 Q3968.0625,1224.627 3968.0625,1225.0176 Q3968.0625,1225.3926 3967.7969,1225.627 Q3967.5313,1225.8613 3966.9219,1225.8613 L3961.7813,1225.8613 Q3961.1719,1225.8613 3960.9063,1225.627 Q3960.6406,1225.3926 3960.6406,1225.002 Q3960.6406,1224.627 3960.9063,1224.3926 Q3961.1719,1224.1582 3961.7813,1224.1582 L3963.5,1224.1582 L3963.5,1217.502 L3961.7813,1217.502 Q3961.1719,1217.502 3960.9063,1217.2676 Q3960.6406,1217.0332 3960.6406,1216.6426 Q3960.6406,1216.2676 3960.9063,1216.0332 Q3961.1719,1215.7988 3961.7813,1215.7988 L3966.9219,1215.7988 Q3967.5313,1215.7988 3967.7969,1216.0332 Q3968.0625,1216.2676 3968.0625,1216.6426 Q3968.0625,1217.0332 3967.7969,1217.2676 Q3967.5313,1217.502 3966.9219,1217.502 L3965.2031,1217.502 Z " fill="#000000"/><ellipse cx="3989.75" cy="1220.3613" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="16" x="3995.75" y="1217.3477">&lt;&lt;</text><text fill="#000000" filter="url(#bg4rrzasnqk6a1)" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="198" x="4011.75" y="1217.3477">CCTransactionCryptoExtension</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="16" x="4209.75" y="1217.3477">&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="226" x="3997.75" y="1235.9688">LSCardTransactionCryptoExtension</text><line style="stroke:#27AE60;stroke-width:2.0;" x1="3729.5" x2="4448.5" y1="1244.4824" y2="1244.4824"/><line style="stroke:#27AE60;stroke-width:2.0;" x1="3729.5" x2="4448.5" y1="1252.4824" y2="1252.4824"/><ellipse cx="3739.5" cy="1267.293" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="695" x="3748.5" y="1271.5898">LSCardTransactionCryptoExtension prepareComputeSignature (CommonSignatureComputationData&lt;?&gt; data)</text><ellipse cx="3739.5" cy="1285.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="664" x="3748.5" y="1290.2109">LSCardTransactionCryptoExtension prepareVerifySignature (CommonSignatureVerificationData&lt;?&gt; data)</text></g><!--MD5=[c17ae2c2af60537b87d9abee834860c0]
class CommonSignatureComputationData--><g id="elem_CommonSignatureComputationData"><rect codeLine="143" fill="#FEFECE" height="141.1055" id="CommonSignatureComputationData" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="553" x="2801.5" y="1508.7402"/><ellipse cx="2816.5" cy="1524.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2817.4531,1521.3809 L2817.4531,1528.0371 L2819.1719,1528.0371 Q2819.7813,1528.0371 2820.0469,1528.2715 Q2820.3125,1528.5059 2820.3125,1528.8965 Q2820.3125,1529.2715 2820.0469,1529.5059 Q2819.7813,1529.7402 2819.1719,1529.7402 L2814.0313,1529.7402 Q2813.4219,1529.7402 2813.1563,1529.5059 Q2812.8906,1529.2715 2812.8906,1528.8809 Q2812.8906,1528.5059 2813.1563,1528.2715 Q2813.4219,1528.0371 2814.0313,1528.0371 L2815.75,1528.0371 L2815.75,1521.3809 L2814.0313,1521.3809 Q2813.4219,1521.3809 2813.1563,1521.1465 Q2812.8906,1520.9121 2812.8906,1520.5215 Q2812.8906,1520.1465 2813.1563,1519.9121 Q2813.4219,1519.6777 2814.0313,1519.6777 L2819.1719,1519.6777 Q2819.7813,1519.6777 2820.0469,1519.9121 Q2820.3125,1520.1465 2820.3125,1520.5215 Q2820.3125,1520.9121 2820.0469,1521.1465 Q2819.7813,1521.3809 2819.1719,1521.3809 L2817.4531,1521.3809 Z " fill="#000000"/><ellipse cx="2835.5" cy="1524.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="227" x="2841.5" y="1530.5371">CommonSignatureComputationData</text><rect fill="#FFFFFF" height="17.9609" style="stroke:#D4AC0D;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="281" x="3076.5" y="1505.7402"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="279" x="3077.5" y="1519.6895">T extends CommonSignatureComputationData&lt;T&gt;</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="2802.5" x2="3353.5" y1="1540.7402" y2="1540.7402"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="2802.5" x2="3353.5" y1="1548.7402" y2="1548.7402"/><ellipse cx="2812.5" cy="1563.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="256" x="2821.5" y="1567.8477">T setData (byte[] data, byte kif, byte kvc)</text><ellipse cx="2812.5" cy="1582.1719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="176" x="2821.5" y="1586.4688">T setSignatureSize (int size)</text><ellipse cx="2812.5" cy="1600.793" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="233" x="2821.5" y="1605.0898">T setKeyDiversifier (byte[] diversifier)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2821.5" y="1623.7109"> </text><ellipse cx="2812.5" cy="1638.0352" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134" x="2821.5" y="1642.332">byte[] getSignature ()</text></g><!--MD5=[c644258d6e85feb715526e24ebfc93b6]
class BasicSignatureComputationData--><g id="elem_BasicSignatureComputationData"><rect codeLine="150" fill="#FEFECE" height="48" id="BasicSignatureComputationData" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="248" x="2874" y="1767.7402"/><ellipse cx="2889" cy="1783.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2889.9531,1780.3809 L2889.9531,1787.0371 L2891.6719,1787.0371 Q2892.2813,1787.0371 2892.5469,1787.2715 Q2892.8125,1787.5059 2892.8125,1787.8965 Q2892.8125,1788.2715 2892.5469,1788.5059 Q2892.2813,1788.7402 2891.6719,1788.7402 L2886.5313,1788.7402 Q2885.9219,1788.7402 2885.6563,1788.5059 Q2885.3906,1788.2715 2885.3906,1787.8809 Q2885.3906,1787.5059 2885.6563,1787.2715 Q2885.9219,1787.0371 2886.5313,1787.0371 L2888.25,1787.0371 L2888.25,1780.3809 L2886.5313,1780.3809 Q2885.9219,1780.3809 2885.6563,1780.1465 Q2885.3906,1779.9121 2885.3906,1779.5215 Q2885.3906,1779.1465 2885.6563,1778.9121 Q2885.9219,1778.6777 2886.5313,1778.6777 L2891.6719,1778.6777 Q2892.2813,1778.6777 2892.5469,1778.9121 Q2892.8125,1779.1465 2892.8125,1779.5215 Q2892.8125,1779.9121 2892.5469,1780.1465 Q2892.2813,1780.3809 2891.6719,1780.3809 L2889.9531,1780.3809 Z " fill="#000000"/><ellipse cx="2908" cy="1783.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="205" x="2914" y="1789.5371">BasicSignatureComputationData</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="2875" x2="3121" y1="1799.7402" y2="1799.7402"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="2875" x2="3121" y1="1807.7402" y2="1807.7402"/></g><!--MD5=[cdc2fcd8768bdabfe9b56e9f578bd14d]
class TraceableSignatureComputationData--><g id="elem_TraceableSignatureComputationData"><rect codeLine="152" fill="#FEFECE" height="122.4844" id="TraceableSignatureComputationData" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="732" x="2107" y="1730.7402"/><ellipse cx="2345.75" cy="1746.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2346.7031,1743.3809 L2346.7031,1750.0371 L2348.4219,1750.0371 Q2349.0313,1750.0371 2349.2969,1750.2715 Q2349.5625,1750.5059 2349.5625,1750.8965 Q2349.5625,1751.2715 2349.2969,1751.5059 Q2349.0313,1751.7402 2348.4219,1751.7402 L2343.2813,1751.7402 Q2342.6719,1751.7402 2342.4063,1751.5059 Q2342.1406,1751.2715 2342.1406,1750.8809 Q2342.1406,1750.5059 2342.4063,1750.2715 Q2342.6719,1750.0371 2343.2813,1750.0371 L2345,1750.0371 L2345,1743.3809 L2343.2813,1743.3809 Q2342.6719,1743.3809 2342.4063,1743.1465 Q2342.1406,1742.9121 2342.1406,1742.5215 Q2342.1406,1742.1465 2342.4063,1741.9121 Q2342.6719,1741.6777 2343.2813,1741.6777 L2348.4219,1741.6777 Q2349.0313,1741.6777 2349.2969,1741.9121 Q2349.5625,1742.1465 2349.5625,1742.5215 Q2349.5625,1742.9121 2349.2969,1743.1465 Q2349.0313,1743.3809 2348.4219,1743.3809 L2346.7031,1743.3809 Z " fill="#000000"/><ellipse cx="2371.25" cy="1746.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="235" x="2377.25" y="1752.5371">TraceableSignatureComputationData</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="2108" x2="2838" y1="1762.7402" y2="1762.7402"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="2108" x2="2838" y1="1770.7402" y2="1770.7402"/><ellipse cx="2118" cy="1785.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="706" x="2127" y="1789.8477">TraceableSignatureComputationData withSamTraceabilityMode (int offset, boolean usePartialSamSerialNumber)</text><ellipse cx="2118" cy="1804.1719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="363" x="2127" y="1808.4688">TraceableSignatureComputationData withoutBusyMode ()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2127" y="1827.0898"> </text><ellipse cx="2118" cy="1841.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147" x="2127" y="1845.7109">byte[] getSignedData ()</text></g><!--MD5=[49815161954875a46b9e77877b8c8585]
class CommonSignatureVerificationData--><g id="elem_CommonSignatureVerificationData"><rect codeLine="158" fill="#FEFECE" height="122.4844" id="CommonSignatureVerificationData" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="533" x="3517.5" y="1518.2402"/><ellipse cx="3532.5" cy="1534.2402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3533.4531,1530.8809 L3533.4531,1537.5371 L3535.1719,1537.5371 Q3535.7813,1537.5371 3536.0469,1537.7715 Q3536.3125,1538.0059 3536.3125,1538.3965 Q3536.3125,1538.7715 3536.0469,1539.0059 Q3535.7813,1539.2402 3535.1719,1539.2402 L3530.0313,1539.2402 Q3529.4219,1539.2402 3529.1563,1539.0059 Q3528.8906,1538.7715 3528.8906,1538.3809 Q3528.8906,1538.0059 3529.1563,1537.7715 Q3529.4219,1537.5371 3530.0313,1537.5371 L3531.75,1537.5371 L3531.75,1530.8809 L3530.0313,1530.8809 Q3529.4219,1530.8809 3529.1563,1530.6465 Q3528.8906,1530.4121 3528.8906,1530.0215 Q3528.8906,1529.6465 3529.1563,1529.4121 Q3529.4219,1529.1777 3530.0313,1529.1777 L3535.1719,1529.1777 Q3535.7813,1529.1777 3536.0469,1529.4121 Q3536.3125,1529.6465 3536.3125,1530.0215 Q3536.3125,1530.4121 3536.0469,1530.6465 Q3535.7813,1530.8809 3535.1719,1530.8809 L3533.4531,1530.8809 Z " fill="#000000"/><ellipse cx="3551.5" cy="1533.7402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="217" x="3557.5" y="1540.0371">CommonSignatureVerificationData</text><rect fill="#FFFFFF" height="17.9609" style="stroke:#D4AC0D;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="271" x="3782.5" y="1515.2402"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="269" x="3783.5" y="1529.1895">T extends CommonSignatureVerificationData&lt;T&gt;</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="3518.5" x2="4049.5" y1="1550.2402" y2="1550.2402"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="3518.5" x2="4049.5" y1="1558.2402" y2="1558.2402"/><ellipse cx="3528.5" cy="1573.0508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="362" x="3537.5" y="1577.3477">T setData (byte[] data, byte[] signature, byte kif, byte kvc)</text><ellipse cx="3528.5" cy="1591.6719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="233" x="3537.5" y="1595.9688">T setKeyDiversifier (byte[] diversifier)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="3537.5" y="1614.5898"> </text><ellipse cx="3528.5" cy="1628.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="171" x="3537.5" y="1633.2109">boolean isSignatureValid ()</text></g><!--MD5=[792b97716737da270761df73939131ae]
class BasicSignatureVerificationData--><g id="elem_BasicSignatureVerificationData"><rect codeLine="164" fill="#FEFECE" height="48" id="BasicSignatureVerificationData" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="238" x="3157" y="1767.7402"/><ellipse cx="3172" cy="1783.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3172.9531,1780.3809 L3172.9531,1787.0371 L3174.6719,1787.0371 Q3175.2813,1787.0371 3175.5469,1787.2715 Q3175.8125,1787.5059 3175.8125,1787.8965 Q3175.8125,1788.2715 3175.5469,1788.5059 Q3175.2813,1788.7402 3174.6719,1788.7402 L3169.5313,1788.7402 Q3168.9219,1788.7402 3168.6563,1788.5059 Q3168.3906,1788.2715 3168.3906,1787.8809 Q3168.3906,1787.5059 3168.6563,1787.2715 Q3168.9219,1787.0371 3169.5313,1787.0371 L3171.25,1787.0371 L3171.25,1780.3809 L3169.5313,1780.3809 Q3168.9219,1780.3809 3168.6563,1780.1465 Q3168.3906,1779.9121 3168.3906,1779.5215 Q3168.3906,1779.1465 3168.6563,1778.9121 Q3168.9219,1778.6777 3169.5313,1778.6777 L3174.6719,1778.6777 Q3175.2813,1778.6777 3175.5469,1778.9121 Q3175.8125,1779.1465 3175.8125,1779.5215 Q3175.8125,1779.9121 3175.5469,1780.1465 Q3175.2813,1780.3809 3174.6719,1780.3809 L3172.9531,1780.3809 Z " fill="#000000"/><ellipse cx="3191" cy="1783.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="195" x="3197" y="1789.5371">BasicSignatureVerificationData</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="3158" x2="3394" y1="1799.7402" y2="1799.7402"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="3158" x2="3394" y1="1807.7402" y2="1807.7402"/></g><!--MD5=[2fc7953a0035a8aa989ea0d75f9f7d1b]
class TraceableSignatureVerificationData--><g id="elem_TraceableSignatureVerificationData"><rect codeLine="166" fill="#FEFECE" height="85.2422" id="TraceableSignatureVerificationData" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="1020" x="3430" y="1749.2402"/><ellipse cx="3817.75" cy="1765.2402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3818.7031,1761.8809 L3818.7031,1768.5371 L3820.4219,1768.5371 Q3821.0313,1768.5371 3821.2969,1768.7715 Q3821.5625,1769.0059 3821.5625,1769.3965 Q3821.5625,1769.7715 3821.2969,1770.0059 Q3821.0313,1770.2402 3820.4219,1770.2402 L3815.2813,1770.2402 Q3814.6719,1770.2402 3814.4063,1770.0059 Q3814.1406,1769.7715 3814.1406,1769.3809 Q3814.1406,1769.0059 3814.4063,1768.7715 Q3814.6719,1768.5371 3815.2813,1768.5371 L3817,1768.5371 L3817,1761.8809 L3815.2813,1761.8809 Q3814.6719,1761.8809 3814.4063,1761.6465 Q3814.1406,1761.4121 3814.1406,1761.0215 Q3814.1406,1760.6465 3814.4063,1760.4121 Q3814.6719,1760.1777 3815.2813,1760.1777 L3820.4219,1760.1777 Q3821.0313,1760.1777 3821.2969,1760.4121 Q3821.5625,1760.6465 3821.5625,1761.0215 Q3821.5625,1761.4121 3821.2969,1761.6465 Q3821.0313,1761.8809 3820.4219,1761.8809 L3818.7031,1761.8809 Z " fill="#000000"/><ellipse cx="3843.25" cy="1764.7402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="225" x="3849.25" y="1771.0371">TraceableSignatureVerificationData</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="3431" x2="4449" y1="1781.2402" y2="1781.2402"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="3431" x2="4449" y1="1789.2402" y2="1789.2402"/><ellipse cx="3441" cy="1804.0508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="994" x="3450" y="1808.3477">TraceableSignatureVerificationData withSamTraceabilityMode (int offset, boolean isPartialSamSerialNumber, LSRevocationServiceSpi samRevocationService)</text><ellipse cx="3441" cy="1822.6719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="353" x="3450" y="1826.9688">TraceableSignatureVerificationData withoutBusyMode ()</text></g><!--MD5=[c684c8e9c796bcc146d218b550b71c40]
class LSCommandDataFactory--><g id="elem_LSCommandDataFactory"><rect codeLine="289" fill="#FDEDEC" height="122.4844" id="LSCommandDataFactory" rx="2.5" ry="2.5" style="stroke:#E74C3C;stroke-width:2.0;" width="554" x="2860" y="1936.2402"/><ellipse cx="3047.75" cy="1952.2402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3048.7031,1948.8809 L3048.7031,1955.5371 L3050.4219,1955.5371 Q3051.0313,1955.5371 3051.2969,1955.7715 Q3051.5625,1956.0059 3051.5625,1956.3965 Q3051.5625,1956.7715 3051.2969,1957.0059 Q3051.0313,1957.2402 3050.4219,1957.2402 L3045.2813,1957.2402 Q3044.6719,1957.2402 3044.4063,1957.0059 Q3044.1406,1956.7715 3044.1406,1956.3809 Q3044.1406,1956.0059 3044.4063,1955.7715 Q3044.6719,1955.5371 3045.2813,1955.5371 L3047,1955.5371 L3047,1948.8809 L3045.2813,1948.8809 Q3044.6719,1948.8809 3044.4063,1948.6465 Q3044.1406,1948.4121 3044.1406,1948.0215 Q3044.1406,1947.6465 3044.4063,1947.4121 Q3044.6719,1947.1777 3045.2813,1947.1777 L3050.4219,1947.1777 Q3051.0313,1947.1777 3051.2969,1947.4121 Q3051.5625,1947.6465 3051.5625,1948.0215 Q3051.5625,1948.4121 3051.2969,1948.6465 Q3051.0313,1948.8809 3050.4219,1948.8809 L3048.7031,1948.8809 Z " fill="#000000"/><ellipse cx="3073.25" cy="1951.7402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="159" x="3079.25" y="1958.0371">LSCommandDataFactory</text><line style="stroke:#E74C3C;stroke-width:2.0;" x1="2861" x2="3413" y1="1968.2402" y2="1968.2402"/><line style="stroke:#E74C3C;stroke-width:2.0;" x1="2861" x2="3413" y1="1976.2402" y2="1976.2402"/><ellipse cx="2871" cy="1991.0508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="468" x="2880" y="1995.3477">BasicSignatureComputationData createBasicSignatureComputationData ()</text><ellipse cx="2871" cy="2009.6719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="528" x="2880" y="2013.9688">TraceableSignatureComputationData createTraceableSignatureComputationData ()</text><ellipse cx="2871" cy="2028.293" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="448" x="2880" y="2032.5898">BasicSignatureVerificationData createBasicSignatureVerificationData ()</text><ellipse cx="2871" cy="2046.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="508" x="2880" y="2051.2109">TraceableSignatureVerificationData createTraceableSignatureVerificationData ()</text></g><!--MD5=[a7bf48cdf74e2140b4a55be2ea8a87ae]
class LegacySamSelectionFactory--><g id="elem_LegacySamSelectionFactory"><rect codeLine="286" fill="#FDEDEC" height="66.6211" id="LegacySamSelectionFactory" rx="2.5" ry="2.5" style="stroke:#E74C3C;stroke-width:2.0;" width="302" x="167" y="771.7402"/><ellipse cx="218.25" cy="787.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M219.2031,784.3809 L219.2031,791.0371 L220.9219,791.0371 Q221.5313,791.0371 221.7969,791.2715 Q222.0625,791.5059 222.0625,791.8965 Q222.0625,792.2715 221.7969,792.5059 Q221.5313,792.7402 220.9219,792.7402 L215.7813,792.7402 Q215.1719,792.7402 214.9063,792.5059 Q214.6406,792.2715 214.6406,791.8809 Q214.6406,791.5059 214.9063,791.2715 Q215.1719,791.0371 215.7813,791.0371 L217.5,791.0371 L217.5,784.3809 L215.7813,784.3809 Q215.1719,784.3809 214.9063,784.1465 Q214.6406,783.9121 214.6406,783.5215 Q214.6406,783.1465 214.9063,782.9121 Q215.1719,782.6777 215.7813,782.6777 L220.9219,782.6777 Q221.5313,782.6777 221.7969,782.9121 Q222.0625,783.1465 222.0625,783.5215 Q222.0625,783.9121 221.7969,784.1465 Q221.5313,784.3809 220.9219,784.3809 L219.2031,784.3809 Z " fill="#000000"/><ellipse cx="243.75" cy="787.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="180" x="249.75" y="793.5371">LegacySamSelectionFactory</text><line style="stroke:#E74C3C;stroke-width:2.0;" x1="168" x2="468" y1="803.7402" y2="803.7402"/><line style="stroke:#E74C3C;stroke-width:2.0;" x1="168" x2="468" y1="811.7402" y2="811.7402"/><ellipse cx="178" cy="826.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="276" x="187" y="830.8477">LegacySamSelection createSamSelection ()</text></g><!--MD5=[f828a509400a69824ac8cdade397711f]
class LegacySamSelection--><g id="elem_LegacySamSelection"><rect codeLine="294" fill="#E9F7EF" height="137.7266" id="LegacySamSelection" rx="2.5" ry="2.5" style="stroke:#27AE60;stroke-width:2.0;" width="543" x="46.5" y="1178.2402"/><ellipse cx="242.25" cy="1201.8613" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M243.2031,1198.502 L243.2031,1205.1582 L244.9219,1205.1582 Q245.5313,1205.1582 245.7969,1205.3926 Q246.0625,1205.627 246.0625,1206.0176 Q246.0625,1206.3926 245.7969,1206.627 Q245.5313,1206.8613 244.9219,1206.8613 L239.7813,1206.8613 Q239.1719,1206.8613 238.9063,1206.627 Q238.6406,1206.3926 238.6406,1206.002 Q238.6406,1205.627 238.9063,1205.3926 Q239.1719,1205.1582 239.7813,1205.1582 L241.5,1205.1582 L241.5,1198.502 L239.7813,1198.502 Q239.1719,1198.502 238.9063,1198.2676 Q238.6406,1198.0332 238.6406,1197.6426 Q238.6406,1197.2676 238.9063,1197.0332 Q239.1719,1196.7988 239.7813,1196.7988 L244.9219,1196.7988 Q245.5313,1196.7988 245.7969,1197.0332 Q246.0625,1197.2676 246.0625,1197.6426 Q246.0625,1198.0332 245.7969,1198.2676 Q245.5313,1198.502 244.9219,1198.502 L243.2031,1198.502 Z " fill="#000000"/><ellipse cx="267.75" cy="1201.3613" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="16" x="279.25" y="1198.3477">&lt;&lt;</text><text fill="#000000" filter="url(#bg4rrzasnqk6a0)" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="89" x="295.25" y="1198.3477">CardSelection</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="16" x="384.25" y="1198.3477">&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="132" x="273.75" y="1216.9688">LegacySamSelection</text><line style="stroke:#27AE60;stroke-width:2.0;" x1="47.5" x2="588.5" y1="1225.4824" y2="1225.4824"/><line style="stroke:#27AE60;stroke-width:2.0;" x1="47.5" x2="588.5" y1="1233.4824" y2="1233.4824"/><ellipse cx="57.5" cy="1248.293" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="517" x="66.5" y="1252.5898">LegacySamSelection filterByProductType (LegacySam.ProductType productType)</text><ellipse cx="57.5" cy="1266.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="442" x="66.5" y="1271.2109">LegacySamSelection filterBySerialNumber (String serialNumberRegex)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="66.5" y="1289.832"> </text><ellipse cx="57.5" cy="1304.1563" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="353" x="66.5" y="1308.4531">LegacySamSelection setUnlockData (String unlockData)</text></g><!--MD5=[756cbdb2eeffdcd67180b97f5e83c8e0]
class LegacySam--><g id="elem_LegacySam"><rect codeLine="197" fill="#FEFECE" height="361.1797" id="LegacySam" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="349" x="624.5" y="1066.7402"/><ellipse cx="739.25" cy="1090.3613" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M740.2031,1087.002 L740.2031,1093.6582 L741.9219,1093.6582 Q742.5313,1093.6582 742.7969,1093.8926 Q743.0625,1094.127 743.0625,1094.5176 Q743.0625,1094.8926 742.7969,1095.127 Q742.5313,1095.3613 741.9219,1095.3613 L736.7813,1095.3613 Q736.1719,1095.3613 735.9063,1095.127 Q735.6406,1094.8926 735.6406,1094.502 Q735.6406,1094.127 735.9063,1093.8926 Q736.1719,1093.6582 736.7813,1093.6582 L738.5,1093.6582 L738.5,1087.002 L736.7813,1087.002 Q736.1719,1087.002 735.9063,1086.7676 Q735.6406,1086.5332 735.6406,1086.1426 Q735.6406,1085.7676 735.9063,1085.5332 Q736.1719,1085.2988 736.7813,1085.2988 L741.9219,1085.2988 Q742.5313,1085.2988 742.7969,1085.5332 Q743.0625,1085.7676 743.0625,1086.1426 Q743.0625,1086.5332 742.7969,1086.7676 Q742.5313,1087.002 741.9219,1087.002 L740.2031,1087.002 Z " fill="#000000"/><ellipse cx="764.75" cy="1089.8613" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="16" x="770.75" y="1086.8477">&lt;&lt;</text><text fill="#000000" filter="url(#bg4rrzasnqk6a0)" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="68" x="786.75" y="1086.8477">SmartCard</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="16" x="854.75" y="1086.8477">&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="74" x="783.75" y="1105.4688">LegacySam</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="625.5" x2="972.5" y1="1113.9824" y2="1113.9824"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="625.5" x2="972.5" y1="1121.9824" y2="1121.9824"/><ellipse cx="635.5" cy="1136.793" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="200" x="644.5" y="1141.0898">ProductType getProductType ()</text><ellipse cx="635.5" cy="1155.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147" x="644.5" y="1159.7109">String getProductInfo ()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="644.5" y="1178.332"> </text><ellipse cx="635.5" cy="1192.6563" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="644.5" y="1196.9531">byte[] getSerialNumber ()</text><ellipse cx="635.5" cy="1211.2773" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="644.5" y="1215.5742">byte getPlatform ()</text><ellipse cx="635.5" cy="1229.8984" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="166" x="644.5" y="1234.1953">byte getApplicationType ()</text><ellipse cx="635.5" cy="1248.5195" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="191" x="644.5" y="1252.8164">byte getApplicationSubType ()</text><ellipse cx="635.5" cy="1267.1406" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="644.5" y="1271.4375">byte getSoftwareIssuer ()</text><ellipse cx="635.5" cy="1285.7617" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="168" x="644.5" y="1290.0586">byte getSoftwareVersion ()</text><ellipse cx="635.5" cy="1304.3828" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="174" x="644.5" y="1308.6797">byte getSoftwareRevision ()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="644.5" y="1327.3008"> </text><ellipse cx="635.5" cy="1341.625" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="323" x="644.5" y="1345.9219">Integer getEventCounter (int eventCounterNumber)</text><ellipse cx="635.5" cy="1360.2461" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="313" x="644.5" y="1364.543">SortedMap&lt;Integer, Integer&gt; getEventCounters ()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="644.5" y="1383.1641"> </text><ellipse cx="635.5" cy="1397.4883" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="307" x="644.5" y="1401.7852">Integer getEventCeiling (int eventCeilingNumber)</text><ellipse cx="635.5" cy="1416.1094" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="305" x="644.5" y="1420.4063">SortedMap&lt;Integer, Integer&gt; getEventCeilings ()</text></g><!--MD5=[64db2d10778acf6b7b903aeb76cb16f8]
class SamProductType--><g id="elem_SamProductType"><rect codeLine="215" fill="#FEFECE" height="141.1055" id="SamProductType" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="124" x="696" y="1508.7402"/><ellipse cx="711" cy="1524.7402" fill="#EB937F" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M709.8594,1525.5371 L709.8594,1528.0371 L714.1875,1528.0371 L714.1875,1527.1152 Q714.1875,1526.5059 714.4219,1526.2402 Q714.6719,1525.9746 715.0469,1525.9746 Q715.4219,1525.9746 715.6563,1526.2402 Q715.8906,1526.5059 715.8906,1527.1152 L715.8906,1529.7402 L707.8906,1529.7402 Q707.2656,1529.7402 707,1529.5059 Q706.75,1529.2715 706.75,1528.8809 Q706.75,1528.5059 707.0156,1528.2715 Q707.2813,1528.0371 707.8906,1528.0371 L708.1563,1528.0371 L708.1563,1521.3809 L707.8906,1521.3809 Q707.2656,1521.3809 707,1521.1465 Q706.75,1520.9121 706.75,1520.5215 Q706.75,1520.1465 707,1519.9121 Q707.2656,1519.6777 707.8906,1519.6777 L715.5156,1519.6777 L715.5156,1522.2715 Q715.5156,1522.8809 715.2813,1523.1465 Q715.0625,1523.3965 714.6719,1523.3965 Q714.2969,1523.3965 714.0625,1523.1465 Q713.8281,1522.8809 713.8281,1522.2715 L713.8281,1521.3809 L709.8594,1521.3809 L709.8594,1523.834 L711.3438,1523.834 Q711.3438,1523.1777 711.4688,1522.9902 Q711.7344,1522.584 712.2031,1522.584 Q712.5781,1522.584 712.8125,1522.8496 Q713.0469,1523.0996 713.0469,1523.709 L713.0469,1525.6777 Q713.0469,1526.2246 712.9219,1526.4121 Q712.6563,1526.8027 712.2031,1526.8027 Q711.7344,1526.8027 711.4688,1526.3965 Q711.3438,1526.209 711.3438,1525.5371 L709.8594,1525.5371 Z " fill="#000000"/><ellipse cx="730" cy="1524.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="736" y="1530.5371">ProductType</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="697" x2="819" y1="1540.7402" y2="1540.7402"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="702" y="1559.8477">SAM_C1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="702" y="1578.4688">HSM_C1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="702" y="1597.0898">SAM_S1E1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="702" y="1615.7109">SAM_S1Dx</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="702" y="1634.332">UNKNOWN</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="697" x2="819" y1="1641.8457" y2="1641.8457"/></g><!--MD5=[143ba7b87fc22423fbb915ca39582ad3]
class LSRevocationServiceSpi--><g id="elem_LSRevocationServiceSpi"><rect codeLine="224" fill="#FEFECE" height="85.2422" id="LSRevocationServiceSpi" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="422" x="4530" y="1954.7402"/><ellipse cx="4654.75" cy="1970.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4655.7031,1967.3809 L4655.7031,1974.0371 L4657.4219,1974.0371 Q4658.0313,1974.0371 4658.2969,1974.2715 Q4658.5625,1974.5059 4658.5625,1974.8965 Q4658.5625,1975.2715 4658.2969,1975.5059 Q4658.0313,1975.7402 4657.4219,1975.7402 L4652.2813,1975.7402 Q4651.6719,1975.7402 4651.4063,1975.5059 Q4651.1406,1975.2715 4651.1406,1974.8809 Q4651.1406,1974.5059 4651.4063,1974.2715 Q4651.6719,1974.0371 4652.2813,1974.0371 L4654,1974.0371 L4654,1967.3809 L4652.2813,1967.3809 Q4651.6719,1967.3809 4651.4063,1967.1465 Q4651.1406,1966.9121 4651.1406,1966.5215 Q4651.1406,1966.1465 4651.4063,1965.9121 Q4651.6719,1965.6777 4652.2813,1965.6777 L4657.4219,1965.6777 Q4658.0313,1965.6777 4658.2969,1965.9121 Q4658.5625,1966.1465 4658.5625,1966.5215 Q4658.5625,1966.9121 4658.2969,1967.1465 Q4658.0313,1967.3809 4657.4219,1967.3809 L4655.7031,1967.3809 Z " fill="#000000"/><ellipse cx="4680.25" cy="1970.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="153" x="4686.25" y="1976.5371">LSRevocationServiceSpi</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="4531" x2="4951" y1="1986.7402" y2="1986.7402"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="4531" x2="4951" y1="1994.7402" y2="1994.7402"/><ellipse cx="4541" cy="2009.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="285" x="4550" y="2013.8477">boolean isSamRevoked (byte[] serialNumber)</text><ellipse cx="4541" cy="2028.1719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="396" x="4550" y="2032.4688">boolean isSamRevoked (byte[] serialNumber, int counterValue)</text></g><!--MD5=[63fd54f7c9b46614b09480616643cf25]
reverse link LSTransactionManager to LSReadTransactionManager--><g id="link_LSTransactionManager_LSReadTransactionManager"><path d="M1850,389.3802 C1850,445.9202 1850,538.9302 1850,622.5702 " fill="none" id="LSTransactionManager-backto-LSReadTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="1843,389.2402,1850,369.2402,1857,389.2402,1843,389.2402" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[af9b32e0f7bd13fe8692e8b64f8d572e]
reverse link LSTransactionManager to LSFreeWriteTransactionManager--><g id="link_LSTransactionManager_LSFreeWriteTransactionManager"><path d="M2033.97,373.1902 C2184.92,403.1002 2398.68,445.4602 2556.26,476.6802 " fill="none" id="LSTransactionManager-backto-LSFreeWriteTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="2032.28,379.9902,2014.03,369.2402,2035.01,366.2602,2032.28,379.9902" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[ef8617be79de069639a45c865418ecda]
reverse link LSFreeWriteTransactionManager to LSWriteTransactionManager--><g id="link_LSFreeWriteTransactionManager_LSWriteTransactionManager"><path d="M2766,582.0302 C2766,615.7002 2766,658.3102 2766,697.2002 " fill="none" id="LSFreeWriteTransactionManager-backto-LSWriteTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="2759,581.8402,2766,561.8402,2773,581.8402,2759,581.8402" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[17fcc30a5ac9ced31ee01efe13055675]
reverse link LSReadTransactionManager to LSSecureReadTransactionManager--><g id="link_LSReadTransactionManager_LSSecureReadTransactionManager"><path d="M1840.83,1007.8902 C1836.95,1093.2702 1832.9,1182.3522 1831.05,1223.2392 " fill="none" id="LSReadTransactionManager-backto-LSSecureReadTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="1833.85,1007.4102,1841.75,987.7502,1847.83,1008.0402,1833.85,1007.4102" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[f340f083da64058f1dd1b9a32f16c98c]
reverse link LSReadTransactionManager to LSFreeTransactionManager--><g id="link_LSReadTransactionManager_LSFreeTransactionManager"><path d="M2197.74,972.0502 C2214.9,977.8202 2232.04,983.1002 2249,987.7402 C2564.61,1074.1402 2667.29,973.6702 2981,1066.7402 C3088.35,1098.5902 3202.05,1162.3292 3270.79,1204.6422 " fill="none" id="LSReadTransactionManager-backto-LSFreeTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="2195.35,978.6302,2178.74,965.4702,2199.93,965.4002,2195.35,978.6302" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[55a240a236034ce01bb8e70bd298f4ea]
reverse link LSFreeWriteTransactionManager to LSFreeTransactionManager--><g id="link_LSFreeWriteTransactionManager_LSFreeTransactionManager"><path d="M3154.16,566.3402 C3212.75,580.5702 3260.76,598.9902 3282,622.7402 C3431.74,790.1502 3374.18,1093.8302 3346.5,1204.4782 " fill="none" id="LSFreeWriteTransactionManager-backto-LSFreeTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="3152.26,573.0902,3134.35,561.7702,3155.41,559.4502,3152.26,573.0902" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[381448ec740053844d9045b67b6ba944]
reverse link LSWriteTransactionManager to LSSecureWriteTransactionManager--><g id="link_LSWriteTransactionManager_LSSecureWriteTransactionManager"><path d="M2783.89,933.2302 C2798.26,1035.1502 2817.22,1169.7092 2824.73,1223.0402 " fill="none" id="LSWriteTransactionManager-backto-LSSecureWriteTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="2776.95,934.0902,2781.09,913.3102,2790.81,932.1402,2776.95,934.0902" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[7263ea7c75544349369471ffc64d4f11]
reverse link LSTransactionManager to LSTargetSamAsyncTransactionManager--><g id="link_LSTransactionManager_LSTargetSamAsyncTransactionManager"><path d="M1772.96,379.6802 C1693.21,428.2202 1571.09,514.7202 1504,622.7402 C1380.19,822.0802 1360.61,1116.3902 1357.55,1213.6952 " fill="none" id="LSTransactionManager-backto-LSTargetSamAsyncTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="1769.53,373.5802,1790.29,369.3302,1776.71,385.6002,1769.53,373.5802" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[3ce207a2fe63b2263eab379af1bd7510]
reverse link LSWriteTransactionManager to LSControlSamAsyncTransactionManager--><g id="link_LSWriteTransactionManager_LSControlSamAsyncTransactionManager"><path d="M2645.48,927.5902 C2553.73,1019.9702 2432.91,1141.6142 2370.42,1204.5332 " fill="none" id="LSWriteTransactionManager-backto-LSControlSamAsyncTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="2640.6,922.5702,2659.66,913.3102,2650.53,932.4402,2640.6,922.5702" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[007eb89bfb10701b962958f5b6fc0ebb]
reverse link CommonSignatureComputationData to BasicSignatureComputationData--><g id="link_CommonSignatureComputationData_BasicSignatureComputationData"><path d="M3044.34,1668.8202 C3030.64,1704.8602 3015.92,1743.5762 3006.84,1767.4812 " fill="none" id="CommonSignatureComputationData-backto-BasicSignatureComputationData" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="3037.93,1665.9582,3051.58,1649.7492,3051.02,1670.9312,3037.93,1665.9582" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[f429252bb447dd4a1aa4e00c09503393]
reverse link CommonSignatureComputationData to TraceableSignatureComputationData--><g id="link_CommonSignatureComputationData_TraceableSignatureComputationData"><path d="M2865.73,1656.5522 C2824.09,1671.3412 2780.71,1686.6242 2740,1700.7402 C2711.81,1710.5162 2681.89,1720.7432 2652.67,1730.6522 " fill="none" id="CommonSignatureComputationData-backto-TraceableSignatureComputationData" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="2863.53,1649.9032,2884.72,1649.7972,2868.22,1663.0942,2863.53,1649.9032" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[e2b6e3fe5a6a0a5bd0ef8dd67224f7af]
reverse link CommonSignatureVerificationData to BasicSignatureVerificationData--><g id="link_CommonSignatureVerificationData_BasicSignatureVerificationData"><path d="M3613.49,1647.9332 C3550.05,1673.4572 3477.56,1703.0232 3412,1730.7402 C3383.83,1742.6482 3352.6,1756.3882 3327.18,1767.7122 " fill="none" id="CommonSignatureVerificationData-backto-BasicSignatureVerificationData" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="3611.26,1641.2832,3632.43,1640.3232,3616.48,1654.2742,3611.26,1641.2832" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[e31b41de38b178ddac6d238f38182a2b]
reverse link CommonSignatureVerificationData to TraceableSignatureVerificationData--><g id="link_CommonSignatureVerificationData_TraceableSignatureVerificationData"><path d="M3840.63,1656.6582 C3863.73,1687.8232 3889.53,1722.6442 3909.06,1748.9882 " fill="none" id="CommonSignatureVerificationData-backto-TraceableSignatureVerificationData" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="3834.78,1660.5152,3828.49,1640.2792,3846.03,1652.1802,3834.78,1660.5152" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[dd8fb90f82e0dd888d786f767bc1c163]
reverse link LSSecureReadTransactionManager to LSTransactionManagerFactory--><g id="link_LSSecureReadTransactionManager_LSTransactionManagerFactory"><path codeLine="233" d="M1808.63,1275.5732 C1769.04,1326.2102 1683.18,1436.0392 1626.5,1508.5312 " fill="none" id="LSSecureReadTransactionManager-backto-LSTransactionManagerFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="1811.86,1271.4452,1803.1674,1276.0754,1808.782,1275.3855,1809.4718,1281.0002,1811.86,1271.4452" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="1671.0796,1463.4467,1663.1932,1468.7624,1667.8239,1472.3826,1671.0796,1463.4467" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="1677" y="1472.7686">provide</text></g><!--MD5=[2a02477713cff388b525a5a991624f04]
reverse link LSFreeTransactionManager to LSTransactionManagerFactory--><g id="link_LSFreeTransactionManager_LSTransactionManagerFactory"><path codeLine="234" d="M3265.14,1292.5392 C3195.8,1334.3232 3085.11,1395.2532 2981,1427.7402 C2827.28,1475.7082 2782.58,1464.6162 2622,1476.7402 C2504.32,1485.6252 2208.46,1473.3512 2091,1484.7402 C2033.02,1490.3612 1971.8,1498.9642 1912.54,1508.7192 " fill="none" id="LSFreeTransactionManager-backto-LSTransactionManagerFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="3269.65,1289.8152,3259.8785,1291.0469,3265.3708,1292.4014,3264.0163,1297.8937,3269.65,1289.8152" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="2869.9373,1466.5966,2860.5418,1465.1221,2861.4694,1470.9262,2869.9373,1466.5966" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="2874" y="1472.7686">provide</text></g><!--MD5=[961160f94dbb8b9891aa054e698125d7]
reverse link LSSecureWriteTransactionManager to LSTransactionManagerFactory--><g id="link_LSSecureWriteTransactionManager_LSTransactionManagerFactory"><path codeLine="235" d="M2813.45,1275.9302 C2790.16,1317.0922 2740.29,1393.2612 2674,1427.7402 C2558.51,1487.8042 2219.94,1466.8522 2091,1484.7402 C2041.01,1491.6752 1988.48,1499.9592 1936.83,1508.6892 " fill="none" id="LSSecureWriteTransactionManager-backto-LSTransactionManagerFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="2816.02,1271.3322,2808.1393,1277.2394,2813.582,1275.6976,2815.1238,1281.1402,2816.02,1271.3322" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="2568.8326,1466.1026,2559.3362,1465.5833,2560.8446,1471.2643,2568.8326,1466.1026" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="2573" y="1472.7686">provide</text></g><!--MD5=[fa66c54033d0a4c6bc406f04de051d31]
reverse link LSControlSamAsyncTransactionManager to LSTransactionManagerFactory--><g id="link_LSControlSamAsyncTransactionManager_LSTransactionManagerFactory"><path codeLine="236" d="M2250.91,1292.3992 C2181.68,1330.6632 2077.24,1386.2442 1983,1427.7402 C1917.28,1456.6792 1844.08,1484.7602 1777.87,1508.6742 " fill="none" id="LSControlSamAsyncTransactionManager-backto-LSTransactionManagerFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="2255.42,1289.9052,2245.6075,1290.7508,2251.0422,1292.3207,2249.4722,1297.7553,2255.42,1289.9052" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="1915.5473,1465.3067,1906.0992,1466.3949,1908.5432,1471.7405,1915.5473,1465.3067" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="1920" y="1472.7686">provide</text></g><!--MD5=[bc70f8c992dcc342bd1f39f239b5e964]
reverse link LSTargetSamAsyncTransactionManager to LSTransactionManagerFactory--><g id="link_LSTargetSamAsyncTransactionManager_LSTransactionManagerFactory"><path codeLine="237" d="M1381.09,1285.2222 C1416.26,1339.1922 1482.27,1440.5082 1526.69,1508.6872 " fill="none" id="LSTargetSamAsyncTransactionManager-backto-LSTransactionManagerFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="1378.2,1280.7852,1379.7639,1290.5091,1380.9305,1284.9739,1386.4657,1286.1404,1378.2,1280.7852" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="1505.2705,1463.1965,1507.7459,1472.3793,1512.6706,1469.1705,1505.2705,1463.1965" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="1517" y="1472.7686">provide</text></g><!--MD5=[ebab009eacecfb898c15b865f6c4b1df]
reverse link LegacySam to LSTransactionManagerFactory--><g id="link_LegacySam_LSTransactionManagerFactory"><path codeLine="238" d="M978.187,1393.4972 C997.76,1406.0852 1017.89,1417.7922 1038,1427.7402 C1104.58,1460.6822 1179.52,1487.4352 1251.72,1508.7392 " fill="none" id="LegacySam-backto-LSTransactionManagerFactory" style="stroke:#27AE60;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="973.755,1390.6262,979.133,1398.8771,977.9512,1393.3451,983.4832,1392.1633,973.755,1390.6262" style="stroke:#27AE60;stroke-width:2.0;"/><polygon fill="#000000" points="1150.3922,1465.4445,1157.5867,1471.6646,1159.8688,1466.2479,1150.3922,1465.4445" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="1164" y="1472.7686">use</text></g><!--MD5=[008e1125f66b2dbf24dbc8edf912a63f]
link LSTransactionManagerFactory to LSSecuritySetting--><g id="link_LSTransactionManagerFactory_LSSecuritySetting"><path codeLine="239" d="M1572,1649.7492 C1572,1684.1342 1572,1724.2942 1572,1752.9372 " fill="none" id="LSTransactionManagerFactory-to-LSSecuritySetting" style="stroke:#27AE60;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="1572,1758.1482,1576,1749.1482,1572,1753.1482,1568,1749.1482,1572,1758.1482" style="stroke:#27AE60;stroke-width:2.0;"/><polygon fill="#000000" points="1577,1696.3857,1579.9389,1687.3407,1574.0611,1687.3407,1577,1696.3857" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="1586" y="1696.7686">use</text></g><!--MD5=[19d6493dd5f2d1d16ef41b540dc0d9c7]
reverse link BasicSignatureComputationData to LSCommandDataFactory--><g id="link_BasicSignatureComputationData_LSCommandDataFactory"><path codeLine="241" d="M3016.83,1820.3042 C3037,1849.8302 3069.63,1897.6102 3095.81,1935.9322 " fill="none" id="BasicSignatureComputationData-backto-LSCommandDataFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="3013.95,1816.0842,3015.7232,1825.7721,3016.7701,1820.213,3022.3293,1821.2599,3013.95,1816.0842" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="3074.1798,1888.257,3076.8547,1897.3836,3081.7084,1894.0683,3074.1798,1888.257" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="3086" y="1897.7686">provide</text></g><!--MD5=[c12a463ae7d817b37c5021eb1f87fd2b]
reverse link TraceableSignatureComputationData to LSCommandDataFactory--><g id="link_TraceableSignatureComputationData_LSCommandDataFactory"><path codeLine="242" d="M2674.75,1854.2842 C2733.23,1872.1462 2797.17,1891.6982 2856,1909.7402 C2883.82,1918.2702 2913.18,1927.2902 2942.01,1936.1592 " fill="none" id="TraceableSignatureComputationData-backto-LSCommandDataFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="2669.84,1852.7822,2677.283,1859.2321,2674.6228,1854.2398,2679.6152,1851.5796,2669.84,1852.7822" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="2825.2193,1890.9212,2833.0068,1896.3806,2834.7285,1890.7606,2825.2193,1890.9212" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="2839" y="1897.7686">provide</text></g><!--MD5=[8629aa9b30ca8fbb723c215c04750434]
reverse link BasicSignatureVerificationData to LSCommandDataFactory--><g id="link_BasicSignatureVerificationData_LSCommandDataFactory"><path codeLine="243" d="M3257.17,1820.3042 C3237,1849.8302 3204.37,1897.6102 3178.19,1935.9322 " fill="none" id="BasicSignatureVerificationData-backto-LSCommandDataFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="3260.05,1816.0842,3251.6707,1821.2599,3257.2299,1820.213,3258.2768,1825.7721,3260.05,1816.0842" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="3218.8202,1888.257,3211.2916,1894.0683,3216.1453,1897.3836,3218.8202,1888.257" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="3225" y="1897.7686">provide</text></g><!--MD5=[484ff2cc459388cf34a5812035119dfc]
reverse link TraceableSignatureVerificationData to LSCommandDataFactory--><g id="link_TraceableSignatureVerificationData_LSCommandDataFactory"><path codeLine="244" d="M3770.93,1835.5862 C3655.63,1864.8062 3501.32,1903.9122 3373.82,1936.2252 " fill="none" id="TraceableSignatureVerificationData-backto-LSCommandDataFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="3776.05,1834.2892,3766.3431,1832.6231,3771.2033,1835.5177,3768.3086,1840.3779,3776.05,1834.2892" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="3572.8468,1891.1574,3563.3569,1890.5306,3564.8009,1896.2283,3572.8468,1891.1574" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="3577" y="1897.7686">provide</text></g><!--MD5=[aee98434b273ec5f11c1ae4cc5e498a1]
link TraceableSignatureVerificationData to LSRevocationServiceSpi--><g id="link_TraceableSignatureVerificationData_LSRevocationServiceSpi"><path codeLine="246" d="M4145.83,1834.2422 C4243.35,1854.9962 4361.18,1881.6522 4466,1909.7402 C4513.93,1922.5822 4565.97,1938.4502 4611.76,1953.0752 " fill="none" id="TraceableSignatureVerificationData-to-LSRevocationServiceSpi" style="stroke:#27AE60;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="4616.74,1954.6682,4609.3934,1948.1087,4611.9793,1953.1399,4606.9481,1955.7258,4616.74,1954.6682" style="stroke:#27AE60;stroke-width:2.0;"/><polygon fill="#000000" points="4432.8449,1893.6214,4424.8067,1888.5383,4423.3541,1894.2338,4432.8449,1893.6214" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="4437" y="1897.7686">use</text></g><!--MD5=[358f77b57db24066b4f375866947927c]
reverse link LSSecuritySetting to LSSecuritySettingFactory--><g id="link_LSSecuritySetting_LSSecuritySettingFactory"><path codeLine="248" d="M1572,1830.4622 C1572,1868.7182 1572,1927.3152 1572,1963.6252 " fill="none" id="LSSecuritySetting-backto-LSSecuritySettingFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="1572,1825.4362,1568,1834.4362,1572,1830.4362,1576,1834.4362,1572,1825.4362" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="1577,1887.3857,1574.0611,1896.4308,1579.9389,1896.4308,1577,1887.3857" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="1586" y="1897.7686">provide</text></g><!--MD5=[323a1c19e70a2d7de2ebe504b83281d9]
link LSFreeTransactionManager to CommonSignatureComputationData--><g id="link_LSFreeTransactionManager_CommonSignatureComputationData"><path codeLine="250" d="M3302.45,1290.0352 C3260.55,1343.8322 3187.04,1438.2282 3135.6,1504.2832 " fill="none" id="LSFreeTransactionManager-to-CommonSignatureComputationData" style="stroke:#27AE60;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="3132.24,1508.5932,3140.9274,1503.9533,3135.3136,1504.6495,3134.6174,1499.0356,3132.24,1508.5932" style="stroke:#27AE60;stroke-width:2.0;"/><polygon fill="#000000" points="3170.9279,1471.3306,3178.8041,1466,3174.1667,1462.3885,3170.9279,1471.3306" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="3183" y="1472.7686">use</text></g><!--MD5=[d6367acd2875a1b90318e664a4424035]
link LSFreeTransactionManager to CommonSignatureVerificationData--><g id="link_LSFreeTransactionManager_CommonSignatureVerificationData"><path codeLine="251" d="M3391.87,1290.0352 C3469.1,1346.8012 3607.84,1448.7682 3697.88,1514.9472 " fill="none" id="LSFreeTransactionManager-to-CommonSignatureVerificationData" style="stroke:#27AE60;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="3702.13,1518.0712,3697.2418,1509.5211,3698.0993,1515.1126,3692.5079,1515.9701,3702.13,1518.0712" style="stroke:#27AE60;stroke-width:2.0;"/><polygon fill="#000000" points="3648.0289,1470.3469,3642.4811,1462.622,3639.0001,1467.3582,3648.0289,1470.3469" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="3653" y="1472.7686">use</text></g><!--MD5=[e063832b949fda6e34354851cd5212ec]
link LSCardTransactionCryptoExtensionFactory to LSCardTransactionCryptoExtension--><g id="link_LSCardTransactionCryptoExtensionFactory_LSCardTransactionCryptoExtension"><path codeLine="253" d="M4089,838.9502 C4089,914.0102 4089,1099.2502 4089,1191.7932 " fill="none" id="LSCardTransactionCryptoExtensionFactory-to-LSCardTransactionCryptoExtension" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="4089,1196.9412,4093,1187.9412,4089,1191.9412,4085,1187.9412,4089,1196.9412" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="4094,1032.3857,4096.9389,1023.3407,4091.0611,1023.3407,4094,1032.3857" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="4103" y="1032.7686">provide</text></g><!--MD5=[9281cc80dfe2497074e0686d46a044bd]
link LSCardTransactionCryptoExtension to CommonSignatureComputationData--><g id="link_LSCardTransactionCryptoExtension_CommonSignatureComputationData"><path codeLine="255" d="M3992.51,1297.3172 C3912.49,1336.5732 3794.92,1390.9502 3688,1427.7402 C3655.13,1439.0512 3503.71,1476.4212 3359.98,1511.0902 " fill="none" id="LSCardTransactionCryptoExtension-to-CommonSignatureComputationData" style="stroke:#27AE60;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="3354.87,1512.3222,3364.5567,1514.102,3359.7308,1511.1506,3362.6821,1506.3247,3354.87,1512.3222" style="stroke:#27AE60;stroke-width:2.0;"/><polygon fill="#000000" points="3573.2632,1468.9866,3582.7731,1468.8748,3580.8912,1463.3064,3573.2632,1468.9866" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="3587" y="1472.7686">use</text></g><!--MD5=[c007916489683d73e585d8e6e8f013f6]
link LSCardTransactionCryptoExtension to CommonSignatureVerificationData--><g id="link_LSCardTransactionCryptoExtension_CommonSignatureVerificationData"><path codeLine="256" d="M4043.67,1297.2882 C3990.38,1354.9412 3901.8,1450.7842 3843.15,1514.2392 " fill="none" id="LSCardTransactionCryptoExtension-to-CommonSignatureVerificationData" style="stroke:#27AE60;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="3839.68,1517.9922,3848.7268,1514.0991,3843.0742,1514.3208,3842.8525,1508.6683,3839.68,1517.9922" style="stroke:#27AE60;stroke-width:2.0;"/><polygon fill="#000000" points="3892.6062,1471.0576,3900.9039,1466.41,3896.5873,1462.4204,3892.6062,1471.0576" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="3905" y="1472.7686">use</text></g><!--MD5=[e7decd56807e41ed7039f231043065c8]
link LegacySamSelectionFactory to LegacySamSelection--><g id="link_LegacySamSelectionFactory_LegacySamSelection"><path codeLine="258" d="M318,838.9502 C318,909.1902 318,1075.9302 318,1172.8842 " fill="none" id="LegacySamSelectionFactory-to-LegacySamSelection" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="318,1178.0212,322,1169.0212,318,1173.0212,314,1169.0212,318,1178.0212" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="323,1032.3857,325.9389,1023.3407,320.0611,1023.3407,323,1032.3857" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="332" y="1032.7686">provide</text></g><!--MD5=[d1441bb54ec12ef55a7fa9dacfe2aecf]
link LegacySamSelection to SamProductType--><g id="link_LegacySamSelection_SamProductType"><path codeLine="260" d="M408.901,1316.4162 C493.036,1379.5172 616.152,1471.8542 691.462,1528.3372 " fill="none" id="LegacySamSelection-to-SamProductType" style="stroke:#27AE60;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="695.905,1531.6692,691.105,1523.0692,691.905,1528.6692,686.305,1529.4692,695.905,1531.6692" style="stroke:#27AE60;stroke-width:2.0;"/><polygon fill="#000000" points="625,1470.3857,619.5273,1462.6075,616.0006,1467.3098,625,1470.3857" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="630" y="1472.7686">use</text></g><!--MD5=[3c9b475e2700f2e5f333b2777b638756]
reverse link LegacySam to SamProductType--><g id="link_LegacySam_SamProductType"><path codeLine="262" d="M764.673,1442.9982 C764.076,1447.9572 763.516,1452.8772 763,1457.7402 C761.253,1474.1892 760.108,1491.9612 759.36,1508.6732 " fill="none" id="LegacySam-backto-SamProductType" style="stroke:#181818;stroke-width:2.0;"/><ellipse cx="765.5638" cy="1435.96" fill="#FFFFFF" rx="8" ry="8" style="stroke:#181818;stroke-width:2.0;"/><line style="stroke:#181818;stroke-width:2.0;" x1="764.5596" x2="766.568" y1="1443.8967" y2="1428.0232"/><line style="stroke:#181818;stroke-width:2.0;" x1="757.6271" x2="773.5005" y1="1434.9558" y2="1436.9641"/></g><!--MD5=[5ecd342ac4874d804146f75452da1973]
link LegacySam to SamProductType--><g id="link_LegacySam_SamProductType"><path codeLine="263" d="M776.64,1428.2072 C773.348,1454.7082 770.12,1480.6902 767.3,1503.3882 " fill="none" id="LegacySam-to-SamProductType" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="766.667,1508.4802,771.7473,1500.0428,767.2842,1503.5185,763.8085,1499.0553,766.667,1508.4802" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="777.3836,1472.3476,781.4152,1463.7338,775.5822,1463.0092,777.3836,1472.3476" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="787" y="1472.7686">provide</text></g><!--MD5=[e557832eb8f5aeb9df1282adefe4d318]
@startuml
title
    Calypsonet - calypsonet-terminal-calypso-crypto-legacysam-java-api - 0.1.+ (2022-12-12)
end title

' == THEME ==

'Couleurs issues de : https://htmlcolorcodes.com/fr/tableau-de-couleur/tableau-de-couleur-design-plat/
!define C_GREY1 F8F9F9
!define C_GREY2 F2F3F4
!define C_GREY3 E5E7E9
!define C_GREY4 D7DBDD
!define C_GREY5 CACFD2
!define C_GREY6 BDC3C7
!define C_LINK 3498DB
!define C_USE 27AE60

' - - Styles that don't work with new version of plantuml - -
skinparam stereotypeABorderColor #A9DCDF
skinparam stereotypeIBorderColor #B4A7E5
skinparam stereotypeCBorderColor #ADD1B2
skinparam stereotypeEBorderColor #EB93DF
' - - END - -

skinparam ClassBorderThickness 2
skinparam ArrowThickness 2

' Yellow
skinparam ClassBackgroundColor #FEFECE
skinparam ClassBorderColor #D4AC0D
' Red
skinparam ClassBackgroundColor<<red>> #FDEDEC
skinparam ClassBorderColor<<red>> #E74C3C
hide <<red>> stereotype
' Purple
skinparam ClassBackgroundColor<<purple>> #F4ECF7
skinparam ClassBorderColor<<purple>> #8E44AD
hide <<purple>> stereotype
' blue
skinparam ClassBackgroundColor<<blue>> #EBF5FB
skinparam ClassBorderColor<<blue>> #3498DB
hide <<blue>> stereotype
' Green
skinparam ClassBackgroundColor<<green>> #E9F7EF
skinparam ClassBorderColor<<green>> #27AE60
hide <<green>> stereotype
' Grey
skinparam ClassBackgroundColor<<grey>> #EAECEE
skinparam ClassBorderColor<<grey>> #2C3E50
hide <<grey>> stereotype

' == CONTENT ==

legend top
    __Colors legend__ :
    ** <color:grey>**Work in progress...**</color>
    * __External public API references__ :
    ** <back:yellow>**calypsonet-terminal-reader-java-api**</back>
    ** <back:pink>**calypsonet-terminal-calypso-java-api**</back>
end legend

package "org.calypsonet.terminal.calypso.crypto.legacysam" as api {
    +class "**final** LegacySamApiProperties" as ApiProperties {
        +{static} **final** String VERSION
    }
    package transaction {
        +interface LSTransactionManagerFactory {
            +LSFreeTransactionManager createFreeTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
            +<color:grey>LSSecureReadTransactionManager createSecureReadTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam, LSSecuritySetting securitySetting)
            +<color:grey>LSSecureWriteTransactionManager createSecureWriteTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam, LSSecuritySetting securitySetting)
            +<color:grey>LSControlSamAsyncTransactionManager createControlSamAsyncTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
            +<color:grey>LSTargetSamAsyncTransactionManager createTargetSamAsyncTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
        }
        +interface LSTransactionManager<T extends LSTransactionManager<T>> {
            +T processCommands ()
        }
        +interface LSReadTransactionManager<T extends LSReadTransactionManager<T>> extends LSTransactionManager {
            +<color:grey>T prepareReadSamParameters ()

            +<color:grey>T prepareReadCaadRecord (int caadRecordNumber)
            +<color:grey>T prepareReadCaadRecords (int fromCaadRecordNumber, int toCaadRecordNumber)

            +<color:grey>T prepareReadSystemKeyParameters (LegacySystemKey systemKey)

            +<color:grey>T prepareReadWorkKeyParameter (int workKeyRecordNumber)
            +<color:grey>T prepareReadWorkKeyParameters (int fromWorkKeyRecordNumber, int toWorkKeyRecordNumber)

            +<color:grey>T prepareReadWorkKeyParameter (byte workKeyKif, byte workKeyKvc)

            +T prepareReadEventCounter (int eventCounterNumber)
            +T prepareReadEventCounters (int fromEventCounterNumber, int toEventCounterNumber)

            +T prepareReadEventCeiling (int eventCeilingNumber)
            +T prepareReadEventCeilings (int fromEventCeilingNumber, int toEventCeilingNumber)
        }
        +interface LSFreeWriteTransactionManager<T extends LSFreeWriteTransactionManager<T>> extends LSTransactionManager {
            +<color:grey>T prepareWriteExternalPlainWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters, byte[] workKeyValue)
            +<color:grey>T prepareWriteRandomlyGeneratedWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters)
        }
        +interface LSWriteTransactionManager<T extends LSWriteTransactionManager<T>> extends LSFreeWriteTransactionManager {
            +<color:grey>T prepareWriteSamParameters (byte[] parameters)
            +<color:grey>T prepareWriteCaadRecord (int caadRecordNumber, byte[] caad)

            +<color:grey>T prepareWriteTransferredCipheredSystemKey (LegacySystemKey sourceSystemKey, byte sourceSystemKeyKif, byte sourceSystemKeyKvc)
            +<color:grey>T prepareWriteTransferredPlainWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters)
            +<color:grey>T prepareWriteTransferredCipheredWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters, byte cipheringSystemKeyKvc)

            +<color:grey>T prepareWriteEventCeiling (int eventCeilingNumber, int newValue)
            +<color:grey>T prepareWriteEventCeilings (int fromEventCeilingNumber, List<Integer> newValues)
        }
        together {
            +interface LSSecureReadTransactionManager extends LSReadTransactionManager {
            }
            +interface LSFreeTransactionManager extends LSReadTransactionManager, LSFreeWriteTransactionManager {
                +LSFreeTransactionManager prepareComputeSignature (CommonSignatureComputationData<?> data)
                +LSFreeTransactionManager prepareVerifySignature (CommonSignatureVerificationData<?> data)
            }
            +interface LSSecureWriteTransactionManager extends LSWriteTransactionManager {
            }
            +interface LSTargetSamAsyncTransactionManager extends LSTransactionManager {
                +<color:grey>LSTargetSamAsyncTransactionManager importCommands (String cipheredSamCommands)
            }
            +interface LSControlSamAsyncTransactionManager extends LSWriteTransactionManager {
                +<color:grey>LSControlSamAsyncTransactionManager prepareGiveTargetSamPseudoRandom (? asyncRandom)
                +<color:grey>String exportCommands ()
            }
        }
        +interface LSSecuritySettingFactory {
            +<color:grey>LSSecuritySetting createSecuritySetting ()
        }
        +interface LSSecuritySetting {
            +<color:grey>LSSecuritySetting setControlSamResource (<back:yellow>CardReader</back> samReader, LegacySam sam)
        }
        together {
            +interface LSCardTransactionCryptoExtensionFactory {
                +<color:grey>LSCardTransactionCryptoExtensionFactory createCardTransactionCryptoExtension ()
            }
            +interface "<<<back:pink>CCTransactionCryptoExtension</back>>>\nLSCardTransactionCryptoExtension" as LSCardTransactionCryptoExtension {
                +<color:grey>LSCardTransactionCryptoExtension prepareComputeSignature (CommonSignatureComputationData<?> data)
                +<color:grey>LSCardTransactionCryptoExtension prepareVerifySignature (CommonSignatureVerificationData<?> data)
            }
        }
        together {
            +interface CommonSignatureComputationData<T extends CommonSignatureComputationData<T>> {
                +T setData (byte[] data, byte kif, byte kvc)
                +T setSignatureSize (int size)
                +T setKeyDiversifier (byte[] diversifier)

                +byte[] getSignature ()
            }
            +interface BasicSignatureComputationData extends CommonSignatureComputationData {
            }
            +interface TraceableSignatureComputationData extends CommonSignatureComputationData {
                +TraceableSignatureComputationData withSamTraceabilityMode (int offset, boolean usePartialSamSerialNumber)
                +TraceableSignatureComputationData withoutBusyMode ()

                +byte[] getSignedData ()
            }
            +interface CommonSignatureVerificationData<T extends CommonSignatureVerificationData<T>> {
                +T setData (byte[] data, byte[] signature, byte kif, byte kvc)
                +T setKeyDiversifier (byte[] diversifier)

                +boolean isSignatureValid ()
            }
            +interface BasicSignatureVerificationData extends CommonSignatureVerificationData {
            }
            +interface TraceableSignatureVerificationData extends CommonSignatureVerificationData {
                +TraceableSignatureVerificationData withSamTraceabilityMode (int offset, boolean isPartialSamSerialNumber, LSRevocationServiceSpi samRevocationService)
                +TraceableSignatureVerificationData withoutBusyMode ()
            }
            +interface LSCommandDataFactory {
                +BasicSignatureComputationData createBasicSignatureComputationData ()
                +TraceableSignatureComputationData createTraceableSignatureComputationData ()
                +BasicSignatureVerificationData createBasicSignatureVerificationData ()
                +TraceableSignatureVerificationData createTraceableSignatureVerificationData ()
            }
        }
        ' Exceptions
        +class "<<RuntimeException>>" as RuntimeException {
            +**SamRevokedException**
            +**InconsistentDataException**: Number of R-APDUs != number of C-APDUs
            +**InvalidSignatureException**
            +**UnexpectedCommandStatusException**
            +**ReaderIOException**: SAM reader communication is broken.
            +**SamIOException**
        }
    }
    package sam {
        +interface LegacySamSelectionFactory {
            +LegacySamSelection createSamSelection ()
        }
        +interface "<<<back:yellow>CardSelection</back>>>\nLegacySamSelection" as LegacySamSelection {
            +LegacySamSelection filterByProductType (LegacySam.ProductType productType)
            +LegacySamSelection filterBySerialNumber (String serialNumberRegex)

            +LegacySamSelection setUnlockData (String unlockData)
        }
        +interface "<<<back:yellow>SmartCard</back>>>\nLegacySam" as LegacySam {
            +ProductType getProductType ()
            +String getProductInfo ()

            +byte[] getSerialNumber ()
            +byte getPlatform ()
            +byte getApplicationType ()
            +byte getApplicationSubType ()
            +byte getSoftwareIssuer ()
            +byte getSoftwareVersion ()
            +byte getSoftwareRevision ()

            +Integer getEventCounter (int eventCounterNumber)
            +SortedMap<Integer, Integer> getEventCounters ()

            +Integer getEventCeiling (int eventCeilingNumber)
            +SortedMap<Integer, Integer> getEventCeilings ()
        }
        +enum "ProductType" as SamProductType {
            SAM_C1
            HSM_C1
            SAM_S1E1
            SAM_S1Dx
            UNKNOWN
        }
    }
    package spi {
        +interface LSRevocationServiceSpi {
            +boolean isSamRevoked (byte[] serialNumber)
            +boolean isSamRevoked (byte[] serialNumber, int counterValue)
        }
    }
}

' Associations

LSTransactionManagerFactory .up.> LSSecureReadTransactionManager #C_LINK : provide >
LSTransactionManagerFactory .up.> LSFreeTransactionManager #C_LINK : provide >
LSTransactionManagerFactory .up.> LSSecureWriteTransactionManager #C_LINK : provide >
LSTransactionManagerFactory .up.> LSControlSamAsyncTransactionManager #C_LINK : provide >
LSTransactionManagerFactory .up.> LSTargetSamAsyncTransactionManager #C_LINK : provide >
LSTransactionManagerFactory .up.> LegacySam #C_USE : use >
LSTransactionManagerFactory ..> LSSecuritySetting #C_USE : use >

LSCommandDataFactory .up.> BasicSignatureComputationData #C_LINK : provide >
LSCommandDataFactory .up.> TraceableSignatureComputationData #C_LINK : provide >
LSCommandDataFactory .up.> BasicSignatureVerificationData #C_LINK : provide >
LSCommandDataFactory .up.> TraceableSignatureVerificationData #C_LINK : provide >

TraceableSignatureVerificationData ..> LSRevocationServiceSpi #C_USE : use >

LSSecuritySettingFactory .up.> LSSecuritySetting #C_LINK : provide >

LSFreeTransactionManager ..> CommonSignatureComputationData #C_USE : use >
LSFreeTransactionManager ..> CommonSignatureVerificationData #C_USE : use >

LSCardTransactionCryptoExtensionFactory ..> LSCardTransactionCryptoExtension #C_LINK : provide >

LSCardTransactionCryptoExtension ..> CommonSignatureComputationData #C_USE : use >
LSCardTransactionCryptoExtension ..> CommonSignatureVerificationData #C_USE : use >

LegacySamSelectionFactory ..> LegacySamSelection #C_LINK : provide >

LegacySamSelection ..> SamProductType #C_USE : use >

LegacySam +- - SamProductType
LegacySam ..> SamProductType #C_LINK : provide >

' == LAYOUT ==

'SamProductType .[hidden]. LSRevocationServiceSpi

' == STYLE ==

package api #C_GREY1 {}
package spi #C_GREY2 {}
package sam #C_GREY2 {}
package transaction #C_GREY2 {}

interface LSTransactionManager <<blue>>
interface LSFreeTransactionManager <<blue>>
interface LSFreeWriteTransactionManager <<blue>>
interface LSReadTransactionManager <<blue>>
interface LSWriteTransactionManager <<blue>>
interface LSSecureReadTransactionManager <<blue>>
interface LSSecureWriteTransactionManager <<blue>>
interface LSControlSamAsyncTransactionManager <<blue>>
interface LSTargetSamAsyncTransactionManager <<blue>>

interface LegacySamSelectionFactory <<red>>
interface LSTransactionManagerFactory <<red>>
interface LSCardTransactionCryptoExtensionFactory <<red>>
interface LSCommandDataFactory <<red>>
interface LSSecuritySettingFactory <<red>>

interface LSCardTransactionCryptoExtension <<green>>

interface LegacySamSelection <<green>>

@enduml

@startuml
title
    Calypsonet - calypsonet-terminal-calypso-crypto-legacysam-java-api - 0.1.+ (2022-12-12)
end title



skinparam stereotypeABorderColor #A9DCDF
skinparam stereotypeIBorderColor #B4A7E5
skinparam stereotypeCBorderColor #ADD1B2
skinparam stereotypeEBorderColor #EB93DF

skinparam ClassBorderThickness 2
skinparam ArrowThickness 2

skinparam ClassBackgroundColor #FEFECE
skinparam ClassBorderColor #D4AC0D
skinparam ClassBackgroundColor<<red>> #FDEDEC
skinparam ClassBorderColor<<red>> #E74C3C
hide <<red>> stereotype
skinparam ClassBackgroundColor<<purple>> #F4ECF7
skinparam ClassBorderColor<<purple>> #8E44AD
hide <<purple>> stereotype
skinparam ClassBackgroundColor<<blue>> #EBF5FB
skinparam ClassBorderColor<<blue>> #3498DB
hide <<blue>> stereotype
skinparam ClassBackgroundColor<<green>> #E9F7EF
skinparam ClassBorderColor<<green>> #27AE60
hide <<green>> stereotype
skinparam ClassBackgroundColor<<grey>> #EAECEE
skinparam ClassBorderColor<<grey>> #2C3E50
hide <<grey>> stereotype


legend top
    __Colors legend__ :
    ** <color:grey>**Work in progress...**</color>
    * __External public API references__ :
    ** <back:yellow>**calypsonet-terminal-reader-java-api**</back>
    ** <back:pink>**calypsonet-terminal-calypso-java-api**</back>
end legend

package "org.calypsonet.terminal.calypso.crypto.legacysam" as api {
    +class "**final** LegacySamApiProperties" as ApiProperties {
        +{static} **final** String VERSION
    }
    package transaction {
        +interface LSTransactionManagerFactory {
            +LSFreeTransactionManager createFreeTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
            +<color:grey>LSSecureReadTransactionManager createSecureReadTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam, LSSecuritySetting securitySetting)
            +<color:grey>LSSecureWriteTransactionManager createSecureWriteTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam, LSSecuritySetting securitySetting)
            +<color:grey>LSControlSamAsyncTransactionManager createControlSamAsyncTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
            +<color:grey>LSTargetSamAsyncTransactionManager createTargetSamAsyncTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
        }
        +interface LSTransactionManager<T extends LSTransactionManager<T>> {
            +T processCommands ()
        }
        +interface LSReadTransactionManager<T extends LSReadTransactionManager<T>> extends LSTransactionManager {
            +<color:grey>T prepareReadSamParameters ()

            +<color:grey>T prepareReadCaadRecord (int caadRecordNumber)
            +<color:grey>T prepareReadCaadRecords (int fromCaadRecordNumber, int toCaadRecordNumber)

            +<color:grey>T prepareReadSystemKeyParameters (LegacySystemKey systemKey)

            +<color:grey>T prepareReadWorkKeyParameter (int workKeyRecordNumber)
            +<color:grey>T prepareReadWorkKeyParameters (int fromWorkKeyRecordNumber, int toWorkKeyRecordNumber)

            +<color:grey>T prepareReadWorkKeyParameter (byte workKeyKif, byte workKeyKvc)

            +T prepareReadEventCounter (int eventCounterNumber)
            +T prepareReadEventCounters (int fromEventCounterNumber, int toEventCounterNumber)

            +T prepareReadEventCeiling (int eventCeilingNumber)
            +T prepareReadEventCeilings (int fromEventCeilingNumber, int toEventCeilingNumber)
        }
        +interface LSFreeWriteTransactionManager<T extends LSFreeWriteTransactionManager<T>> extends LSTransactionManager {
            +<color:grey>T prepareWriteExternalPlainWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters, byte[] workKeyValue)
            +<color:grey>T prepareWriteRandomlyGeneratedWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters)
        }
        +interface LSWriteTransactionManager<T extends LSWriteTransactionManager<T>> extends LSFreeWriteTransactionManager {
            +<color:grey>T prepareWriteSamParameters (byte[] parameters)
            +<color:grey>T prepareWriteCaadRecord (int caadRecordNumber, byte[] caad)

            +<color:grey>T prepareWriteTransferredCipheredSystemKey (LegacySystemKey sourceSystemKey, byte sourceSystemKeyKif, byte sourceSystemKeyKvc)
            +<color:grey>T prepareWriteTransferredPlainWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters)
            +<color:grey>T prepareWriteTransferredCipheredWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters, byte cipheringSystemKeyKvc)

            +<color:grey>T prepareWriteEventCeiling (int eventCeilingNumber, int newValue)
            +<color:grey>T prepareWriteEventCeilings (int fromEventCeilingNumber, List<Integer> newValues)
        }
        together {
            +interface LSSecureReadTransactionManager extends LSReadTransactionManager {
            }
            +interface LSFreeTransactionManager extends LSReadTransactionManager, LSFreeWriteTransactionManager {
                +LSFreeTransactionManager prepareComputeSignature (CommonSignatureComputationData<?> data)
                +LSFreeTransactionManager prepareVerifySignature (CommonSignatureVerificationData<?> data)
            }
            +interface LSSecureWriteTransactionManager extends LSWriteTransactionManager {
            }
            +interface LSTargetSamAsyncTransactionManager extends LSTransactionManager {
                +<color:grey>LSTargetSamAsyncTransactionManager importCommands (String cipheredSamCommands)
            }
            +interface LSControlSamAsyncTransactionManager extends LSWriteTransactionManager {
                +<color:grey>LSControlSamAsyncTransactionManager prepareGiveTargetSamPseudoRandom (? asyncRandom)
                +<color:grey>String exportCommands ()
            }
        }
        +interface LSSecuritySettingFactory {
            +<color:grey>LSSecuritySetting createSecuritySetting ()
        }
        +interface LSSecuritySetting {
            +<color:grey>LSSecuritySetting setControlSamResource (<back:yellow>CardReader</back> samReader, LegacySam sam)
        }
        together {
            +interface LSCardTransactionCryptoExtensionFactory {
                +<color:grey>LSCardTransactionCryptoExtensionFactory createCardTransactionCryptoExtension ()
            }
            +interface "<<<back:pink>CCTransactionCryptoExtension</back>>>\nLSCardTransactionCryptoExtension" as LSCardTransactionCryptoExtension {
                +<color:grey>LSCardTransactionCryptoExtension prepareComputeSignature (CommonSignatureComputationData<?> data)
                +<color:grey>LSCardTransactionCryptoExtension prepareVerifySignature (CommonSignatureVerificationData<?> data)
            }
        }
        together {
            +interface CommonSignatureComputationData<T extends CommonSignatureComputationData<T>> {
                +T setData (byte[] data, byte kif, byte kvc)
                +T setSignatureSize (int size)
                +T setKeyDiversifier (byte[] diversifier)

                +byte[] getSignature ()
            }
            +interface BasicSignatureComputationData extends CommonSignatureComputationData {
            }
            +interface TraceableSignatureComputationData extends CommonSignatureComputationData {
                +TraceableSignatureComputationData withSamTraceabilityMode (int offset, boolean usePartialSamSerialNumber)
                +TraceableSignatureComputationData withoutBusyMode ()

                +byte[] getSignedData ()
            }
            +interface CommonSignatureVerificationData<T extends CommonSignatureVerificationData<T>> {
                +T setData (byte[] data, byte[] signature, byte kif, byte kvc)
                +T setKeyDiversifier (byte[] diversifier)

                +boolean isSignatureValid ()
            }
            +interface BasicSignatureVerificationData extends CommonSignatureVerificationData {
            }
            +interface TraceableSignatureVerificationData extends CommonSignatureVerificationData {
                +TraceableSignatureVerificationData withSamTraceabilityMode (int offset, boolean isPartialSamSerialNumber, LSRevocationServiceSpi samRevocationService)
                +TraceableSignatureVerificationData withoutBusyMode ()
            }
            +interface LSCommandDataFactory {
                +BasicSignatureComputationData createBasicSignatureComputationData ()
                +TraceableSignatureComputationData createTraceableSignatureComputationData ()
                +BasicSignatureVerificationData createBasicSignatureVerificationData ()
                +TraceableSignatureVerificationData createTraceableSignatureVerificationData ()
            }
        }
        +class "<<RuntimeException>>" as RuntimeException {
            +**SamRevokedException**
            +**InconsistentDataException**: Number of R-APDUs != number of C-APDUs
            +**InvalidSignatureException**
            +**UnexpectedCommandStatusException**
            +**ReaderIOException**: SAM reader communication is broken.
            +**SamIOException**
        }
    }
    package sam {
        +interface LegacySamSelectionFactory {
            +LegacySamSelection createSamSelection ()
        }
        +interface "<<<back:yellow>CardSelection</back>>>\nLegacySamSelection" as LegacySamSelection {
            +LegacySamSelection filterByProductType (LegacySam.ProductType productType)
            +LegacySamSelection filterBySerialNumber (String serialNumberRegex)

            +LegacySamSelection setUnlockData (String unlockData)
        }
        +interface "<<<back:yellow>SmartCard</back>>>\nLegacySam" as LegacySam {
            +ProductType getProductType ()
            +String getProductInfo ()

            +byte[] getSerialNumber ()
            +byte getPlatform ()
            +byte getApplicationType ()
            +byte getApplicationSubType ()
            +byte getSoftwareIssuer ()
            +byte getSoftwareVersion ()
            +byte getSoftwareRevision ()

            +Integer getEventCounter (int eventCounterNumber)
            +SortedMap<Integer, Integer> getEventCounters ()

            +Integer getEventCeiling (int eventCeilingNumber)
            +SortedMap<Integer, Integer> getEventCeilings ()
        }
        +enum "ProductType" as SamProductType {
            SAM_C1
            HSM_C1
            SAM_S1E1
            SAM_S1Dx
            UNKNOWN
        }
    }
    package spi {
        +interface LSRevocationServiceSpi {
            +boolean isSamRevoked (byte[] serialNumber)
            +boolean isSamRevoked (byte[] serialNumber, int counterValue)
        }
    }
}


LSTransactionManagerFactory .up.> LSSecureReadTransactionManager #3498DB : provide >
LSTransactionManagerFactory .up.> LSFreeTransactionManager #3498DB : provide >
LSTransactionManagerFactory .up.> LSSecureWriteTransactionManager #3498DB : provide >
LSTransactionManagerFactory .up.> LSControlSamAsyncTransactionManager #3498DB : provide >
LSTransactionManagerFactory .up.> LSTargetSamAsyncTransactionManager #3498DB : provide >
LSTransactionManagerFactory .up.> LegacySam #27AE60 : use >
LSTransactionManagerFactory ..> LSSecuritySetting #27AE60 : use >

LSCommandDataFactory .up.> BasicSignatureComputationData #3498DB : provide >
LSCommandDataFactory .up.> TraceableSignatureComputationData #3498DB : provide >
LSCommandDataFactory .up.> BasicSignatureVerificationData #3498DB : provide >
LSCommandDataFactory .up.> TraceableSignatureVerificationData #3498DB : provide >

TraceableSignatureVerificationData ..> LSRevocationServiceSpi #27AE60 : use >

LSSecuritySettingFactory .up.> LSSecuritySetting #3498DB : provide >

LSFreeTransactionManager ..> CommonSignatureComputationData #27AE60 : use >
LSFreeTransactionManager ..> CommonSignatureVerificationData #27AE60 : use >

LSCardTransactionCryptoExtensionFactory ..> LSCardTransactionCryptoExtension #3498DB : provide >

LSCardTransactionCryptoExtension ..> CommonSignatureComputationData #27AE60 : use >
LSCardTransactionCryptoExtension ..> CommonSignatureVerificationData #27AE60 : use >

LegacySamSelectionFactory ..> LegacySamSelection #3498DB : provide >

LegacySamSelection ..> SamProductType #27AE60 : use >

LegacySam +- - SamProductType
LegacySam ..> SamProductType #3498DB : provide >




package api #F8F9F9 {}
package spi #F2F3F4 {}
package sam #F2F3F4 {}
package transaction #F2F3F4 {}

interface LSTransactionManager <<blue>>
interface LSFreeTransactionManager <<blue>>
interface LSFreeWriteTransactionManager <<blue>>
interface LSReadTransactionManager <<blue>>
interface LSWriteTransactionManager <<blue>>
interface LSSecureReadTransactionManager <<blue>>
interface LSSecureWriteTransactionManager <<blue>>
interface LSControlSamAsyncTransactionManager <<blue>>
interface LSTargetSamAsyncTransactionManager <<blue>>

interface LegacySamSelectionFactory <<red>>
interface LSTransactionManagerFactory <<red>>
interface LSCardTransactionCryptoExtensionFactory <<red>>
interface LSCommandDataFactory <<red>>
interface LSSecuritySettingFactory <<red>>

interface LSCardTransactionCryptoExtension <<green>>

interface LegacySamSelection <<green>>

@enduml

PlantUML version 1.2022.13(Sat Nov 19 14:22:17 CET 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: fr
Country: FR
--></g></svg>