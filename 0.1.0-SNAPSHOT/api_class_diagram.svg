<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2129px" preserveAspectRatio="none" style="width:5283px;height:2129px;background:#FFFFFF;" version="1.1" viewBox="0 0 5283 2129" width="5283px" zoomAndPan="magnify"><defs><filter height="1" id="bmmos2p3brkef0" width="1" x="0" y="0"><feFlood flood-color="#FFFF00" result="flood"/><feComposite in="SourceGraphic" in2="flood" operator="over"/></filter><filter height="1" id="bmmos2p3brkef1" width="1" x="0" y="0"><feFlood flood-color="#FFC0CB" result="flood"/><feComposite in="SourceGraphic" in2="flood" operator="over"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="607" x="2331" y="25.1074">Calypsonet - calypsonet-terminal-calypso-crypto-legacysam-java-api - 0.1.+ (2022-12-05)</text><rect fill="#DDDDDD" height="103.1055" id="_legend" rx="7.5" ry="7.5" style="stroke:#000000;stroke-width:1.0;" width="282" x="2493.5" y="51.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="88" x="2498.5" y="71.7285">Colors legend</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2590.5" y="71.7285">:</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="2507.5" y="83.8633"/><text fill="#808080" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="133" x="2514.5" y="90.3496">Work in progress...</text><ellipse cx="2504" cy="104.9844" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="189" x="2510.5" y="108.9707">External public API references</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2703.5" y="108.9707">:</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="2507.5" y="121.1055"/><text fill="#000000" filter="url(#bmmos2p3brkef0)" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="250" x="2514.5" y="127.5918">calypsonet-terminal-reader-java-api</text><rect fill="#000000" height="3.5" style="stroke:#000000;stroke-width:0.0;" width="3.5" x="2507.5" y="139.7266"/><text fill="#000000" filter="url(#bmmos2p3brkef1)" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="256" x="2514.5" y="146.2129">calypsonet-terminal-calypso-java-api</text><!--MD5=[7442f3b126ee602ae02566c1a49e158a]
cluster api--><g id="cluster_api"><path d="M8.5,173.7402 L356.5,173.7402 A3.75,3.75 0 0 1 359,176.2402 L366,198.3613 L5273.5,198.3613 A2.5,2.5 0 0 1 5276,200.8613 L5276,2119.7402 A2.5,2.5 0 0 1 5273.5,2122.2402 L8.5,2122.2402 A2.5,2.5 0 0 1 6,2119.7402 L6,176.2402 A2.5,2.5 0 0 1 8.5,173.7402 " fill="#F8F9F9" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="6" x2="366" y1="198.3613" y2="198.3613"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="347" x="10" y="190.8477">org.calypsonet.terminal.calypso.crypto.legacysam</text></g><!--MD5=[f9c58d90839a0c7c212d8c6553ac9eb7]
cluster transaction--><g id="cluster_transaction"><path d="M1016.5,218.7402 L1096.5,218.7402 A3.75,3.75 0 0 1 1099,221.2402 L1106,243.3613 L4771.5,243.3613 A2.5,2.5 0 0 1 4774,245.8613 L4774,2095.7402 A2.5,2.5 0 0 1 4771.5,2098.2402 L1016.5,2098.2402 A2.5,2.5 0 0 1 1014,2095.7402 L1014,221.2402 A2.5,2.5 0 0 1 1016.5,218.7402 " fill="#F2F3F4" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="1014" x2="1106" y1="243.3613" y2="243.3613"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="79" x="1018" y="235.8477">transaction</text></g><!--MD5=[98d4fa74a8fc0b7c744d347d810a7562]
cluster sam--><g id="cluster_sam"><path d="M32.5,734.7402 L61.5,734.7402 A3.75,3.75 0 0 1 64,737.2402 L71,759.3613 L987.5,759.3613 A2.5,2.5 0 0 1 990,761.8613 L990,1663.2402 A2.5,2.5 0 0 1 987.5,1665.7402 L32.5,1665.7402 A2.5,2.5 0 0 1 30,1663.2402 L30,737.2402 A2.5,2.5 0 0 1 32.5,734.7402 " fill="#F2F3F4" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="30" x2="71" y1="759.3613" y2="759.3613"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="28" x="34" y="751.8477">sam</text></g><!--MD5=[f7e0e2453c87923036c1ac2adfb9cbf0]
cluster spi--><g id="cluster_spi"><path d="M4800.5,1917.7402 L4822.5,1917.7402 A3.75,3.75 0 0 1 4825,1920.2402 L4832,1942.3613 L5249.5,1942.3613 A2.5,2.5 0 0 1 5252,1944.8613 L5252,2053.2402 A2.5,2.5 0 0 1 5249.5,2055.7402 L4800.5,2055.7402 A2.5,2.5 0 0 1 4798,2053.2402 L4798,1920.2402 A2.5,2.5 0 0 1 4800.5,1917.7402 " fill="#F2F3F4" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="4798" x2="4832" y1="1942.3613" y2="1942.3613"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="21" x="4802" y="1934.8477">spi</text></g><!--MD5=[120218adfd8782b0057db0a1b8294250]
class ApiProperties--><g id="elem_ApiProperties"><rect codeLine="62" fill="#FEFECE" height="66.6211" id="ApiProperties" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="236" x="392" y="302.2402"/><ellipse cx="407" cy="318.2402" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M409.7656,314.1152 Q409.9219,313.8965 410.1094,313.7871 Q410.2969,313.6777 410.5156,313.6777 Q410.8906,313.6777 411.125,313.9434 Q411.3594,314.1934 411.3594,314.8027 L411.3594,316.2559 Q411.3594,316.8652 411.125,317.1309 Q410.8906,317.3965 410.5156,317.3965 Q410.1719,317.3965 409.9688,317.1934 Q409.7656,317.0059 409.6563,316.4902 Q409.6094,316.1309 409.4219,315.9434 Q409.0938,315.5684 408.4844,315.3496 Q407.875,315.1309 407.25,315.1309 Q406.4844,315.1309 405.8438,315.459 Q405.2188,315.7871 404.7188,316.5371 Q404.2344,317.2871 404.2344,318.3184 L404.2344,319.4121 Q404.2344,320.6465 405.125,321.4746 Q406.0156,322.2871 407.6094,322.2871 Q408.5469,322.2871 409.2031,322.0371 Q409.5938,321.8809 410.0156,321.4434 Q410.2813,321.1777 410.4219,321.0996 Q410.5781,321.0215 410.7813,321.0215 Q411.1094,321.0215 411.3594,321.2871 Q411.625,321.5371 411.625,321.8809 Q411.625,322.2246 411.2813,322.6309 Q410.7813,323.209 409.9844,323.5371 Q408.9063,323.9902 407.6094,323.9902 Q406.0938,323.9902 404.8906,323.3652 Q403.9063,322.8652 403.2188,321.8027 Q402.5313,320.7246 402.5313,319.4434 L402.5313,318.2871 Q402.5313,316.959 403.1406,315.8184 Q403.7656,314.6621 404.8594,314.0527 Q405.9531,313.4277 407.1875,313.4277 Q407.9219,313.4277 408.5625,313.5996 Q409.2188,313.7559 409.7656,314.1152 Z " fill="#000000"/><ellipse cx="426" cy="317.7402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="30" x="432" y="324.0371">final</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="159" x="466" y="324.0371">LegacySamApiProperties</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="393" x2="627" y1="334.2402" y2="334.2402"/><ellipse cx="403" cy="349.0508" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" text-decoration="underline" textLength="30" x="412" y="353.3477">final</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="101" x="446" y="353.3477">String VERSION</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="393" x2="627" y1="360.8613" y2="360.8613"/></g><!--MD5=[3dfe6076040c9abfebce4121b80cdb8d]
class LegacySamTransactionManagerFactory--><g id="elem_LegacySamTransactionManagerFactory"><rect codeLine="287" fill="#FDEDEC" height="141.1055" id="LegacySamTransactionManagerFactory" rx="2.5" ry="2.5" style="stroke:#E74C3C;stroke-width:2.0;" width="1119" x="1181.5" y="1508.7402"/><ellipse cx="1604.25" cy="1524.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1605.2031,1521.3809 L1605.2031,1528.0371 L1606.9219,1528.0371 Q1607.5313,1528.0371 1607.7969,1528.2715 Q1608.0625,1528.5059 1608.0625,1528.8965 Q1608.0625,1529.2715 1607.7969,1529.5059 Q1607.5313,1529.7402 1606.9219,1529.7402 L1601.7813,1529.7402 Q1601.1719,1529.7402 1600.9063,1529.5059 Q1600.6406,1529.2715 1600.6406,1528.8809 Q1600.6406,1528.5059 1600.9063,1528.2715 Q1601.1719,1528.0371 1601.7813,1528.0371 L1603.5,1528.0371 L1603.5,1521.3809 L1601.7813,1521.3809 Q1601.1719,1521.3809 1600.9063,1521.1465 Q1600.6406,1520.9121 1600.6406,1520.5215 Q1600.6406,1520.1465 1600.9063,1519.9121 Q1601.1719,1519.6777 1601.7813,1519.6777 L1606.9219,1519.6777 Q1607.5313,1519.6777 1607.7969,1519.9121 Q1608.0625,1520.1465 1608.0625,1520.5215 Q1608.0625,1520.9121 1607.7969,1521.1465 Q1607.5313,1521.3809 1606.9219,1521.3809 L1605.2031,1521.3809 Z " fill="#000000"/><ellipse cx="1629.75" cy="1524.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="254" x="1635.75" y="1530.5371">LegacySamTransactionManagerFactory</text><line style="stroke:#E74C3C;stroke-width:2.0;" x1="1182.5" x2="2299.5" y1="1540.7402" y2="1540.7402"/><line style="stroke:#E74C3C;stroke-width:2.0;" x1="1182.5" x2="2299.5" y1="1548.7402" y2="1548.7402"/><ellipse cx="1192.5" cy="1563.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="449" x="1201.5" y="1567.8477">LegacySamFreeTransactionManager createFreeTransactionManager (</text><text fill="#000000" filter="url(#bmmos2p3brkef0)" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="1650.5" y="1567.8477">CardReader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="190" x="1732.5" y="1567.8477">samReader, LegacySam sam)</text><ellipse cx="1192.5" cy="1582.1719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="547" x="1201.5" y="1586.4688">LegacySamSecureReadTransactionManager createSecureReadTransactionManager (</text><text fill="#808080" filter="url(#bmmos2p3brkef0)" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="1748.5" y="1586.4688">CardReader</text><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="464" x="1830.5" y="1586.4688">samReader, LegacySam sam, LegacySamSecuritySetting securitySetting)</text><ellipse cx="1192.5" cy="1600.793" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="545" x="1201.5" y="1605.0898">LegacySamSecureWriteTransactionManager createSecureWriteTransactionManager (</text><text fill="#808080" filter="url(#bmmos2p3brkef0)" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="1746.5" y="1605.0898">CardReader</text><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="464" x="1828.5" y="1605.0898">samReader, LegacySam sam, LegacySamSecuritySetting securitySetting)</text><ellipse cx="1192.5" cy="1619.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="585" x="1201.5" y="1623.7109">LegacyControlSamAsyncTransactionManager createControlSamAsyncTransactionManager (</text><text fill="#808080" filter="url(#bmmos2p3brkef0)" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="1786.5" y="1623.7109">CardReader</text><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="190" x="1868.5" y="1623.7109">samReader, LegacySam sam)</text><ellipse cx="1192.5" cy="1638.0352" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="577" x="1201.5" y="1642.332">LegacyTargetSamAsyncTransactionManager createTargetSamAsyncTransactionManager (</text><text fill="#808080" filter="url(#bmmos2p3brkef0)" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="1778.5" y="1642.332">CardReader</text><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="190" x="1860.5" y="1642.332">samReader, LegacySam sam)</text></g><!--MD5=[0ca469eb9daf2ada2044bbaaac3ba003]
class LegacySamTransactionManager--><g id="elem_LegacySamTransactionManager"><rect codeLine="276" fill="#EBF5FB" height="66.6211" id="LegacySamTransactionManager" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:2.0;" width="508" x="1675" y="302.2402"/><ellipse cx="1690" cy="318.2402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1690.9531,314.8809 L1690.9531,321.5371 L1692.6719,321.5371 Q1693.2813,321.5371 1693.5469,321.7715 Q1693.8125,322.0059 1693.8125,322.3965 Q1693.8125,322.7715 1693.5469,323.0059 Q1693.2813,323.2402 1692.6719,323.2402 L1687.5313,323.2402 Q1686.9219,323.2402 1686.6563,323.0059 Q1686.3906,322.7715 1686.3906,322.3809 Q1686.3906,322.0059 1686.6563,321.7715 Q1686.9219,321.5371 1687.5313,321.5371 L1689.25,321.5371 L1689.25,314.8809 L1687.5313,314.8809 Q1686.9219,314.8809 1686.6563,314.6465 Q1686.3906,314.4121 1686.3906,314.0215 Q1686.3906,313.6465 1686.6563,313.4121 Q1686.9219,313.1777 1687.5313,313.1777 L1692.6719,313.1777 Q1693.2813,313.1777 1693.5469,313.4121 Q1693.8125,313.6465 1693.8125,314.0215 Q1693.8125,314.4121 1693.5469,314.6465 Q1693.2813,314.8809 1692.6719,314.8809 L1690.9531,314.8809 Z " fill="#000000"/><ellipse cx="1709" cy="317.7402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="206" x="1715" y="324.0371">LegacySamTransactionManager</text><rect fill="#FFFFFF" height="17.9609" style="stroke:#3498DB;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="257" x="1929" y="299.2402"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="255" x="1930" y="313.1895">T extends LegacySamTransactionManager&lt;T&gt;</text><line style="stroke:#3498DB;stroke-width:2.0;" x1="1676" x2="2182" y1="334.2402" y2="334.2402"/><line style="stroke:#3498DB;stroke-width:2.0;" x1="1676" x2="2182" y1="342.2402" y2="342.2402"/><ellipse cx="1686" cy="357.0508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="148" x="1695" y="361.3477">T processCommands ()</text></g><!--MD5=[8560ba9595df2db95e6096dd1b62c14e]
class LegacySamReadTransactionManager--><g id="elem_LegacySamReadTransactionManager"><rect codeLine="279" fill="#EBF5FB" height="364.5586" id="LegacySamReadTransactionManager" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:2.0;" width="657" x="1600.5" y="622.7402"/><ellipse cx="1654.75" cy="638.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1655.7031,635.3809 L1655.7031,642.0371 L1657.4219,642.0371 Q1658.0313,642.0371 1658.2969,642.2715 Q1658.5625,642.5059 1658.5625,642.8965 Q1658.5625,643.2715 1658.2969,643.5059 Q1658.0313,643.7402 1657.4219,643.7402 L1652.2813,643.7402 Q1651.6719,643.7402 1651.4063,643.5059 Q1651.1406,643.2715 1651.1406,642.8809 Q1651.1406,642.5059 1651.4063,642.2715 Q1651.6719,642.0371 1652.2813,642.0371 L1654,642.0371 L1654,635.3809 L1652.2813,635.3809 Q1651.6719,635.3809 1651.4063,635.1465 Q1651.1406,634.9121 1651.1406,634.5215 Q1651.1406,634.1465 1651.4063,633.9121 Q1651.6719,633.6777 1652.2813,633.6777 L1657.4219,633.6777 Q1658.0313,633.6777 1658.2969,633.9121 Q1658.5625,634.1465 1658.5625,634.5215 Q1658.5625,634.9121 1658.2969,635.1465 Q1658.0313,635.3809 1657.4219,635.3809 L1655.7031,635.3809 Z " fill="#000000"/><ellipse cx="1680.25" cy="638.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="240" x="1686.25" y="644.5371">LegacySamReadTransactionManager</text><rect fill="#FFFFFF" height="17.9609" style="stroke:#3498DB;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="287" x="1973.5" y="619.7402"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="285" x="1974.5" y="633.6895">T extends LegacySamReadTransactionManager&lt;T&gt;</text><line style="stroke:#3498DB;stroke-width:2.0;" x1="1601.5" x2="2256.5" y1="654.7402" y2="654.7402"/><line style="stroke:#3498DB;stroke-width:2.0;" x1="1601.5" x2="2256.5" y1="662.7402" y2="662.7402"/><ellipse cx="1611.5" cy="677.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="212" x="1620.5" y="681.8477">T prepareReadSamParameters ()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1620.5" y="700.4688"> </text><ellipse cx="1611.5" cy="714.793" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="336" x="1620.5" y="719.0898">T prepareReadCaadRecord (int caadRecordNumber)</text><ellipse cx="1611.5" cy="733.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="542" x="1620.5" y="737.7109">T prepareReadCaadRecords (int fromCaadRecordNumber, int toCaadRecordNumber)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1620.5" y="756.332"> </text><ellipse cx="1611.5" cy="770.6563" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="442" x="1620.5" y="774.9531">T prepareReadSystemKeyParameters (LegacySystemKey systemKey)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1620.5" y="793.5742"> </text><ellipse cx="1611.5" cy="807.8984" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="401" x="1620.5" y="812.1953">T prepareReadWorkKeyParameter (int workKeyRecordNumber)</text><ellipse cx="1611.5" cy="826.5195" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="631" x="1620.5" y="830.8164">T prepareReadWorkKeyParameters (int fromWorkKeyRecordNumber, int toWorkKeyRecordNumber)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1620.5" y="849.4375"> </text><ellipse cx="1611.5" cy="863.7617" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="449" x="1620.5" y="868.0586">T prepareReadWorkKeyParameter (byte workKeyKif, byte workKeyKvc)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1620.5" y="886.6797"> </text><ellipse cx="1611.5" cy="901.0039" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="352" x="1620.5" y="905.3008">T prepareReadEventCounter (int eventCounterNumber)</text><ellipse cx="1611.5" cy="919.625" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="563" x="1620.5" y="923.9219">T prepareReadEventCounters (int fromEventCounterNumber, int toEventCounterNumber)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1620.5" y="942.543"> </text><ellipse cx="1611.5" cy="956.8672" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="336" x="1620.5" y="961.1641">T prepareReadEventCeiling (int eventCeilingNumber)</text><ellipse cx="1611.5" cy="975.4883" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="539" x="1620.5" y="979.7852">T prepareReadEventCeilings (int fromEventCeilingNumber, int toEventCeilingNumber)</text></g><!--MD5=[155746c58e5d7251cb5fc63eeff736cd]
class LegacySamFreeWriteTransactionManager--><g id="elem_LegacySamFreeWriteTransactionManager"><rect codeLine="278" fill="#EBF5FB" height="85.2422" id="LegacySamFreeWriteTransactionManager" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:2.0;" width="799" x="2502.5" y="476.7402"/><ellipse cx="2601.25" cy="492.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2602.2031,489.3809 L2602.2031,496.0371 L2603.9219,496.0371 Q2604.5313,496.0371 2604.7969,496.2715 Q2605.0625,496.5059 2605.0625,496.8965 Q2605.0625,497.2715 2604.7969,497.5059 Q2604.5313,497.7402 2603.9219,497.7402 L2598.7813,497.7402 Q2598.1719,497.7402 2597.9063,497.5059 Q2597.6406,497.2715 2597.6406,496.8809 Q2597.6406,496.5059 2597.9063,496.2715 Q2598.1719,496.0371 2598.7813,496.0371 L2600.5,496.0371 L2600.5,489.3809 L2598.7813,489.3809 Q2598.1719,489.3809 2597.9063,489.1465 Q2597.6406,488.9121 2597.6406,488.5215 Q2597.6406,488.1465 2597.9063,487.9121 Q2598.1719,487.6777 2598.7813,487.6777 L2603.9219,487.6777 Q2604.5313,487.6777 2604.7969,487.9121 Q2605.0625,488.1465 2605.0625,488.5215 Q2605.0625,488.9121 2604.7969,489.1465 Q2604.5313,489.3809 2603.9219,489.3809 L2602.2031,489.3809 Z " fill="#000000"/><ellipse cx="2626.75" cy="492.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="270" x="2632.75" y="498.5371">LegacySamFreeWriteTransactionManager</text><rect fill="#FFFFFF" height="17.9609" style="stroke:#3498DB;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="310" x="2994.5" y="473.7402"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="308" x="2995.5" y="487.6895">T extends LegacySamFreeWriteTransactionManager&lt;T&gt;</text><line style="stroke:#3498DB;stroke-width:2.0;" x1="2503.5" x2="3300.5" y1="508.7402" y2="508.7402"/><line style="stroke:#3498DB;stroke-width:2.0;" x1="2503.5" x2="3300.5" y1="516.7402" y2="516.7402"/><ellipse cx="2513.5" cy="531.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="773" x="2522.5" y="535.8477">T prepareWriteExternalPlainWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters, byte[] workKeyValue)</text><ellipse cx="2513.5" cy="550.1719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="686" x="2522.5" y="554.4688">T prepareWriteRandomlyGeneratedWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters)</text></g><!--MD5=[289fd8b2248dd9124bc1cfda0abe149c]
class LegacySamWriteTransactionManager--><g id="elem_LegacySamWriteTransactionManager"><rect codeLine="280" fill="#EBF5FB" height="215.5898" id="LegacySamWriteTransactionManager" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:2.0;" width="998" x="2403" y="697.2402"/><ellipse cx="2628.75" cy="713.2402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2629.7031,709.8809 L2629.7031,716.5371 L2631.4219,716.5371 Q2632.0313,716.5371 2632.2969,716.7715 Q2632.5625,717.0059 2632.5625,717.3965 Q2632.5625,717.7715 2632.2969,718.0059 Q2632.0313,718.2402 2631.4219,718.2402 L2626.2813,718.2402 Q2625.6719,718.2402 2625.4063,718.0059 Q2625.1406,717.7715 2625.1406,717.3809 Q2625.1406,717.0059 2625.4063,716.7715 Q2625.6719,716.5371 2626.2813,716.5371 L2628,716.5371 L2628,709.8809 L2626.2813,709.8809 Q2625.6719,709.8809 2625.4063,709.6465 Q2625.1406,709.4121 2625.1406,709.0215 Q2625.1406,708.6465 2625.4063,708.4121 Q2625.6719,708.1777 2626.2813,708.1777 L2631.4219,708.1777 Q2632.0313,708.1777 2632.2969,708.4121 Q2632.5625,708.6465 2632.5625,709.0215 Q2632.5625,709.4121 2632.2969,709.6465 Q2632.0313,709.8809 2631.4219,709.8809 L2629.7031,709.8809 Z " fill="#000000"/><ellipse cx="2654.25" cy="712.7402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="240" x="2660.25" y="719.0371">LegacySamWriteTransactionManager</text><rect fill="#FFFFFF" height="17.9609" style="stroke:#3498DB;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="285" x="3119" y="694.2402"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="283" x="3120" y="708.1895">T extends LegacySamWriteTransactionManager&lt;T&gt;</text><line style="stroke:#3498DB;stroke-width:2.0;" x1="2404" x2="3400" y1="729.2402" y2="729.2402"/><line style="stroke:#3498DB;stroke-width:2.0;" x1="2404" x2="3400" y1="737.2402" y2="737.2402"/><ellipse cx="2414" cy="752.0508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="322" x="2423" y="756.3477">T prepareWriteSamParameters (byte[] parameters)</text><ellipse cx="2414" cy="770.6719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="413" x="2423" y="774.9688">T prepareWriteCaadRecord (int caadRecordNumber, byte[] caad)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2423" y="793.5898"> </text><ellipse cx="2414" cy="807.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="889" x="2423" y="812.2109">T prepareWriteTransferredCipheredSystemKey (LegacySystemKey sourceSystemKey, byte sourceSystemKeyKif, byte sourceSystemKeyKvc)</text><ellipse cx="2414" cy="826.5352" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="755" x="2423" y="830.832">T prepareWriteTransferredPlainWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters)</text><ellipse cx="2414" cy="845.1563" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="972" x="2423" y="849.4531">T prepareWriteTransferredCipheredWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters, byte cipheringSystemKeyKvc)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2423" y="868.0742"> </text><ellipse cx="2414" cy="882.3984" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="423" x="2423" y="886.6953">T prepareWriteEventCeiling (int eventCeilingNumber, int newValue)</text><ellipse cx="2414" cy="901.0195" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="533" x="2423" y="905.3164">T prepareWriteEventCeilings (int fromEventCeilingNumber, List&lt;Integer&gt; newValues)</text></g><!--MD5=[99f79a410af283d07bb019eb71d4383a]
class LegacySamSecuritySettingFactory--><g id="elem_LegacySamSecuritySettingFactory"><rect codeLine="290" fill="#FDEDEC" height="66.6211" id="LegacySamSecuritySettingFactory" rx="2.5" ry="2.5" style="stroke:#E74C3C;stroke-width:2.0;" width="348" x="1567" y="1963.7402"/><ellipse cx="1622.75" cy="1979.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1623.7031,1976.3809 L1623.7031,1983.0371 L1625.4219,1983.0371 Q1626.0313,1983.0371 1626.2969,1983.2715 Q1626.5625,1983.5059 1626.5625,1983.8965 Q1626.5625,1984.2715 1626.2969,1984.5059 Q1626.0313,1984.7402 1625.4219,1984.7402 L1620.2813,1984.7402 Q1619.6719,1984.7402 1619.4063,1984.5059 Q1619.1406,1984.2715 1619.1406,1983.8809 Q1619.1406,1983.5059 1619.4063,1983.2715 Q1619.6719,1983.0371 1620.2813,1983.0371 L1622,1983.0371 L1622,1976.3809 L1620.2813,1976.3809 Q1619.6719,1976.3809 1619.4063,1976.1465 Q1619.1406,1975.9121 1619.1406,1975.5215 Q1619.1406,1975.1465 1619.4063,1974.9121 Q1619.6719,1974.6777 1620.2813,1974.6777 L1625.4219,1974.6777 Q1626.0313,1974.6777 1626.2969,1974.9121 Q1626.5625,1975.1465 1626.5625,1975.5215 Q1626.5625,1975.9121 1626.2969,1976.1465 Q1626.0313,1976.3809 1625.4219,1976.3809 L1623.7031,1976.3809 Z " fill="#000000"/><ellipse cx="1648.25" cy="1979.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="217" x="1654.25" y="1985.5371">LegacySamSecuritySettingFactory</text><line style="stroke:#E74C3C;stroke-width:2.0;" x1="1568" x2="1914" y1="1995.7402" y2="1995.7402"/><line style="stroke:#E74C3C;stroke-width:2.0;" x1="1568" x2="1914" y1="2003.7402" y2="2003.7402"/><ellipse cx="1578" cy="2018.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="322" x="1587" y="2022.8477">LegacySamSecuritySetting createSecuritySetting ()</text></g><!--MD5=[cdba2e3b2692f0a974bd83ada5baadec]
class LegacySamSecuritySetting--><g id="elem_LegacySamSecuritySetting"><rect codeLine="130" fill="#FEFECE" height="66.6211" id="LegacySamSecuritySetting" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="634" x="1424" y="1758.2402"/><ellipse cx="1646.75" cy="1774.2402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1647.7031,1770.8809 L1647.7031,1777.5371 L1649.4219,1777.5371 Q1650.0313,1777.5371 1650.2969,1777.7715 Q1650.5625,1778.0059 1650.5625,1778.3965 Q1650.5625,1778.7715 1650.2969,1779.0059 Q1650.0313,1779.2402 1649.4219,1779.2402 L1644.2813,1779.2402 Q1643.6719,1779.2402 1643.4063,1779.0059 Q1643.1406,1778.7715 1643.1406,1778.3809 Q1643.1406,1778.0059 1643.4063,1777.7715 Q1643.6719,1777.5371 1644.2813,1777.5371 L1646,1777.5371 L1646,1770.8809 L1644.2813,1770.8809 Q1643.6719,1770.8809 1643.4063,1770.6465 Q1643.1406,1770.4121 1643.1406,1770.0215 Q1643.1406,1769.6465 1643.4063,1769.4121 Q1643.6719,1769.1777 1644.2813,1769.1777 L1649.4219,1769.1777 Q1650.0313,1769.1777 1650.2969,1769.4121 Q1650.5625,1769.6465 1650.5625,1770.0215 Q1650.5625,1770.4121 1650.2969,1770.6465 Q1650.0313,1770.8809 1649.4219,1770.8809 L1647.7031,1770.8809 Z " fill="#000000"/><ellipse cx="1672.25" cy="1773.7402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="169" x="1678.25" y="1780.0371">LegacySamSecuritySetting</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1425" x2="2057" y1="1790.2402" y2="1790.2402"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1425" x2="2057" y1="1798.2402" y2="1798.2402"/><ellipse cx="1435" cy="1813.0508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="336" x="1444" y="1817.3477">LegacySamSecuritySetting setControlSamResource (</text><text fill="#808080" filter="url(#bmmos2p3brkef0)" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="1780" y="1817.3477">CardReader</text><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="190" x="1862" y="1817.3477">samReader, LegacySam sam)</text></g><!--MD5=[5c6c7d52e42032554528404b62c1d271]
class RuntimeException--><g id="elem_RuntimeException"><rect codeLine="178" fill="#FEFECE" height="159.7266" id="RuntimeException" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="498" x="1107" y="255.7402"/><ellipse cx="1281.75" cy="271.7402" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1284.5156,267.6152 Q1284.6719,267.3965 1284.8594,267.2871 Q1285.0469,267.1777 1285.2656,267.1777 Q1285.6406,267.1777 1285.875,267.4434 Q1286.1094,267.6934 1286.1094,268.3027 L1286.1094,269.7559 Q1286.1094,270.3652 1285.875,270.6309 Q1285.6406,270.8965 1285.2656,270.8965 Q1284.9219,270.8965 1284.7188,270.6934 Q1284.5156,270.5059 1284.4063,269.9902 Q1284.3594,269.6309 1284.1719,269.4434 Q1283.8438,269.0684 1283.2344,268.8496 Q1282.625,268.6309 1282,268.6309 Q1281.2344,268.6309 1280.5938,268.959 Q1279.9688,269.2871 1279.4688,270.0371 Q1278.9844,270.7871 1278.9844,271.8184 L1278.9844,272.9121 Q1278.9844,274.1465 1279.875,274.9746 Q1280.7656,275.7871 1282.3594,275.7871 Q1283.2969,275.7871 1283.9531,275.5371 Q1284.3438,275.3809 1284.7656,274.9434 Q1285.0313,274.6777 1285.1719,274.5996 Q1285.3281,274.5215 1285.5313,274.5215 Q1285.8594,274.5215 1286.1094,274.7871 Q1286.375,275.0371 1286.375,275.3809 Q1286.375,275.7246 1286.0313,276.1309 Q1285.5313,276.709 1284.7344,277.0371 Q1283.6563,277.4902 1282.3594,277.4902 Q1280.8438,277.4902 1279.6406,276.8652 Q1278.6563,276.3652 1277.9688,275.3027 Q1277.2813,274.2246 1277.2813,272.9434 L1277.2813,271.7871 Q1277.2813,270.459 1277.8906,269.3184 Q1278.5156,268.1621 1279.6094,267.5527 Q1280.7031,266.9277 1281.9375,266.9277 Q1282.6719,266.9277 1283.3125,267.0996 Q1283.9688,267.2559 1284.5156,267.6152 Z " fill="#000000"/><ellipse cx="1307.25" cy="271.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129" x="1313.25" y="277.5371">«RuntimeException»</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1108" x2="1604" y1="287.7402" y2="287.7402"/><ellipse cx="1118" cy="302.5508" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="162" x="1127" y="306.8477">SamRevokedException</text><ellipse cx="1118" cy="321.1719" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="188" x="1127" y="325.4688">InconsistentDataException</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="284" x="1315" y="325.4688">: Number of R-APDUs != number of C-APDUs</text><ellipse cx="1118" cy="339.793" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="185" x="1127" y="344.0898">InvalidSignatureException</text><ellipse cx="1118" cy="358.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="268" x="1127" y="362.7109">UnexpectedCommandStatusException</text><ellipse cx="1118" cy="377.0352" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="136" x="1127" y="381.332">ReaderIOException</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="247" x="1263" y="381.332">: SAM reader communication is broken.</text><ellipse cx="1118" cy="395.6563" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="114" x="1127" y="399.9531">SamIOException</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1108" x2="1604" y1="407.4668" y2="407.4668"/></g><!--MD5=[3a04f400e335556ca7c4adcb3d92e310]
class LegacySamSecureReadTransactionManager--><g id="elem_LegacySamSecureReadTransactionManager"><rect codeLine="281" fill="#EBF5FB" height="48" id="LegacySamSecureReadTransactionManager" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:2.0;" width="328" x="1723" y="1223.2402"/><ellipse cx="1738" cy="1239.2402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1738.9531,1235.8809 L1738.9531,1242.5371 L1740.6719,1242.5371 Q1741.2813,1242.5371 1741.5469,1242.7715 Q1741.8125,1243.0059 1741.8125,1243.3965 Q1741.8125,1243.7715 1741.5469,1244.0059 Q1741.2813,1244.2402 1740.6719,1244.2402 L1735.5313,1244.2402 Q1734.9219,1244.2402 1734.6563,1244.0059 Q1734.3906,1243.7715 1734.3906,1243.3809 Q1734.3906,1243.0059 1734.6563,1242.7715 Q1734.9219,1242.5371 1735.5313,1242.5371 L1737.25,1242.5371 L1737.25,1235.8809 L1735.5313,1235.8809 Q1734.9219,1235.8809 1734.6563,1235.6465 Q1734.3906,1235.4121 1734.3906,1235.0215 Q1734.3906,1234.6465 1734.6563,1234.4121 Q1734.9219,1234.1777 1735.5313,1234.1777 L1740.6719,1234.1777 Q1741.2813,1234.1777 1741.5469,1234.4121 Q1741.8125,1234.6465 1741.8125,1235.0215 Q1741.8125,1235.4121 1741.5469,1235.6465 Q1741.2813,1235.8809 1740.6719,1235.8809 L1738.9531,1235.8809 Z " fill="#000000"/><ellipse cx="1757" cy="1238.7402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="285" x="1763" y="1245.0371">LegacySamSecureReadTransactionManager</text><line style="stroke:#3498DB;stroke-width:2.0;" x1="1724" x2="2050" y1="1255.2402" y2="1255.2402"/><line style="stroke:#3498DB;stroke-width:2.0;" x1="1724" x2="2050" y1="1263.2402" y2="1263.2402"/></g><!--MD5=[1628adf05aefa5de516c8137f2ec891f]
class LegacySamFreeTransactionManager--><g id="elem_LegacySamFreeTransactionManager"><rect codeLine="277" fill="#EBF5FB" height="85.2422" id="LegacySamFreeTransactionManager" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:2.0;" width="730" x="3170" y="1204.7402"/><ellipse cx="3407.25" cy="1220.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3408.2031,1217.3809 L3408.2031,1224.0371 L3409.9219,1224.0371 Q3410.5313,1224.0371 3410.7969,1224.2715 Q3411.0625,1224.5059 3411.0625,1224.8965 Q3411.0625,1225.2715 3410.7969,1225.5059 Q3410.5313,1225.7402 3409.9219,1225.7402 L3404.7813,1225.7402 Q3404.1719,1225.7402 3403.9063,1225.5059 Q3403.6406,1225.2715 3403.6406,1224.8809 Q3403.6406,1224.5059 3403.9063,1224.2715 Q3404.1719,1224.0371 3404.7813,1224.0371 L3406.5,1224.0371 L3406.5,1217.3809 L3404.7813,1217.3809 Q3404.1719,1217.3809 3403.9063,1217.1465 Q3403.6406,1216.9121 3403.6406,1216.5215 Q3403.6406,1216.1465 3403.9063,1215.9121 Q3404.1719,1215.6777 3404.7813,1215.6777 L3409.9219,1215.6777 Q3410.5313,1215.6777 3410.7969,1215.9121 Q3411.0625,1216.1465 3411.0625,1216.5215 Q3411.0625,1216.9121 3410.7969,1217.1465 Q3410.5313,1217.3809 3409.9219,1217.3809 L3408.2031,1217.3809 Z " fill="#000000"/><ellipse cx="3432.75" cy="1220.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="236" x="3438.75" y="1226.5371">LegacySamFreeTransactionManager</text><line style="stroke:#3498DB;stroke-width:2.0;" x1="3171" x2="3899" y1="1236.7402" y2="1236.7402"/><line style="stroke:#3498DB;stroke-width:2.0;" x1="3171" x2="3899" y1="1244.7402" y2="1244.7402"/><ellipse cx="3181" cy="1259.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="704" x="3190" y="1263.8477">LegacySamFreeTransactionManager prepareComputeSignature (CommonSignatureComputationData&lt;?&gt; data)</text><ellipse cx="3181" cy="1278.1719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="673" x="3190" y="1282.4688">LegacySamFreeTransactionManager prepareVerifySignature (CommonSignatureVerificationData&lt;?&gt; data)</text></g><!--MD5=[d1e88ceba10e2a9725069380c4ef5b88]
class LegacySamSecureWriteTransactionManager--><g id="elem_LegacySamSecureWriteTransactionManager"><rect codeLine="282" fill="#EBF5FB" height="48" id="LegacySamSecureWriteTransactionManager" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:2.0;" width="328" x="2807" y="1223.2402"/><ellipse cx="2822" cy="1239.2402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2822.9531,1235.8809 L2822.9531,1242.5371 L2824.6719,1242.5371 Q2825.2813,1242.5371 2825.5469,1242.7715 Q2825.8125,1243.0059 2825.8125,1243.3965 Q2825.8125,1243.7715 2825.5469,1244.0059 Q2825.2813,1244.2402 2824.6719,1244.2402 L2819.5313,1244.2402 Q2818.9219,1244.2402 2818.6563,1244.0059 Q2818.3906,1243.7715 2818.3906,1243.3809 Q2818.3906,1243.0059 2818.6563,1242.7715 Q2818.9219,1242.5371 2819.5313,1242.5371 L2821.25,1242.5371 L2821.25,1235.8809 L2819.5313,1235.8809 Q2818.9219,1235.8809 2818.6563,1235.6465 Q2818.3906,1235.4121 2818.3906,1235.0215 Q2818.3906,1234.6465 2818.6563,1234.4121 Q2818.9219,1234.1777 2819.5313,1234.1777 L2824.6719,1234.1777 Q2825.2813,1234.1777 2825.5469,1234.4121 Q2825.8125,1234.6465 2825.8125,1235.0215 Q2825.8125,1235.4121 2825.5469,1235.6465 Q2825.2813,1235.8809 2824.6719,1235.8809 L2822.9531,1235.8809 Z " fill="#000000"/><ellipse cx="2841" cy="1238.7402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="285" x="2847" y="1245.0371">LegacySamSecureWriteTransactionManager</text><line style="stroke:#3498DB;stroke-width:2.0;" x1="2808" x2="3134" y1="1255.2402" y2="1255.2402"/><line style="stroke:#3498DB;stroke-width:2.0;" x1="2808" x2="3134" y1="1263.2402" y2="1263.2402"/></g><!--MD5=[904e25234fc208011404775abfba51fe]
class LegacyTargetSamAsyncTransactionManager--><g id="elem_LegacyTargetSamAsyncTransactionManager"><rect codeLine="284" fill="#EBF5FB" height="66.6211" id="LegacyTargetSamAsyncTransactionManager" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:2.0;" width="634" x="1054" y="1213.7402"/><ellipse cx="1218.25" cy="1229.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1219.2031,1226.3809 L1219.2031,1233.0371 L1220.9219,1233.0371 Q1221.5313,1233.0371 1221.7969,1233.2715 Q1222.0625,1233.5059 1222.0625,1233.8965 Q1222.0625,1234.2715 1221.7969,1234.5059 Q1221.5313,1234.7402 1220.9219,1234.7402 L1215.7813,1234.7402 Q1215.1719,1234.7402 1214.9063,1234.5059 Q1214.6406,1234.2715 1214.6406,1233.8809 Q1214.6406,1233.5059 1214.9063,1233.2715 Q1215.1719,1233.0371 1215.7813,1233.0371 L1217.5,1233.0371 L1217.5,1226.3809 L1215.7813,1226.3809 Q1215.1719,1226.3809 1214.9063,1226.1465 Q1214.6406,1225.9121 1214.6406,1225.5215 Q1214.6406,1225.1465 1214.9063,1224.9121 Q1215.1719,1224.6777 1215.7813,1224.6777 L1220.9219,1224.6777 Q1221.5313,1224.6777 1221.7969,1224.9121 Q1222.0625,1225.1465 1222.0625,1225.5215 Q1222.0625,1225.9121 1221.7969,1226.1465 Q1221.5313,1226.3809 1220.9219,1226.3809 L1219.2031,1226.3809 Z " fill="#000000"/><ellipse cx="1243.75" cy="1229.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="286" x="1249.75" y="1235.5371">LegacyTargetSamAsyncTransactionManager</text><line style="stroke:#3498DB;stroke-width:2.0;" x1="1055" x2="1687" y1="1245.7402" y2="1245.7402"/><line style="stroke:#3498DB;stroke-width:2.0;" x1="1055" x2="1687" y1="1253.7402" y2="1253.7402"/><ellipse cx="1065" cy="1268.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="608" x="1074" y="1272.8477">LegacyTargetSamAsyncTransactionManager importCommands (String cipheredSamCommands)</text></g><!--MD5=[e84cd48f86a8568123bff806a5851c6a]
class LegacyControlSamAsyncTransactionManager--><g id="elem_LegacyControlSamAsyncTransactionManager"><rect codeLine="283" fill="#EBF5FB" height="85.2422" id="LegacyControlSamAsyncTransactionManager" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:2.0;" width="685" x="2086.5" y="1204.7402"/><ellipse cx="2274.25" cy="1220.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2275.2031,1217.3809 L2275.2031,1224.0371 L2276.9219,1224.0371 Q2277.5313,1224.0371 2277.7969,1224.2715 Q2278.0625,1224.5059 2278.0625,1224.8965 Q2278.0625,1225.2715 2277.7969,1225.5059 Q2277.5313,1225.7402 2276.9219,1225.7402 L2271.7813,1225.7402 Q2271.1719,1225.7402 2270.9063,1225.5059 Q2270.6406,1225.2715 2270.6406,1224.8809 Q2270.6406,1224.5059 2270.9063,1224.2715 Q2271.1719,1224.0371 2271.7813,1224.0371 L2273.5,1224.0371 L2273.5,1217.3809 L2271.7813,1217.3809 Q2271.1719,1217.3809 2270.9063,1217.1465 Q2270.6406,1216.9121 2270.6406,1216.5215 Q2270.6406,1216.1465 2270.9063,1215.9121 Q2271.1719,1215.6777 2271.7813,1215.6777 L2276.9219,1215.6777 Q2277.5313,1215.6777 2277.7969,1215.9121 Q2278.0625,1216.1465 2278.0625,1216.5215 Q2278.0625,1216.9121 2277.7969,1217.1465 Q2277.5313,1217.3809 2276.9219,1217.3809 L2275.2031,1217.3809 Z " fill="#000000"/><ellipse cx="2299.75" cy="1220.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="290" x="2305.75" y="1226.5371">LegacyControlSamAsyncTransactionManager</text><line style="stroke:#3498DB;stroke-width:2.0;" x1="2087.5" x2="2770.5" y1="1236.7402" y2="1236.7402"/><line style="stroke:#3498DB;stroke-width:2.0;" x1="2087.5" x2="2770.5" y1="1244.7402" y2="1244.7402"/><ellipse cx="2097.5" cy="1259.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="659" x="2106.5" y="1263.8477">LegacyControlSamAsyncTransactionManager prepareGiveTargetSamPseudoRandom (? asyncRandom)</text><ellipse cx="2097.5" cy="1278.1719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="165" x="2106.5" y="1282.4688">String exportCommands ()</text></g><!--MD5=[9b6b3b24aacb5f7ad15454d200b51d2a]
class CardTransactionCryptoExtensionFactory--><g id="elem_CardTransactionCryptoExtensionFactory"><rect codeLine="288" fill="#FDEDEC" height="66.6211" id="CardTransactionCryptoExtensionFactory" rx="2.5" ry="2.5" style="stroke:#E74C3C;stroke-width:2.0;" width="576" x="4057" y="771.7402"/><ellipse cx="4206.75" cy="787.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4207.7031,784.3809 L4207.7031,791.0371 L4209.4219,791.0371 Q4210.0313,791.0371 4210.2969,791.2715 Q4210.5625,791.5059 4210.5625,791.8965 Q4210.5625,792.2715 4210.2969,792.5059 Q4210.0313,792.7402 4209.4219,792.7402 L4204.2813,792.7402 Q4203.6719,792.7402 4203.4063,792.5059 Q4203.1406,792.2715 4203.1406,791.8809 Q4203.1406,791.5059 4203.4063,791.2715 Q4203.6719,791.0371 4204.2813,791.0371 L4206,791.0371 L4206,784.3809 L4204.2813,784.3809 Q4203.6719,784.3809 4203.4063,784.1465 Q4203.1406,783.9121 4203.1406,783.5215 Q4203.1406,783.1465 4203.4063,782.9121 Q4203.6719,782.6777 4204.2813,782.6777 L4209.4219,782.6777 Q4210.0313,782.6777 4210.2969,782.9121 Q4210.5625,783.1465 4210.5625,783.5215 Q4210.5625,783.9121 4210.2969,784.1465 Q4210.0313,784.3809 4209.4219,784.3809 L4207.7031,784.3809 Z " fill="#000000"/><ellipse cx="4232.25" cy="787.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="257" x="4238.25" y="793.5371">CardTransactionCryptoExtensionFactory</text><line style="stroke:#E74C3C;stroke-width:2.0;" x1="4058" x2="4632" y1="803.7402" y2="803.7402"/><line style="stroke:#E74C3C;stroke-width:2.0;" x1="4058" x2="4632" y1="811.7402" y2="811.7402"/><ellipse cx="4068" cy="826.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="550" x="4077" y="830.8477">LegacySamCardTransactionCryptoExtension createCardTransactionCryptoExtension ()</text></g><!--MD5=[dbd049b1aac9d758f526265ceb7ce91b]
class LegacySamCardTransactionCryptoExtension--><g id="elem_LegacySamCardTransactionCryptoExtension"><rect codeLine="292" fill="#E9F7EF" height="100.4844" id="LegacySamCardTransactionCryptoExtension" rx="2.5" ry="2.5" style="stroke:#27AE60;stroke-width:2.0;" width="778" x="3956" y="1197.2402"/><ellipse cx="4193.75" cy="1220.8613" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4194.7031,1217.502 L4194.7031,1224.1582 L4196.4219,1224.1582 Q4197.0313,1224.1582 4197.2969,1224.3926 Q4197.5625,1224.627 4197.5625,1225.0176 Q4197.5625,1225.3926 4197.2969,1225.627 Q4197.0313,1225.8613 4196.4219,1225.8613 L4191.2813,1225.8613 Q4190.6719,1225.8613 4190.4063,1225.627 Q4190.1406,1225.3926 4190.1406,1225.002 Q4190.1406,1224.627 4190.4063,1224.3926 Q4190.6719,1224.1582 4191.2813,1224.1582 L4193,1224.1582 L4193,1217.502 L4191.2813,1217.502 Q4190.6719,1217.502 4190.4063,1217.2676 Q4190.1406,1217.0332 4190.1406,1216.6426 Q4190.1406,1216.2676 4190.4063,1216.0332 Q4190.6719,1215.7988 4191.2813,1215.7988 L4196.4219,1215.7988 Q4197.0313,1215.7988 4197.2969,1216.0332 Q4197.5625,1216.2676 4197.5625,1216.6426 Q4197.5625,1217.0332 4197.2969,1217.2676 Q4197.0313,1217.502 4196.4219,1217.502 L4194.7031,1217.502 Z " fill="#000000"/><ellipse cx="4219.25" cy="1220.3613" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="16" x="4246.25" y="1217.3477">&lt;&lt;</text><text fill="#000000" filter="url(#bmmos2p3brkef1)" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="209" x="4262.25" y="1217.3477">CardTransactionCryptoExtension</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="16" x="4471.25" y="1217.3477">&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="283" x="4225.25" y="1235.9688">LegacySamCardTransactionCryptoExtension</text><line style="stroke:#27AE60;stroke-width:2.0;" x1="3957" x2="4733" y1="1244.4824" y2="1244.4824"/><line style="stroke:#27AE60;stroke-width:2.0;" x1="3957" x2="4733" y1="1252.4824" y2="1252.4824"/><ellipse cx="3967" cy="1267.293" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="752" x="3976" y="1271.5898">LegacySamCardTransactionCryptoExtension prepareComputeSignature (CommonSignatureComputationData&lt;?&gt; data)</text><ellipse cx="3967" cy="1285.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="721" x="3976" y="1290.2109">LegacySamCardTransactionCryptoExtension prepareVerifySignature (CommonSignatureVerificationData&lt;?&gt; data)</text></g><!--MD5=[c17ae2c2af60537b87d9abee834860c0]
class CommonSignatureComputationData--><g id="elem_CommonSignatureComputationData"><rect codeLine="143" fill="#FEFECE" height="141.1055" id="CommonSignatureComputationData" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="553" x="3027.5" y="1508.7402"/><ellipse cx="3042.5" cy="1524.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3043.4531,1521.3809 L3043.4531,1528.0371 L3045.1719,1528.0371 Q3045.7813,1528.0371 3046.0469,1528.2715 Q3046.3125,1528.5059 3046.3125,1528.8965 Q3046.3125,1529.2715 3046.0469,1529.5059 Q3045.7813,1529.7402 3045.1719,1529.7402 L3040.0313,1529.7402 Q3039.4219,1529.7402 3039.1563,1529.5059 Q3038.8906,1529.2715 3038.8906,1528.8809 Q3038.8906,1528.5059 3039.1563,1528.2715 Q3039.4219,1528.0371 3040.0313,1528.0371 L3041.75,1528.0371 L3041.75,1521.3809 L3040.0313,1521.3809 Q3039.4219,1521.3809 3039.1563,1521.1465 Q3038.8906,1520.9121 3038.8906,1520.5215 Q3038.8906,1520.1465 3039.1563,1519.9121 Q3039.4219,1519.6777 3040.0313,1519.6777 L3045.1719,1519.6777 Q3045.7813,1519.6777 3046.0469,1519.9121 Q3046.3125,1520.1465 3046.3125,1520.5215 Q3046.3125,1520.9121 3046.0469,1521.1465 Q3045.7813,1521.3809 3045.1719,1521.3809 L3043.4531,1521.3809 Z " fill="#000000"/><ellipse cx="3061.5" cy="1524.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="227" x="3067.5" y="1530.5371">CommonSignatureComputationData</text><rect fill="#FFFFFF" height="17.9609" style="stroke:#D4AC0D;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="281" x="3302.5" y="1505.7402"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="279" x="3303.5" y="1519.6895">T extends CommonSignatureComputationData&lt;T&gt;</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="3028.5" x2="3579.5" y1="1540.7402" y2="1540.7402"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="3028.5" x2="3579.5" y1="1548.7402" y2="1548.7402"/><ellipse cx="3038.5" cy="1563.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="256" x="3047.5" y="1567.8477">T setData (byte[] data, byte kif, byte kvc)</text><ellipse cx="3038.5" cy="1582.1719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="176" x="3047.5" y="1586.4688">T setSignatureSize (int size)</text><ellipse cx="3038.5" cy="1600.793" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="233" x="3047.5" y="1605.0898">T setKeyDiversifier (byte[] diversifier)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="3047.5" y="1623.7109"> </text><ellipse cx="3038.5" cy="1638.0352" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134" x="3047.5" y="1642.332">byte[] getSignature ()</text></g><!--MD5=[c644258d6e85feb715526e24ebfc93b6]
class BasicSignatureComputationData--><g id="elem_BasicSignatureComputationData"><rect codeLine="150" fill="#FEFECE" height="48" id="BasicSignatureComputationData" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="248" x="3100" y="1767.7402"/><ellipse cx="3115" cy="1783.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3115.9531,1780.3809 L3115.9531,1787.0371 L3117.6719,1787.0371 Q3118.2813,1787.0371 3118.5469,1787.2715 Q3118.8125,1787.5059 3118.8125,1787.8965 Q3118.8125,1788.2715 3118.5469,1788.5059 Q3118.2813,1788.7402 3117.6719,1788.7402 L3112.5313,1788.7402 Q3111.9219,1788.7402 3111.6563,1788.5059 Q3111.3906,1788.2715 3111.3906,1787.8809 Q3111.3906,1787.5059 3111.6563,1787.2715 Q3111.9219,1787.0371 3112.5313,1787.0371 L3114.25,1787.0371 L3114.25,1780.3809 L3112.5313,1780.3809 Q3111.9219,1780.3809 3111.6563,1780.1465 Q3111.3906,1779.9121 3111.3906,1779.5215 Q3111.3906,1779.1465 3111.6563,1778.9121 Q3111.9219,1778.6777 3112.5313,1778.6777 L3117.6719,1778.6777 Q3118.2813,1778.6777 3118.5469,1778.9121 Q3118.8125,1779.1465 3118.8125,1779.5215 Q3118.8125,1779.9121 3118.5469,1780.1465 Q3118.2813,1780.3809 3117.6719,1780.3809 L3115.9531,1780.3809 Z " fill="#000000"/><ellipse cx="3134" cy="1783.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="205" x="3140" y="1789.5371">BasicSignatureComputationData</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="3101" x2="3347" y1="1799.7402" y2="1799.7402"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="3101" x2="3347" y1="1807.7402" y2="1807.7402"/></g><!--MD5=[cdc2fcd8768bdabfe9b56e9f578bd14d]
class TraceableSignatureComputationData--><g id="elem_TraceableSignatureComputationData"><rect codeLine="152" fill="#FEFECE" height="122.4844" id="TraceableSignatureComputationData" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="732" x="2333" y="1730.7402"/><ellipse cx="2571.75" cy="1746.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2572.7031,1743.3809 L2572.7031,1750.0371 L2574.4219,1750.0371 Q2575.0313,1750.0371 2575.2969,1750.2715 Q2575.5625,1750.5059 2575.5625,1750.8965 Q2575.5625,1751.2715 2575.2969,1751.5059 Q2575.0313,1751.7402 2574.4219,1751.7402 L2569.2813,1751.7402 Q2568.6719,1751.7402 2568.4063,1751.5059 Q2568.1406,1751.2715 2568.1406,1750.8809 Q2568.1406,1750.5059 2568.4063,1750.2715 Q2568.6719,1750.0371 2569.2813,1750.0371 L2571,1750.0371 L2571,1743.3809 L2569.2813,1743.3809 Q2568.6719,1743.3809 2568.4063,1743.1465 Q2568.1406,1742.9121 2568.1406,1742.5215 Q2568.1406,1742.1465 2568.4063,1741.9121 Q2568.6719,1741.6777 2569.2813,1741.6777 L2574.4219,1741.6777 Q2575.0313,1741.6777 2575.2969,1741.9121 Q2575.5625,1742.1465 2575.5625,1742.5215 Q2575.5625,1742.9121 2575.2969,1743.1465 Q2575.0313,1743.3809 2574.4219,1743.3809 L2572.7031,1743.3809 Z " fill="#000000"/><ellipse cx="2597.25" cy="1746.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="235" x="2603.25" y="1752.5371">TraceableSignatureComputationData</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="2334" x2="3064" y1="1762.7402" y2="1762.7402"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="2334" x2="3064" y1="1770.7402" y2="1770.7402"/><ellipse cx="2344" cy="1785.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="706" x="2353" y="1789.8477">TraceableSignatureComputationData withSamTraceabilityMode (int offset, boolean usePartialSamSerialNumber)</text><ellipse cx="2344" cy="1804.1719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="363" x="2353" y="1808.4688">TraceableSignatureComputationData withoutBusyMode ()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2353" y="1827.0898"> </text><ellipse cx="2344" cy="1841.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147" x="2353" y="1845.7109">byte[] getSignedData ()</text></g><!--MD5=[49815161954875a46b9e77877b8c8585]
class CommonSignatureVerificationData--><g id="elem_CommonSignatureVerificationData"><rect codeLine="158" fill="#FEFECE" height="122.4844" id="CommonSignatureVerificationData" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="533" x="3751.5" y="1518.2402"/><ellipse cx="3766.5" cy="1534.2402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3767.4531,1530.8809 L3767.4531,1537.5371 L3769.1719,1537.5371 Q3769.7813,1537.5371 3770.0469,1537.7715 Q3770.3125,1538.0059 3770.3125,1538.3965 Q3770.3125,1538.7715 3770.0469,1539.0059 Q3769.7813,1539.2402 3769.1719,1539.2402 L3764.0313,1539.2402 Q3763.4219,1539.2402 3763.1563,1539.0059 Q3762.8906,1538.7715 3762.8906,1538.3809 Q3762.8906,1538.0059 3763.1563,1537.7715 Q3763.4219,1537.5371 3764.0313,1537.5371 L3765.75,1537.5371 L3765.75,1530.8809 L3764.0313,1530.8809 Q3763.4219,1530.8809 3763.1563,1530.6465 Q3762.8906,1530.4121 3762.8906,1530.0215 Q3762.8906,1529.6465 3763.1563,1529.4121 Q3763.4219,1529.1777 3764.0313,1529.1777 L3769.1719,1529.1777 Q3769.7813,1529.1777 3770.0469,1529.4121 Q3770.3125,1529.6465 3770.3125,1530.0215 Q3770.3125,1530.4121 3770.0469,1530.6465 Q3769.7813,1530.8809 3769.1719,1530.8809 L3767.4531,1530.8809 Z " fill="#000000"/><ellipse cx="3785.5" cy="1533.7402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="217" x="3791.5" y="1540.0371">CommonSignatureVerificationData</text><rect fill="#FFFFFF" height="17.9609" style="stroke:#D4AC0D;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="271" x="4016.5" y="1515.2402"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="269" x="4017.5" y="1529.1895">T extends CommonSignatureVerificationData&lt;T&gt;</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="3752.5" x2="4283.5" y1="1550.2402" y2="1550.2402"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="3752.5" x2="4283.5" y1="1558.2402" y2="1558.2402"/><ellipse cx="3762.5" cy="1573.0508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="362" x="3771.5" y="1577.3477">T setData (byte[] data, byte[] signature, byte kif, byte kvc)</text><ellipse cx="3762.5" cy="1591.6719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="233" x="3771.5" y="1595.9688">T setKeyDiversifier (byte[] diversifier)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="3771.5" y="1614.5898"> </text><ellipse cx="3762.5" cy="1628.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="171" x="3771.5" y="1633.2109">boolean isSignatureValid ()</text></g><!--MD5=[792b97716737da270761df73939131ae]
class BasicSignatureVerificationData--><g id="elem_BasicSignatureVerificationData"><rect codeLine="164" fill="#FEFECE" height="48" id="BasicSignatureVerificationData" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="238" x="3383" y="1767.7402"/><ellipse cx="3398" cy="1783.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3398.9531,1780.3809 L3398.9531,1787.0371 L3400.6719,1787.0371 Q3401.2813,1787.0371 3401.5469,1787.2715 Q3401.8125,1787.5059 3401.8125,1787.8965 Q3401.8125,1788.2715 3401.5469,1788.5059 Q3401.2813,1788.7402 3400.6719,1788.7402 L3395.5313,1788.7402 Q3394.9219,1788.7402 3394.6563,1788.5059 Q3394.3906,1788.2715 3394.3906,1787.8809 Q3394.3906,1787.5059 3394.6563,1787.2715 Q3394.9219,1787.0371 3395.5313,1787.0371 L3397.25,1787.0371 L3397.25,1780.3809 L3395.5313,1780.3809 Q3394.9219,1780.3809 3394.6563,1780.1465 Q3394.3906,1779.9121 3394.3906,1779.5215 Q3394.3906,1779.1465 3394.6563,1778.9121 Q3394.9219,1778.6777 3395.5313,1778.6777 L3400.6719,1778.6777 Q3401.2813,1778.6777 3401.5469,1778.9121 Q3401.8125,1779.1465 3401.8125,1779.5215 Q3401.8125,1779.9121 3401.5469,1780.1465 Q3401.2813,1780.3809 3400.6719,1780.3809 L3398.9531,1780.3809 Z " fill="#000000"/><ellipse cx="3417" cy="1783.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="195" x="3423" y="1789.5371">BasicSignatureVerificationData</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="3384" x2="3620" y1="1799.7402" y2="1799.7402"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="3384" x2="3620" y1="1807.7402" y2="1807.7402"/></g><!--MD5=[2fc7953a0035a8aa989ea0d75f9f7d1b]
class TraceableSignatureVerificationData--><g id="elem_TraceableSignatureVerificationData"><rect codeLine="166" fill="#FEFECE" height="85.2422" id="TraceableSignatureVerificationData" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="1077" x="3656.5" y="1749.2402"/><ellipse cx="4072.75" cy="1765.2402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4073.7031,1761.8809 L4073.7031,1768.5371 L4075.4219,1768.5371 Q4076.0313,1768.5371 4076.2969,1768.7715 Q4076.5625,1769.0059 4076.5625,1769.3965 Q4076.5625,1769.7715 4076.2969,1770.0059 Q4076.0313,1770.2402 4075.4219,1770.2402 L4070.2813,1770.2402 Q4069.6719,1770.2402 4069.4063,1770.0059 Q4069.1406,1769.7715 4069.1406,1769.3809 Q4069.1406,1769.0059 4069.4063,1768.7715 Q4069.6719,1768.5371 4070.2813,1768.5371 L4072,1768.5371 L4072,1761.8809 L4070.2813,1761.8809 Q4069.6719,1761.8809 4069.4063,1761.6465 Q4069.1406,1761.4121 4069.1406,1761.0215 Q4069.1406,1760.6465 4069.4063,1760.4121 Q4069.6719,1760.1777 4070.2813,1760.1777 L4075.4219,1760.1777 Q4076.0313,1760.1777 4076.2969,1760.4121 Q4076.5625,1760.6465 4076.5625,1761.0215 Q4076.5625,1761.4121 4076.2969,1761.6465 Q4076.0313,1761.8809 4075.4219,1761.8809 L4073.7031,1761.8809 Z " fill="#000000"/><ellipse cx="4098.25" cy="1764.7402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="225" x="4104.25" y="1771.0371">TraceableSignatureVerificationData</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="3657.5" x2="4732.5" y1="1781.2402" y2="1781.2402"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="3657.5" x2="4732.5" y1="1789.2402" y2="1789.2402"/><ellipse cx="3667.5" cy="1804.0508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="1051" x="3676.5" y="1808.3477">TraceableSignatureVerificationData withSamTraceabilityMode (int offset, boolean isPartialSamSerialNumber, LegacySamRevocationServiceSpi samRevocationService)</text><ellipse cx="3667.5" cy="1822.6719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="353" x="3676.5" y="1826.9688">TraceableSignatureVerificationData withoutBusyMode ()</text></g><!--MD5=[d858201e9b1d9d97dc08c8f426fc6ba5]
class CommandDataFactory--><g id="elem_CommandDataFactory"><rect codeLine="289" fill="#FDEDEC" height="122.4844" id="CommandDataFactory" rx="2.5" ry="2.5" style="stroke:#E74C3C;stroke-width:2.0;" width="554" x="3086" y="1936.2402"/><ellipse cx="3282.25" cy="1952.2402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M3283.2031,1948.8809 L3283.2031,1955.5371 L3284.9219,1955.5371 Q3285.5313,1955.5371 3285.7969,1955.7715 Q3286.0625,1956.0059 3286.0625,1956.3965 Q3286.0625,1956.7715 3285.7969,1957.0059 Q3285.5313,1957.2402 3284.9219,1957.2402 L3279.7813,1957.2402 Q3279.1719,1957.2402 3278.9063,1957.0059 Q3278.6406,1956.7715 3278.6406,1956.3809 Q3278.6406,1956.0059 3278.9063,1955.7715 Q3279.1719,1955.5371 3279.7813,1955.5371 L3281.5,1955.5371 L3281.5,1948.8809 L3279.7813,1948.8809 Q3279.1719,1948.8809 3278.9063,1948.6465 Q3278.6406,1948.4121 3278.6406,1948.0215 Q3278.6406,1947.6465 3278.9063,1947.4121 Q3279.1719,1947.1777 3279.7813,1947.1777 L3284.9219,1947.1777 Q3285.5313,1947.1777 3285.7969,1947.4121 Q3286.0625,1947.6465 3286.0625,1948.0215 Q3286.0625,1948.4121 3285.7969,1948.6465 Q3285.5313,1948.8809 3284.9219,1948.8809 L3283.2031,1948.8809 Z " fill="#000000"/><ellipse cx="3307.75" cy="1951.7402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="142" x="3313.75" y="1958.0371">CommandDataFactory</text><line style="stroke:#E74C3C;stroke-width:2.0;" x1="3087" x2="3639" y1="1968.2402" y2="1968.2402"/><line style="stroke:#E74C3C;stroke-width:2.0;" x1="3087" x2="3639" y1="1976.2402" y2="1976.2402"/><ellipse cx="3097" cy="1991.0508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="468" x="3106" y="1995.3477">BasicSignatureComputationData createBasicSignatureComputationData ()</text><ellipse cx="3097" cy="2009.6719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="528" x="3106" y="2013.9688">TraceableSignatureComputationData createTraceableSignatureComputationData ()</text><ellipse cx="3097" cy="2028.293" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="448" x="3106" y="2032.5898">BasicSignatureVerificationData createBasicSignatureVerificationData ()</text><ellipse cx="3097" cy="2046.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="508" x="3106" y="2051.2109">TraceableSignatureVerificationData createTraceableSignatureVerificationData ()</text></g><!--MD5=[b58d76b79420dd883c14cfc4fba66a7b]
class CardSelectionFactory--><g id="elem_CardSelectionFactory"><rect codeLine="286" fill="#FDEDEC" height="66.6211" id="CardSelectionFactory" rx="2.5" ry="2.5" style="stroke:#E74C3C;stroke-width:2.0;" width="302" x="167" y="771.7402"/><ellipse cx="239.75" cy="787.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M240.7031,784.3809 L240.7031,791.0371 L242.4219,791.0371 Q243.0313,791.0371 243.2969,791.2715 Q243.5625,791.5059 243.5625,791.8965 Q243.5625,792.2715 243.2969,792.5059 Q243.0313,792.7402 242.4219,792.7402 L237.2813,792.7402 Q236.6719,792.7402 236.4063,792.5059 Q236.1406,792.2715 236.1406,791.8809 Q236.1406,791.5059 236.4063,791.2715 Q236.6719,791.0371 237.2813,791.0371 L239,791.0371 L239,784.3809 L237.2813,784.3809 Q236.6719,784.3809 236.4063,784.1465 Q236.1406,783.9121 236.1406,783.5215 Q236.1406,783.1465 236.4063,782.9121 Q236.6719,782.6777 237.2813,782.6777 L242.4219,782.6777 Q243.0313,782.6777 243.2969,782.9121 Q243.5625,783.1465 243.5625,783.5215 Q243.5625,783.9121 243.2969,784.1465 Q243.0313,784.3809 242.4219,784.3809 L240.7031,784.3809 Z " fill="#000000"/><ellipse cx="265.25" cy="787.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="137" x="271.25" y="793.5371">CardSelectionFactory</text><line style="stroke:#E74C3C;stroke-width:2.0;" x1="168" x2="468" y1="803.7402" y2="803.7402"/><line style="stroke:#E74C3C;stroke-width:2.0;" x1="168" x2="468" y1="811.7402" y2="811.7402"/><ellipse cx="178" cy="826.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="276" x="187" y="830.8477">LegacySamSelection createSamSelection ()</text></g><!--MD5=[f828a509400a69824ac8cdade397711f]
class LegacySamSelection--><g id="elem_LegacySamSelection"><rect codeLine="294" fill="#E9F7EF" height="137.7266" id="LegacySamSelection" rx="2.5" ry="2.5" style="stroke:#27AE60;stroke-width:2.0;" width="543" x="46.5" y="1178.2402"/><ellipse cx="242.25" cy="1201.8613" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M243.2031,1198.502 L243.2031,1205.1582 L244.9219,1205.1582 Q245.5313,1205.1582 245.7969,1205.3926 Q246.0625,1205.627 246.0625,1206.0176 Q246.0625,1206.3926 245.7969,1206.627 Q245.5313,1206.8613 244.9219,1206.8613 L239.7813,1206.8613 Q239.1719,1206.8613 238.9063,1206.627 Q238.6406,1206.3926 238.6406,1206.002 Q238.6406,1205.627 238.9063,1205.3926 Q239.1719,1205.1582 239.7813,1205.1582 L241.5,1205.1582 L241.5,1198.502 L239.7813,1198.502 Q239.1719,1198.502 238.9063,1198.2676 Q238.6406,1198.0332 238.6406,1197.6426 Q238.6406,1197.2676 238.9063,1197.0332 Q239.1719,1196.7988 239.7813,1196.7988 L244.9219,1196.7988 Q245.5313,1196.7988 245.7969,1197.0332 Q246.0625,1197.2676 246.0625,1197.6426 Q246.0625,1198.0332 245.7969,1198.2676 Q245.5313,1198.502 244.9219,1198.502 L243.2031,1198.502 Z " fill="#000000"/><ellipse cx="267.75" cy="1201.3613" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="16" x="279.25" y="1198.3477">&lt;&lt;</text><text fill="#000000" filter="url(#bmmos2p3brkef0)" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="89" x="295.25" y="1198.3477">CardSelection</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="16" x="384.25" y="1198.3477">&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="132" x="273.75" y="1216.9688">LegacySamSelection</text><line style="stroke:#27AE60;stroke-width:2.0;" x1="47.5" x2="588.5" y1="1225.4824" y2="1225.4824"/><line style="stroke:#27AE60;stroke-width:2.0;" x1="47.5" x2="588.5" y1="1233.4824" y2="1233.4824"/><ellipse cx="57.5" cy="1248.293" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="517" x="66.5" y="1252.5898">LegacySamSelection filterByProductType (LegacySam.ProductType productType)</text><ellipse cx="57.5" cy="1266.9141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="442" x="66.5" y="1271.2109">LegacySamSelection filterBySerialNumber (String serialNumberRegex)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="66.5" y="1289.832"> </text><ellipse cx="57.5" cy="1304.1563" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="353" x="66.5" y="1308.4531">LegacySamSelection setUnlockData (String unlockData)</text></g><!--MD5=[756cbdb2eeffdcd67180b97f5e83c8e0]
class LegacySam--><g id="elem_LegacySam"><rect codeLine="197" fill="#FEFECE" height="361.1797" id="LegacySam" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="349" x="624.5" y="1066.7402"/><ellipse cx="739.25" cy="1090.3613" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M740.2031,1087.002 L740.2031,1093.6582 L741.9219,1093.6582 Q742.5313,1093.6582 742.7969,1093.8926 Q743.0625,1094.127 743.0625,1094.5176 Q743.0625,1094.8926 742.7969,1095.127 Q742.5313,1095.3613 741.9219,1095.3613 L736.7813,1095.3613 Q736.1719,1095.3613 735.9063,1095.127 Q735.6406,1094.8926 735.6406,1094.502 Q735.6406,1094.127 735.9063,1093.8926 Q736.1719,1093.6582 736.7813,1093.6582 L738.5,1093.6582 L738.5,1087.002 L736.7813,1087.002 Q736.1719,1087.002 735.9063,1086.7676 Q735.6406,1086.5332 735.6406,1086.1426 Q735.6406,1085.7676 735.9063,1085.5332 Q736.1719,1085.2988 736.7813,1085.2988 L741.9219,1085.2988 Q742.5313,1085.2988 742.7969,1085.5332 Q743.0625,1085.7676 743.0625,1086.1426 Q743.0625,1086.5332 742.7969,1086.7676 Q742.5313,1087.002 741.9219,1087.002 L740.2031,1087.002 Z " fill="#000000"/><ellipse cx="764.75" cy="1089.8613" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="16" x="770.75" y="1086.8477">&lt;&lt;</text><text fill="#000000" filter="url(#bmmos2p3brkef0)" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="68" x="786.75" y="1086.8477">SmartCard</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="16" x="854.75" y="1086.8477">&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="74" x="783.75" y="1105.4688">LegacySam</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="625.5" x2="972.5" y1="1113.9824" y2="1113.9824"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="625.5" x2="972.5" y1="1121.9824" y2="1121.9824"/><ellipse cx="635.5" cy="1136.793" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="200" x="644.5" y="1141.0898">ProductType getProductType ()</text><ellipse cx="635.5" cy="1155.4141" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147" x="644.5" y="1159.7109">String getProductInfo ()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="644.5" y="1178.332"> </text><ellipse cx="635.5" cy="1192.6563" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="644.5" y="1196.9531">byte[] getSerialNumber ()</text><ellipse cx="635.5" cy="1211.2773" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="644.5" y="1215.5742">byte getPlatform ()</text><ellipse cx="635.5" cy="1229.8984" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="166" x="644.5" y="1234.1953">byte getApplicationType ()</text><ellipse cx="635.5" cy="1248.5195" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="191" x="644.5" y="1252.8164">byte getApplicationSubType ()</text><ellipse cx="635.5" cy="1267.1406" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="644.5" y="1271.4375">byte getSoftwareIssuer ()</text><ellipse cx="635.5" cy="1285.7617" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="168" x="644.5" y="1290.0586">byte getSoftwareVersion ()</text><ellipse cx="635.5" cy="1304.3828" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="174" x="644.5" y="1308.6797">byte getSoftwareRevision ()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="644.5" y="1327.3008"> </text><ellipse cx="635.5" cy="1341.625" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="323" x="644.5" y="1345.9219">Integer getEventCounter (int eventCounterNumber)</text><ellipse cx="635.5" cy="1360.2461" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="313" x="644.5" y="1364.543">SortedMap&lt;Integer, Integer&gt; getEventCounters ()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="644.5" y="1383.1641"> </text><ellipse cx="635.5" cy="1397.4883" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="307" x="644.5" y="1401.7852">Integer getEventCeiling (int eventCeilingNumber)</text><ellipse cx="635.5" cy="1416.1094" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="305" x="644.5" y="1420.4063">SortedMap&lt;Integer, Integer&gt; getEventCeilings ()</text></g><!--MD5=[64db2d10778acf6b7b903aeb76cb16f8]
class SamProductType--><g id="elem_SamProductType"><rect codeLine="215" fill="#FEFECE" height="141.1055" id="SamProductType" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="124" x="696" y="1508.7402"/><ellipse cx="711" cy="1524.7402" fill="#EB937F" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M709.8594,1525.5371 L709.8594,1528.0371 L714.1875,1528.0371 L714.1875,1527.1152 Q714.1875,1526.5059 714.4219,1526.2402 Q714.6719,1525.9746 715.0469,1525.9746 Q715.4219,1525.9746 715.6563,1526.2402 Q715.8906,1526.5059 715.8906,1527.1152 L715.8906,1529.7402 L707.8906,1529.7402 Q707.2656,1529.7402 707,1529.5059 Q706.75,1529.2715 706.75,1528.8809 Q706.75,1528.5059 707.0156,1528.2715 Q707.2813,1528.0371 707.8906,1528.0371 L708.1563,1528.0371 L708.1563,1521.3809 L707.8906,1521.3809 Q707.2656,1521.3809 707,1521.1465 Q706.75,1520.9121 706.75,1520.5215 Q706.75,1520.1465 707,1519.9121 Q707.2656,1519.6777 707.8906,1519.6777 L715.5156,1519.6777 L715.5156,1522.2715 Q715.5156,1522.8809 715.2813,1523.1465 Q715.0625,1523.3965 714.6719,1523.3965 Q714.2969,1523.3965 714.0625,1523.1465 Q713.8281,1522.8809 713.8281,1522.2715 L713.8281,1521.3809 L709.8594,1521.3809 L709.8594,1523.834 L711.3438,1523.834 Q711.3438,1523.1777 711.4688,1522.9902 Q711.7344,1522.584 712.2031,1522.584 Q712.5781,1522.584 712.8125,1522.8496 Q713.0469,1523.0996 713.0469,1523.709 L713.0469,1525.6777 Q713.0469,1526.2246 712.9219,1526.4121 Q712.6563,1526.8027 712.2031,1526.8027 Q711.7344,1526.8027 711.4688,1526.3965 Q711.3438,1526.209 711.3438,1525.5371 L709.8594,1525.5371 Z " fill="#000000"/><ellipse cx="730" cy="1524.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="736" y="1530.5371">ProductType</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="697" x2="819" y1="1540.7402" y2="1540.7402"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="702" y="1559.8477">SAM_C1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="702" y="1578.4688">HSM_C1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="702" y="1597.0898">SAM_S1E1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="702" y="1615.7109">SAM_S1Dx</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="702" y="1634.332">UNKNOWN</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="697" x2="819" y1="1641.8457" y2="1641.8457"/></g><!--MD5=[a91ea8a99ecb7d51266e633c607a59bb]
class LegacySamRevocationServiceSpi--><g id="elem_LegacySamRevocationServiceSpi"><rect codeLine="224" fill="#FEFECE" height="85.2422" id="LegacySamRevocationServiceSpi" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="422" x="4814" y="1954.7402"/><ellipse cx="4910.25" cy="1970.7402" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M4911.2031,1967.3809 L4911.2031,1974.0371 L4912.9219,1974.0371 Q4913.5313,1974.0371 4913.7969,1974.2715 Q4914.0625,1974.5059 4914.0625,1974.8965 Q4914.0625,1975.2715 4913.7969,1975.5059 Q4913.5313,1975.7402 4912.9219,1975.7402 L4907.7813,1975.7402 Q4907.1719,1975.7402 4906.9063,1975.5059 Q4906.6406,1975.2715 4906.6406,1974.8809 Q4906.6406,1974.5059 4906.9063,1974.2715 Q4907.1719,1974.0371 4907.7813,1974.0371 L4909.5,1974.0371 L4909.5,1967.3809 L4907.7813,1967.3809 Q4907.1719,1967.3809 4906.9063,1967.1465 Q4906.6406,1966.9121 4906.6406,1966.5215 Q4906.6406,1966.1465 4906.9063,1965.9121 Q4907.1719,1965.6777 4907.7813,1965.6777 L4912.9219,1965.6777 Q4913.5313,1965.6777 4913.7969,1965.9121 Q4914.0625,1966.1465 4914.0625,1966.5215 Q4914.0625,1966.9121 4913.7969,1967.1465 Q4913.5313,1967.3809 4912.9219,1967.3809 L4911.2031,1967.3809 Z " fill="#000000"/><ellipse cx="4935.75" cy="1970.2402" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="210" x="4941.75" y="1976.5371">LegacySamRevocationServiceSpi</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="4815" x2="5235" y1="1986.7402" y2="1986.7402"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="4815" x2="5235" y1="1994.7402" y2="1994.7402"/><ellipse cx="4825" cy="2009.5508" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="285" x="4834" y="2013.8477">boolean isSamRevoked (byte[] serialNumber)</text><ellipse cx="4825" cy="2028.1719" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="396" x="4834" y="2032.4688">boolean isSamRevoked (byte[] serialNumber, int counterValue)</text></g><!--MD5=[9f9e452891b394849e9149e2c852154b]
reverse link LegacySamTransactionManager to LegacySamReadTransactionManager--><g id="link_LegacySamTransactionManager_LegacySamReadTransactionManager"><path d="M1929,389.3802 C1929,445.9202 1929,538.9302 1929,622.5702 " fill="none" id="LegacySamTransactionManager-backto-LegacySamReadTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="1922,389.2402,1929,369.2402,1936,389.2402,1922,389.2402" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[f7ac68152805076048aaa8013cf2a34e]
reverse link LegacySamTransactionManager to LegacySamFreeWriteTransactionManager--><g id="link_LegacySamTransactionManager_LegacySamFreeWriteTransactionManager"><path d="M2122.95,372.9202 C2283.37,402.8402 2511.31,445.3602 2679.2,476.6802 " fill="none" id="LegacySamTransactionManager-backto-LegacySamFreeWriteTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="2121.61,379.7902,2103.23,369.2402,2124.18,366.0302,2121.61,379.7902" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[0f8f45f4589ff3d71cd79e03f4a5e8af]
reverse link LegacySamFreeWriteTransactionManager to LegacySamWriteTransactionManager--><g id="link_LegacySamFreeWriteTransactionManager_LegacySamWriteTransactionManager"><path d="M2902,582.0302 C2902,615.7002 2902,658.3102 2902,697.2002 " fill="none" id="LegacySamFreeWriteTransactionManager-backto-LegacySamWriteTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="2895,581.8402,2902,561.8402,2909,581.8402,2895,581.8402" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[20d25d6eaea103eca888d235be4725d2]
reverse link LegacySamReadTransactionManager to LegacySamSecureReadTransactionManager--><g id="link_LegacySamReadTransactionManager_LegacySamSecureReadTransactionManager"><path d="M1909.75,1007.8902 C1901.6,1093.2702 1893.1,1182.3522 1889.2,1223.2392 " fill="none" id="LegacySamReadTransactionManager-backto-LegacySamSecureReadTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="1902.81,1006.9902,1911.67,987.7502,1916.74,1008.3202,1902.81,1006.9902" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[031a2811e980e04bb25a6d3a1f328743]
reverse link LegacySamReadTransactionManager to LegacySamFreeTransactionManager--><g id="link_LegacySamReadTransactionManager_LegacySamFreeTransactionManager"><path d="M2277.05,956.0302 C2313.07,968.1302 2349.49,979.0202 2385,987.7402 C2717.81,1069.4402 2821.76,975.1802 3152,1066.7402 C3266.99,1098.6202 3390.32,1162.3542 3465.07,1204.6552 " fill="none" id="LegacySamReadTransactionManager-backto-LegacySamFreeTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="2274.32,962.5002,2257.67,949.4002,2278.86,949.2502,2274.32,962.5002" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[528c0e2c879dda1647f1abd7732b2860]
reverse link LegacySamFreeWriteTransactionManager to LegacySamFreeTransactionManager--><g id="link_LegacySamFreeWriteTransactionManager_LegacySamFreeTransactionManager"><path d="M3279.94,566.1202 C3342.42,580.4902 3394.53,599.0202 3418,622.7402 C3578.54,784.9902 3555.83,1093.1802 3541.35,1204.6722 " fill="none" id="LegacySamFreeWriteTransactionManager-backto-LegacySamFreeTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="3278.27,572.9202,3260.23,561.7902,3281.27,559.2502,3278.27,572.9202" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[6914754a0680d6b255ec09e573377449]
reverse link LegacySamWriteTransactionManager to LegacySamSecureWriteTransactionManager--><g id="link_LegacySamWriteTransactionManager_LegacySamSecureWriteTransactionManager"><path d="M2921.91,933.2302 C2937.9,1035.1502 2959,1169.7092 2967.36,1223.0402 " fill="none" id="LegacySamWriteTransactionManager-backto-LegacySamSecureWriteTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="2914.97,934.1602,2918.79,913.3102,2928.81,931.9902,2914.97,934.1602" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[504edd26467f0771a9311e605d7d25b3]
reverse link LegacySamTransactionManager to LegacyTargetSamAsyncTransactionManager--><g id="link_LegacySamTransactionManager_LegacyTargetSamAsyncTransactionManager"><path d="M1855.15,380.2602 C1777.13,429.7702 1655.57,517.5502 1583,622.7402 C1446.01,821.3102 1390.82,1116.1202 1375.65,1213.6232 " fill="none" id="LegacySamTransactionManager-backto-LegacyTargetSamAsyncTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="1851.87,374.0502,1872.54,369.4002,1859.29,385.9302,1851.87,374.0502" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[3a156483b371d7bcf5bd0077bcf92dbb]
reverse link LegacySamWriteTransactionManager to LegacyControlSamAsyncTransactionManager--><g id="link_LegacySamWriteTransactionManager_LegacyControlSamAsyncTransactionManager"><path d="M2772.17,927.0202 C2672.78,1019.4602 2541.61,1141.4852 2473.84,1204.5332 " fill="none" id="LegacySamWriteTransactionManager-backto-LegacyControlSamAsyncTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="2767.48,921.8102,2786.9,913.3102,2777.02,932.0602,2767.48,921.8102" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[007eb89bfb10701b962958f5b6fc0ebb]
reverse link CommonSignatureComputationData to BasicSignatureComputationData--><g id="link_CommonSignatureComputationData_BasicSignatureComputationData"><path d="M3270.34,1668.8202 C3256.64,1704.8602 3241.92,1743.5762 3232.84,1767.4812 " fill="none" id="CommonSignatureComputationData-backto-BasicSignatureComputationData" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="3263.93,1665.9582,3277.58,1649.7492,3277.02,1670.9312,3263.93,1665.9582" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[f429252bb447dd4a1aa4e00c09503393]
reverse link CommonSignatureComputationData to TraceableSignatureComputationData--><g id="link_CommonSignatureComputationData_TraceableSignatureComputationData"><path d="M3091.73,1656.5522 C3050.09,1671.3412 3006.71,1686.6242 2966,1700.7402 C2937.81,1710.5162 2907.89,1720.7432 2878.67,1730.6522 " fill="none" id="CommonSignatureComputationData-backto-TraceableSignatureComputationData" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="3089.53,1649.9032,3110.72,1649.7972,3094.22,1663.0942,3089.53,1649.9032" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[e2b6e3fe5a6a0a5bd0ef8dd67224f7af]
reverse link CommonSignatureVerificationData to BasicSignatureVerificationData--><g id="link_CommonSignatureVerificationData_BasicSignatureVerificationData"><path d="M3844.22,1647.7822 C3779.58,1673.2882 3705.75,1702.8812 3639,1730.7402 C3610.6,1742.5922 3579.14,1756.3272 3553.54,1767.6632 " fill="none" id="CommonSignatureVerificationData-backto-BasicSignatureVerificationData" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="3841.9,1641.1722,3863.07,1640.3542,3847.03,1654.1982,3841.9,1641.1722" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[e31b41de38b178ddac6d238f38182a2b]
reverse link CommonSignatureVerificationData to TraceableSignatureVerificationData--><g id="link_CommonSignatureVerificationData_TraceableSignatureVerificationData"><path d="M4081.53,1655.7972 C4107.92,1687.1812 4137.54,1722.4012 4159.89,1748.9882 " fill="none" id="CommonSignatureVerificationData-backto-TraceableSignatureVerificationData" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="4076,1660.0922,4068.48,1640.2792,4086.71,1651.0822,4076,1660.0922" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[5eec432a2e7681a202b7f172e8f9a6f9]
reverse link LegacySamSecureReadTransactionManager to LegacySamTransactionManagerFactory--><g id="link_LegacySamSecureReadTransactionManager_LegacySamTransactionManagerFactory"><path codeLine="233" d="M1874.64,1276.1862 C1852.11,1327.0922 1803.78,1436.3302 1771.84,1508.5312 " fill="none" id="LegacySamSecureReadTransactionManager-backto-LegacySamTransactionManagerFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="1876.73,1271.4452,1869.4285,1278.0549,1874.7055,1276.0171,1876.7434,1281.2941,1876.73,1271.4452" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="1800.0231,1462.8133,1793.6757,1469.8958,1799.0509,1472.274,1800.0231,1462.8133" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="1807" y="1472.7686">provide</text></g><!--MD5=[930cc0e3723a66cd8ccad631e2179266]
reverse link LegacySamFreeTransactionManager to LegacySamTransactionManagerFactory--><g id="link_LegacySamFreeTransactionManager_LegacySamTransactionManagerFactory"><path codeLine="234" d="M3459.39,1292.2332 C3384.05,1333.9822 3263.78,1395.0592 3152,1427.7402 C2991.52,1474.6612 2945.74,1464.3842 2779,1476.7402 C2574.2,1491.9162 2521.55,1466.4622 2317,1484.7402 C2253.3,1490.4322 2186,1499.0022 2120.73,1508.6842 " fill="none" id="LegacySamFreeTransactionManager-backto-LegacySamTransactionManagerFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="3463.84,1289.7622,3454.03,1290.6364,3459.4692,1292.1904,3457.9152,1297.6296,3463.84,1289.7622" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="3035.9359,1466.5876,3026.5377,1465.1302,3027.4759,1470.9327,3035.9359,1466.5876" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="3040" y="1472.7686">provide</text></g><!--MD5=[44d345cd8829add454056d1b5883f290]
reverse link LegacySamSecureWriteTransactionManager to LegacySamTransactionManagerFactory--><g id="link_LegacySamSecureWriteTransactionManager_LegacySamTransactionManagerFactory"><path codeLine="235" d="M2952.35,1275.8562 C2922.96,1316.8382 2861.7,1392.6812 2789,1427.7402 C2598.67,1519.5222 2526.22,1455.1392 2317,1484.7402 C2265.09,1492.0852 2210.63,1500.2802 2156.77,1508.6832 " fill="none" id="LegacySamSecureWriteTransactionManager-backto-LegacySamTransactionManagerFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="2955.43,1271.5182,2946.9517,1276.5301,2952.5302,1275.5914,2953.4689,1281.1699,2955.43,1271.5182" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="2725.7987,1465.9814,2716.2923,1465.7013,2717.9432,1471.3425,2725.7987,1465.9814" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="2730" y="1472.7686">provide</text></g><!--MD5=[cc6f50cc5c136908bea67ca390bbeeef]
reverse link LegacyControlSamAsyncTransactionManager to LegacySamTransactionManagerFactory--><g id="link_LegacyControlSamAsyncTransactionManager_LegacySamTransactionManagerFactory"><path codeLine="236" d="M2342.51,1292.1592 C2269.6,1328.9602 2162.37,1382.5752 2068,1427.7402 C2011.77,1454.6522 1949.71,1483.4412 1894.91,1508.5592 " fill="none" id="LegacyControlSamAsyncTransactionManager-backto-LegacySamTransactionManagerFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="2347.26,1289.7592,2337.4235,1290.2517,2342.7982,1292.0158,2341.034,1297.3906,2347.26,1289.7592" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="2006.5015,1465.2094,1997.079,1466.5005,1999.6374,1471.7924,2006.5015,1465.2094" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="2011" y="1472.7686">provide</text></g><!--MD5=[c4abfb60445517bf9515839c1a244717]
reverse link LegacyTargetSamAsyncTransactionManager to LegacySamTransactionManagerFactory--><g id="link_LegacyTargetSamAsyncTransactionManager_LegacySamTransactionManagerFactory"><path codeLine="237" d="M1411.38,1284.2522 C1471.61,1337.9702 1586.11,1440.0972 1663.02,1508.6872 " fill="none" id="LegacyTargetSamAsyncTransactionManager-backto-LegacySamTransactionManagerFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="1407.49,1280.7852,1411.5435,1289.7613,1411.2212,1284.1136,1416.8689,1283.7913,1407.49,1280.7852" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="1623.2685,1464.0577,1628.0626,1472.2715,1631.975,1467.8849,1623.2685,1464.0577" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="1636" y="1472.7686">provide</text></g><!--MD5=[ee4c6bba2bffa26e564d306e93d46670]
reverse link LegacySam to LegacySamTransactionManagerFactory--><g id="link_LegacySam_LegacySamTransactionManagerFactory"><path codeLine="238" d="M978.186,1395.2342 C997.69,1407.4022 1017.81,1418.5392 1038,1427.7402 C1112.54,1461.7022 1195.06,1488.1422 1276.57,1508.6842 " fill="none" id="LegacySam-backto-LegacySamTransactionManagerFactory" style="stroke:#27AE60;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="973.772,1392.4562,979.2587,1400.6352,978.0038,1395.1193,983.5197,1393.8644,973.772,1392.4562" style="stroke:#27AE60;stroke-width:2.0;"/><polygon fill="#000000" points="1166.3264,1465.6088,1173.7365,1471.5704,1175.8255,1466.0763,1166.3264,1465.6088" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="1180" y="1472.7686">use</text></g><!--MD5=[a622277c2ee75aae5c5fb37b0c7dc1dc]
link LegacySamTransactionManagerFactory to LegacySamSecuritySetting--><g id="link_LegacySamTransactionManagerFactory_LegacySamSecuritySetting"><path codeLine="239" d="M1741,1649.7492 C1741,1684.1342 1741,1724.2942 1741,1752.9372 " fill="none" id="LegacySamTransactionManagerFactory-to-LegacySamSecuritySetting" style="stroke:#27AE60;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="1741,1758.1482,1745,1749.1482,1741,1753.1482,1737,1749.1482,1741,1758.1482" style="stroke:#27AE60;stroke-width:2.0;"/><polygon fill="#000000" points="1746,1696.3857,1748.9389,1687.3407,1743.0611,1687.3407,1746,1696.3857" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="1755" y="1696.7686">use</text></g><!--MD5=[d5ce0f59465778e258e9c5b86be28eb0]
reverse link BasicSignatureComputationData to CommandDataFactory--><g id="link_BasicSignatureComputationData_CommandDataFactory"><path codeLine="241" d="M3242.83,1820.3042 C3263,1849.8302 3295.63,1897.6102 3321.81,1935.9322 " fill="none" id="BasicSignatureComputationData-backto-CommandDataFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="3239.95,1816.0842,3241.7232,1825.7721,3242.7701,1820.213,3248.3293,1821.2599,3239.95,1816.0842" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="3300.1798,1888.257,3302.8547,1897.3836,3307.7084,1894.0683,3300.1798,1888.257" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="3312" y="1897.7686">provide</text></g><!--MD5=[a5931c68a06a54ee2218f8c0e81740a8]
reverse link TraceableSignatureComputationData to CommandDataFactory--><g id="link_TraceableSignatureComputationData_CommandDataFactory"><path codeLine="242" d="M2900.75,1854.2842 C2959.23,1872.1462 3023.17,1891.6982 3082,1909.7402 C3109.82,1918.2702 3139.18,1927.2902 3168.01,1936.1592 " fill="none" id="TraceableSignatureComputationData-backto-CommandDataFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="2895.84,1852.7822,2903.283,1859.2321,2900.6228,1854.2398,2905.6152,1851.5796,2895.84,1852.7822" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="3051.2193,1890.9212,3059.0068,1896.3806,3060.7285,1890.7606,3051.2193,1890.9212" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="3065" y="1897.7686">provide</text></g><!--MD5=[a768c3269eabe0208bd6c7ff5338f437]
reverse link BasicSignatureVerificationData to CommandDataFactory--><g id="link_BasicSignatureVerificationData_CommandDataFactory"><path codeLine="243" d="M3483.17,1820.3042 C3463,1849.8302 3430.37,1897.6102 3404.19,1935.9322 " fill="none" id="BasicSignatureVerificationData-backto-CommandDataFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="3486.05,1816.0842,3477.6707,1821.2599,3483.2299,1820.213,3484.2768,1825.7721,3486.05,1816.0842" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="3444.8202,1888.257,3437.2916,1894.0683,3442.1453,1897.3836,3444.8202,1888.257" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="3451" y="1897.7686">provide</text></g><!--MD5=[92c2afdfcdb990580540a111efe9d055]
reverse link TraceableSignatureVerificationData to CommandDataFactory--><g id="link_TraceableSignatureVerificationData_CommandDataFactory"><path codeLine="244" d="M4020.18,1835.4992 C3900.68,1864.7282 3740.61,1903.8802 3608.37,1936.2252 " fill="none" id="TraceableSignatureVerificationData-backto-CommandDataFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="4025.13,1834.2892,4015.4333,1832.5646,4020.2759,1835.4885,4017.3521,1840.3311,4025.13,1834.2892" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="3813.8568,1891.1978,3804.3725,1890.492,3805.769,1896.2016,3813.8568,1891.1978" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="3818" y="1897.7686">provide</text></g><!--MD5=[50dc2a56e0e850668b2b0d357b7a17bc]
link TraceableSignatureVerificationData to LegacySamRevocationServiceSpi--><g id="link_TraceableSignatureVerificationData_LegacySamRevocationServiceSpi"><path codeLine="246" d="M4416.27,1834.2682 C4518.4,1854.7422 4640.93,1881.1622 4750,1909.7402 C4798.35,1922.4082 4850.82,1938.3552 4896.85,1953.0952 " fill="none" id="TraceableSignatureVerificationData-to-LegacySamRevocationServiceSpi" style="stroke:#27AE60;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="4901.85,1954.7022,4894.5034,1948.1427,4897.0893,1953.1739,4892.0581,1955.7598,4901.85,1954.7022" style="stroke:#27AE60;stroke-width:2.0;"/><polygon fill="#000000" points="4729.8538,1893.5859,4721.7786,1888.5618,4720.3677,1894.2678,4729.8538,1893.5859" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="4734" y="1897.7686">use</text></g><!--MD5=[f64af45210638694a6e6cc2e547c64cf]
reverse link LegacySamSecuritySetting to LegacySamSecuritySettingFactory--><g id="link_LegacySamSecuritySetting_LegacySamSecuritySettingFactory"><path codeLine="248" d="M1741,1830.4622 C1741,1868.7182 1741,1927.3152 1741,1963.6252 " fill="none" id="LegacySamSecuritySetting-backto-LegacySamSecuritySettingFactory" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="1741,1825.4362,1737,1834.4362,1741,1830.4362,1745,1834.4362,1741,1825.4362" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="1746,1887.3857,1743.0611,1896.4308,1748.9389,1896.4308,1746,1887.3857" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="1755" y="1897.7686">provide</text></g><!--MD5=[b61385103effde4c889419da2f560871]
link LegacySamFreeTransactionManager to CommonSignatureComputationData--><g id="link_LegacySamFreeTransactionManager_CommonSignatureComputationData"><path codeLine="250" d="M3505.74,1290.0352 C3468.09,1343.8322 3402.01,1438.2282 3355.77,1504.2832 " fill="none" id="LegacySamFreeTransactionManager-to-CommonSignatureComputationData" style="stroke:#27AE60;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="3352.75,1508.5932,3361.194,1503.5239,3355.6221,1504.5004,3354.6456,1498.9285,3352.75,1508.5932" style="stroke:#27AE60;stroke-width:2.0;"/><polygon fill="#000000" points="3388.1327,1471.4819,3395.7273,1465.7572,3390.912,1462.3865,3388.1327,1471.4819" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="3400" y="1472.7686">use</text></g><!--MD5=[422919c85a46836a095db3d27a5785f3]
link LegacySamFreeTransactionManager to CommonSignatureVerificationData--><g id="link_LegacySamFreeTransactionManager_CommonSignatureVerificationData"><path codeLine="251" d="M3596.17,1290.0352 C3679.34,1346.8572 3828.8,1448.9702 3925.65,1515.1442 " fill="none" id="LegacySamFreeTransactionManager-to-CommonSignatureVerificationData" style="stroke:#27AE60;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="3929.93,1518.0712,3924.7478,1509.696,3925.799,1515.2543,3920.2407,1516.3056,3929.93,1518.0712" style="stroke:#27AE60;stroke-width:2.0;"/><polygon fill="#000000" points="3871.1284,1470.2064,3865.318,1462.6772,3862.0021,1467.5304,3871.1284,1470.2064" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="3876" y="1472.7686">use</text></g><!--MD5=[b965dc537a07ca6882db16269756c131]
link CardTransactionCryptoExtensionFactory to LegacySamCardTransactionCryptoExtension--><g id="link_CardTransactionCryptoExtensionFactory_LegacySamCardTransactionCryptoExtension"><path codeLine="253" d="M4345,838.9502 C4345,914.0102 4345,1099.2502 4345,1191.7932 " fill="none" id="CardTransactionCryptoExtensionFactory-to-LegacySamCardTransactionCryptoExtension" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="4345,1196.9412,4349,1187.9412,4345,1191.9412,4341,1187.9412,4345,1196.9412" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="4350,1032.3857,4352.9389,1023.3407,4347.0611,1023.3407,4350,1032.3857" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="4359" y="1032.7686">provide</text></g><!--MD5=[3226b1a528e01fe19bd12aca23b41295]
link LegacySamCardTransactionCryptoExtension to CommonSignatureComputationData--><g id="link_LegacySamCardTransactionCryptoExtension_CommonSignatureComputationData"><path codeLine="255" d="M4240.52,1297.3332 C4154.7,1336.3392 4029.28,1390.3632 3916,1427.7402 C3882.82,1438.6882 3730.38,1476.1802 3585.96,1511.0022 " fill="none" id="LegacySamCardTransactionCryptoExtension-to-CommonSignatureComputationData" style="stroke:#27AE60;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="3580.83,1512.2392,3590.5166,1514.0196,3585.6909,1511.0679,3588.6425,1506.2422,3580.83,1512.2392" style="stroke:#27AE60;stroke-width:2.0;"/><polygon fill="#000000" points="3800.2468,1468.9373,3809.7574,1468.9243,3807.9334,1463.3366,3800.2468,1468.9373" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="3814" y="1472.7686">use</text></g><!--MD5=[97a4ee76ffcefc4f5b4f14314b57fc69]
link LegacySamCardTransactionCryptoExtension to CommonSignatureVerificationData--><g id="link_LegacySamCardTransactionCryptoExtension_CommonSignatureVerificationData"><path codeLine="256" d="M4296.4,1297.2882 C4239.27,1354.9412 4144.3,1450.7842 4081.42,1514.2392 " fill="none" id="LegacySamCardTransactionCryptoExtension-to-CommonSignatureVerificationData" style="stroke:#27AE60;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="4077.7,1517.9922,4086.8802,1514.4251,4081.2234,1514.4446,4081.2039,1508.7877,4077.7,1517.9922" style="stroke:#27AE60;stroke-width:2.0;"/><polygon fill="#000000" points="4134.4806,1470.9374,4142.9348,1466.581,4138.7596,1462.4438,4134.4806,1470.9374" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="4147" y="1472.7686">use</text></g><!--MD5=[cecba4187e3f0e87e8b374dba4d1da43]
link CardSelectionFactory to LegacySamSelection--><g id="link_CardSelectionFactory_LegacySamSelection"><path codeLine="258" d="M318,838.9502 C318,909.1902 318,1075.9302 318,1172.8842 " fill="none" id="CardSelectionFactory-to-LegacySamSelection" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="318,1178.0212,322,1169.0212,318,1173.0212,314,1169.0212,318,1178.0212" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="323,1032.3857,325.9389,1023.3407,320.0611,1023.3407,323,1032.3857" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="332" y="1032.7686">provide</text></g><!--MD5=[d1441bb54ec12ef55a7fa9dacfe2aecf]
link LegacySamSelection to SamProductType--><g id="link_LegacySamSelection_SamProductType"><path codeLine="260" d="M408.901,1316.4162 C493.036,1379.5172 616.152,1471.8542 691.462,1528.3372 " fill="none" id="LegacySamSelection-to-SamProductType" style="stroke:#27AE60;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="695.905,1531.6692,691.105,1523.0692,691.905,1528.6692,686.305,1529.4692,695.905,1531.6692" style="stroke:#27AE60;stroke-width:2.0;"/><polygon fill="#000000" points="625,1470.3857,619.5273,1462.6075,616.0006,1467.3098,625,1470.3857" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="630" y="1472.7686">use</text></g><!--MD5=[3c9b475e2700f2e5f333b2777b638756]
reverse link LegacySam to SamProductType--><g id="link_LegacySam_SamProductType"><path codeLine="262" d="M764.673,1442.9982 C764.076,1447.9572 763.516,1452.8772 763,1457.7402 C761.253,1474.1892 760.108,1491.9612 759.36,1508.6732 " fill="none" id="LegacySam-backto-SamProductType" style="stroke:#181818;stroke-width:2.0;"/><ellipse cx="765.5638" cy="1435.96" fill="#FFFFFF" rx="8" ry="8" style="stroke:#181818;stroke-width:2.0;"/><line style="stroke:#181818;stroke-width:2.0;" x1="764.5596" x2="766.568" y1="1443.8967" y2="1428.0232"/><line style="stroke:#181818;stroke-width:2.0;" x1="757.6271" x2="773.5005" y1="1434.9558" y2="1436.9641"/></g><!--MD5=[5ecd342ac4874d804146f75452da1973]
link LegacySam to SamProductType--><g id="link_LegacySam_SamProductType"><path codeLine="263" d="M776.64,1428.2072 C773.348,1454.7082 770.12,1480.6902 767.3,1503.3882 " fill="none" id="LegacySam-to-SamProductType" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="766.667,1508.4802,771.7473,1500.0428,767.2842,1503.5185,763.8085,1499.0553,766.667,1508.4802" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="777.3836,1472.3476,781.4152,1463.7338,775.5822,1463.0092,777.3836,1472.3476" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="787" y="1472.7686">provide</text></g><!--MD5=[bc1c3aadd487419f97b539f8f5986cf6]
@startuml
title
    Calypsonet - calypsonet-terminal-calypso-crypto-legacysam-java-api - 0.1.+ (2022-12-05)
end title

' == THEME ==

'Couleurs issues de : https://htmlcolorcodes.com/fr/tableau-de-couleur/tableau-de-couleur-design-plat/
!define C_GREY1 F8F9F9
!define C_GREY2 F2F3F4
!define C_GREY3 E5E7E9
!define C_GREY4 D7DBDD
!define C_GREY5 CACFD2
!define C_GREY6 BDC3C7
!define C_LINK 3498DB
!define C_USE 27AE60

' - - Styles that don't work with new version of plantuml - -
skinparam stereotypeABorderColor #A9DCDF
skinparam stereotypeIBorderColor #B4A7E5
skinparam stereotypeCBorderColor #ADD1B2
skinparam stereotypeEBorderColor #EB93DF
' - - END - -

skinparam ClassBorderThickness 2
skinparam ArrowThickness 2

' Yellow
skinparam ClassBackgroundColor #FEFECE
skinparam ClassBorderColor #D4AC0D
' Red
skinparam ClassBackgroundColor<<red>> #FDEDEC
skinparam ClassBorderColor<<red>> #E74C3C
hide <<red>> stereotype
' Purple
skinparam ClassBackgroundColor<<purple>> #F4ECF7
skinparam ClassBorderColor<<purple>> #8E44AD
hide <<purple>> stereotype
' blue
skinparam ClassBackgroundColor<<blue>> #EBF5FB
skinparam ClassBorderColor<<blue>> #3498DB
hide <<blue>> stereotype
' Green
skinparam ClassBackgroundColor<<green>> #E9F7EF
skinparam ClassBorderColor<<green>> #27AE60
hide <<green>> stereotype
' Grey
skinparam ClassBackgroundColor<<grey>> #EAECEE
skinparam ClassBorderColor<<grey>> #2C3E50
hide <<grey>> stereotype

' == CONTENT ==

legend top
    __Colors legend__ :
    ** <color:grey>**Work in progress...**</color>
    * __External public API references__ :
    ** <back:yellow>**calypsonet-terminal-reader-java-api**</back>
    ** <back:pink>**calypsonet-terminal-calypso-java-api**</back>
end legend

package "org.calypsonet.terminal.calypso.crypto.legacysam" as api {
    +class "**final** LegacySamApiProperties" as ApiProperties {
        +{static} **final** String VERSION
    }
    package transaction {
        +interface LegacySamTransactionManagerFactory {
            +LegacySamFreeTransactionManager createFreeTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
            +<color:grey>LegacySamSecureReadTransactionManager createSecureReadTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam, LegacySamSecuritySetting securitySetting)
            +<color:grey>LegacySamSecureWriteTransactionManager createSecureWriteTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam, LegacySamSecuritySetting securitySetting)
            +<color:grey>LegacyControlSamAsyncTransactionManager createControlSamAsyncTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
            +<color:grey>LegacyTargetSamAsyncTransactionManager createTargetSamAsyncTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
        }
        +interface LegacySamTransactionManager<T extends LegacySamTransactionManager<T>> {
            +T processCommands ()
        }
        +interface LegacySamReadTransactionManager<T extends LegacySamReadTransactionManager<T>> extends LegacySamTransactionManager {
            +<color:grey>T prepareReadSamParameters ()

            +<color:grey>T prepareReadCaadRecord (int caadRecordNumber)
            +<color:grey>T prepareReadCaadRecords (int fromCaadRecordNumber, int toCaadRecordNumber)

            +<color:grey>T prepareReadSystemKeyParameters (LegacySystemKey systemKey)

            +<color:grey>T prepareReadWorkKeyParameter (int workKeyRecordNumber)
            +<color:grey>T prepareReadWorkKeyParameters (int fromWorkKeyRecordNumber, int toWorkKeyRecordNumber)

            +<color:grey>T prepareReadWorkKeyParameter (byte workKeyKif, byte workKeyKvc)

            +T prepareReadEventCounter (int eventCounterNumber)
            +T prepareReadEventCounters (int fromEventCounterNumber, int toEventCounterNumber)

            +T prepareReadEventCeiling (int eventCeilingNumber)
            +T prepareReadEventCeilings (int fromEventCeilingNumber, int toEventCeilingNumber)
        }
        +interface LegacySamFreeWriteTransactionManager<T extends LegacySamFreeWriteTransactionManager<T>> extends LegacySamTransactionManager {
            +<color:grey>T prepareWriteExternalPlainWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters, byte[] workKeyValue)
            +<color:grey>T prepareWriteRandomlyGeneratedWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters)
        }
        +interface LegacySamWriteTransactionManager<T extends LegacySamWriteTransactionManager<T>> extends LegacySamFreeWriteTransactionManager {
            +<color:grey>T prepareWriteSamParameters (byte[] parameters)
            +<color:grey>T prepareWriteCaadRecord (int caadRecordNumber, byte[] caad)

            +<color:grey>T prepareWriteTransferredCipheredSystemKey (LegacySystemKey sourceSystemKey, byte sourceSystemKeyKif, byte sourceSystemKeyKvc)
            +<color:grey>T prepareWriteTransferredPlainWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters)
            +<color:grey>T prepareWriteTransferredCipheredWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters, byte cipheringSystemKeyKvc)

            +<color:grey>T prepareWriteEventCeiling (int eventCeilingNumber, int newValue)
            +<color:grey>T prepareWriteEventCeilings (int fromEventCeilingNumber, List<Integer> newValues)
        }
        together {
            +interface LegacySamSecureReadTransactionManager extends LegacySamReadTransactionManager {
            }
            +interface LegacySamFreeTransactionManager extends LegacySamReadTransactionManager, LegacySamFreeWriteTransactionManager {
                +LegacySamFreeTransactionManager prepareComputeSignature (CommonSignatureComputationData<?> data)
                +LegacySamFreeTransactionManager prepareVerifySignature (CommonSignatureVerificationData<?> data)
            }
            +interface LegacySamSecureWriteTransactionManager extends LegacySamWriteTransactionManager {
            }
            +interface LegacyTargetSamAsyncTransactionManager extends LegacySamTransactionManager {
                +<color:grey>LegacyTargetSamAsyncTransactionManager importCommands (String cipheredSamCommands)
            }
            +interface LegacyControlSamAsyncTransactionManager extends LegacySamWriteTransactionManager {
                +<color:grey>LegacyControlSamAsyncTransactionManager prepareGiveTargetSamPseudoRandom (? asyncRandom)
                +<color:grey>String exportCommands ()
            }
        }
        +interface LegacySamSecuritySettingFactory {
            +<color:grey>LegacySamSecuritySetting createSecuritySetting ()
        }
        +interface LegacySamSecuritySetting {
            +<color:grey>LegacySamSecuritySetting setControlSamResource (<back:yellow>CardReader</back> samReader, LegacySam sam)
        }
        together {
            +interface CardTransactionCryptoExtensionFactory {
                +<color:grey>LegacySamCardTransactionCryptoExtension createCardTransactionCryptoExtension ()
            }
            +interface "<<<back:pink>CardTransactionCryptoExtension</back>>>\nLegacySamCardTransactionCryptoExtension" as LegacySamCardTransactionCryptoExtension {
                +<color:grey>LegacySamCardTransactionCryptoExtension prepareComputeSignature (CommonSignatureComputationData<?> data)
                +<color:grey>LegacySamCardTransactionCryptoExtension prepareVerifySignature (CommonSignatureVerificationData<?> data)
            }
        }
        together {
            +interface CommonSignatureComputationData<T extends CommonSignatureComputationData<T>> {
                +T setData (byte[] data, byte kif, byte kvc)
                +T setSignatureSize (int size)
                +T setKeyDiversifier (byte[] diversifier)

                +byte[] getSignature ()
            }
            +interface BasicSignatureComputationData extends CommonSignatureComputationData {
            }
            +interface TraceableSignatureComputationData extends CommonSignatureComputationData {
                +TraceableSignatureComputationData withSamTraceabilityMode (int offset, boolean usePartialSamSerialNumber)
                +TraceableSignatureComputationData withoutBusyMode ()

                +byte[] getSignedData ()
            }
            +interface CommonSignatureVerificationData<T extends CommonSignatureVerificationData<T>> {
                +T setData (byte[] data, byte[] signature, byte kif, byte kvc)
                +T setKeyDiversifier (byte[] diversifier)

                +boolean isSignatureValid ()
            }
            +interface BasicSignatureVerificationData extends CommonSignatureVerificationData {
            }
            +interface TraceableSignatureVerificationData extends CommonSignatureVerificationData {
                +TraceableSignatureVerificationData withSamTraceabilityMode (int offset, boolean isPartialSamSerialNumber, LegacySamRevocationServiceSpi samRevocationService)
                +TraceableSignatureVerificationData withoutBusyMode ()
            }
            +interface CommandDataFactory {
                +BasicSignatureComputationData createBasicSignatureComputationData ()
                +TraceableSignatureComputationData createTraceableSignatureComputationData ()
                +BasicSignatureVerificationData createBasicSignatureVerificationData ()
                +TraceableSignatureVerificationData createTraceableSignatureVerificationData ()
            }
        }
        ' Exceptions
        +class "<<RuntimeException>>" as RuntimeException {
            +**SamRevokedException**
            +**InconsistentDataException**: Number of R-APDUs != number of C-APDUs
            +**InvalidSignatureException**
            +**UnexpectedCommandStatusException**
            +**ReaderIOException**: SAM reader communication is broken.
            +**SamIOException**
        }
    }
    package sam {
        +interface CardSelectionFactory {
            +LegacySamSelection createSamSelection ()
        }
        +interface "<<<back:yellow>CardSelection</back>>>\nLegacySamSelection" as LegacySamSelection {
            +LegacySamSelection filterByProductType (LegacySam.ProductType productType)
            +LegacySamSelection filterBySerialNumber (String serialNumberRegex)

            +LegacySamSelection setUnlockData (String unlockData)
        }
        +interface "<<<back:yellow>SmartCard</back>>>\nLegacySam" as LegacySam {
            +ProductType getProductType ()
            +String getProductInfo ()

            +byte[] getSerialNumber ()
            +byte getPlatform ()
            +byte getApplicationType ()
            +byte getApplicationSubType ()
            +byte getSoftwareIssuer ()
            +byte getSoftwareVersion ()
            +byte getSoftwareRevision ()

            +Integer getEventCounter (int eventCounterNumber)
            +SortedMap<Integer, Integer> getEventCounters ()

            +Integer getEventCeiling (int eventCeilingNumber)
            +SortedMap<Integer, Integer> getEventCeilings ()
        }
        +enum "ProductType" as SamProductType {
            SAM_C1
            HSM_C1
            SAM_S1E1
            SAM_S1Dx
            UNKNOWN
        }
    }
    package spi {
        +interface LegacySamRevocationServiceSpi {
            +boolean isSamRevoked (byte[] serialNumber)
            +boolean isSamRevoked (byte[] serialNumber, int counterValue)
        }
    }
}

' Associations

LegacySamTransactionManagerFactory .up.> LegacySamSecureReadTransactionManager #C_LINK : provide >
LegacySamTransactionManagerFactory .up.> LegacySamFreeTransactionManager #C_LINK : provide >
LegacySamTransactionManagerFactory .up.> LegacySamSecureWriteTransactionManager #C_LINK : provide >
LegacySamTransactionManagerFactory .up.> LegacyControlSamAsyncTransactionManager #C_LINK : provide >
LegacySamTransactionManagerFactory .up.> LegacyTargetSamAsyncTransactionManager #C_LINK : provide >
LegacySamTransactionManagerFactory .up.> LegacySam #C_USE : use >
LegacySamTransactionManagerFactory ..> LegacySamSecuritySetting #C_USE : use >

CommandDataFactory .up.> BasicSignatureComputationData #C_LINK : provide >
CommandDataFactory .up.> TraceableSignatureComputationData #C_LINK : provide >
CommandDataFactory .up.> BasicSignatureVerificationData #C_LINK : provide >
CommandDataFactory .up.> TraceableSignatureVerificationData #C_LINK : provide >

TraceableSignatureVerificationData ..> LegacySamRevocationServiceSpi #C_USE : use >

LegacySamSecuritySettingFactory .up.> LegacySamSecuritySetting #C_LINK : provide >

LegacySamFreeTransactionManager ..> CommonSignatureComputationData #C_USE : use >
LegacySamFreeTransactionManager ..> CommonSignatureVerificationData #C_USE : use >

CardTransactionCryptoExtensionFactory ..> LegacySamCardTransactionCryptoExtension #C_LINK : provide >

LegacySamCardTransactionCryptoExtension ..> CommonSignatureComputationData #C_USE : use >
LegacySamCardTransactionCryptoExtension ..> CommonSignatureVerificationData #C_USE : use >

CardSelectionFactory ..> LegacySamSelection #C_LINK : provide >

LegacySamSelection ..> SamProductType #C_USE : use >

LegacySam +- - SamProductType
LegacySam ..> SamProductType #C_LINK : provide >

' == LAYOUT ==

'SamProductType .[hidden]. LegacySamRevocationServiceSpi

' == STYLE ==

package api #C_GREY1 {}
package spi #C_GREY2 {}
package sam #C_GREY2 {}
package transaction #C_GREY2 {}

interface LegacySamTransactionManager <<blue>>
interface LegacySamFreeTransactionManager <<blue>>
interface LegacySamFreeWriteTransactionManager <<blue>>
interface LegacySamReadTransactionManager <<blue>>
interface LegacySamWriteTransactionManager <<blue>>
interface LegacySamSecureReadTransactionManager <<blue>>
interface LegacySamSecureWriteTransactionManager <<blue>>
interface LegacyControlSamAsyncTransactionManager <<blue>>
interface LegacyTargetSamAsyncTransactionManager <<blue>>

interface CardSelectionFactory <<red>>
interface LegacySamTransactionManagerFactory <<red>>
interface CardTransactionCryptoExtensionFactory <<red>>
interface CommandDataFactory <<red>>
interface LegacySamSecuritySettingFactory <<red>>

interface LegacySamCardTransactionCryptoExtension <<green>>

interface LegacySamSelection <<green>>

@enduml

@startuml
title
    Calypsonet - calypsonet-terminal-calypso-crypto-legacysam-java-api - 0.1.+ (2022-12-05)
end title



skinparam stereotypeABorderColor #A9DCDF
skinparam stereotypeIBorderColor #B4A7E5
skinparam stereotypeCBorderColor #ADD1B2
skinparam stereotypeEBorderColor #EB93DF

skinparam ClassBorderThickness 2
skinparam ArrowThickness 2

skinparam ClassBackgroundColor #FEFECE
skinparam ClassBorderColor #D4AC0D
skinparam ClassBackgroundColor<<red>> #FDEDEC
skinparam ClassBorderColor<<red>> #E74C3C
hide <<red>> stereotype
skinparam ClassBackgroundColor<<purple>> #F4ECF7
skinparam ClassBorderColor<<purple>> #8E44AD
hide <<purple>> stereotype
skinparam ClassBackgroundColor<<blue>> #EBF5FB
skinparam ClassBorderColor<<blue>> #3498DB
hide <<blue>> stereotype
skinparam ClassBackgroundColor<<green>> #E9F7EF
skinparam ClassBorderColor<<green>> #27AE60
hide <<green>> stereotype
skinparam ClassBackgroundColor<<grey>> #EAECEE
skinparam ClassBorderColor<<grey>> #2C3E50
hide <<grey>> stereotype


legend top
    __Colors legend__ :
    ** <color:grey>**Work in progress...**</color>
    * __External public API references__ :
    ** <back:yellow>**calypsonet-terminal-reader-java-api**</back>
    ** <back:pink>**calypsonet-terminal-calypso-java-api**</back>
end legend

package "org.calypsonet.terminal.calypso.crypto.legacysam" as api {
    +class "**final** LegacySamApiProperties" as ApiProperties {
        +{static} **final** String VERSION
    }
    package transaction {
        +interface LegacySamTransactionManagerFactory {
            +LegacySamFreeTransactionManager createFreeTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
            +<color:grey>LegacySamSecureReadTransactionManager createSecureReadTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam, LegacySamSecuritySetting securitySetting)
            +<color:grey>LegacySamSecureWriteTransactionManager createSecureWriteTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam, LegacySamSecuritySetting securitySetting)
            +<color:grey>LegacyControlSamAsyncTransactionManager createControlSamAsyncTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
            +<color:grey>LegacyTargetSamAsyncTransactionManager createTargetSamAsyncTransactionManager (<back:yellow>CardReader</back> samReader, LegacySam sam)
        }
        +interface LegacySamTransactionManager<T extends LegacySamTransactionManager<T>> {
            +T processCommands ()
        }
        +interface LegacySamReadTransactionManager<T extends LegacySamReadTransactionManager<T>> extends LegacySamTransactionManager {
            +<color:grey>T prepareReadSamParameters ()

            +<color:grey>T prepareReadCaadRecord (int caadRecordNumber)
            +<color:grey>T prepareReadCaadRecords (int fromCaadRecordNumber, int toCaadRecordNumber)

            +<color:grey>T prepareReadSystemKeyParameters (LegacySystemKey systemKey)

            +<color:grey>T prepareReadWorkKeyParameter (int workKeyRecordNumber)
            +<color:grey>T prepareReadWorkKeyParameters (int fromWorkKeyRecordNumber, int toWorkKeyRecordNumber)

            +<color:grey>T prepareReadWorkKeyParameter (byte workKeyKif, byte workKeyKvc)

            +T prepareReadEventCounter (int eventCounterNumber)
            +T prepareReadEventCounters (int fromEventCounterNumber, int toEventCounterNumber)

            +T prepareReadEventCeiling (int eventCeilingNumber)
            +T prepareReadEventCeilings (int fromEventCeilingNumber, int toEventCeilingNumber)
        }
        +interface LegacySamFreeWriteTransactionManager<T extends LegacySamFreeWriteTransactionManager<T>> extends LegacySamTransactionManager {
            +<color:grey>T prepareWriteExternalPlainWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters, byte[] workKeyValue)
            +<color:grey>T prepareWriteRandomlyGeneratedWorkKey (byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters)
        }
        +interface LegacySamWriteTransactionManager<T extends LegacySamWriteTransactionManager<T>> extends LegacySamFreeWriteTransactionManager {
            +<color:grey>T prepareWriteSamParameters (byte[] parameters)
            +<color:grey>T prepareWriteCaadRecord (int caadRecordNumber, byte[] caad)

            +<color:grey>T prepareWriteTransferredCipheredSystemKey (LegacySystemKey sourceSystemKey, byte sourceSystemKeyKif, byte sourceSystemKeyKvc)
            +<color:grey>T prepareWriteTransferredPlainWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters)
            +<color:grey>T prepareWriteTransferredCipheredWorkKey (byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters, byte cipheringSystemKeyKvc)

            +<color:grey>T prepareWriteEventCeiling (int eventCeilingNumber, int newValue)
            +<color:grey>T prepareWriteEventCeilings (int fromEventCeilingNumber, List<Integer> newValues)
        }
        together {
            +interface LegacySamSecureReadTransactionManager extends LegacySamReadTransactionManager {
            }
            +interface LegacySamFreeTransactionManager extends LegacySamReadTransactionManager, LegacySamFreeWriteTransactionManager {
                +LegacySamFreeTransactionManager prepareComputeSignature (CommonSignatureComputationData<?> data)
                +LegacySamFreeTransactionManager prepareVerifySignature (CommonSignatureVerificationData<?> data)
            }
            +interface LegacySamSecureWriteTransactionManager extends LegacySamWriteTransactionManager {
            }
            +interface LegacyTargetSamAsyncTransactionManager extends LegacySamTransactionManager {
                +<color:grey>LegacyTargetSamAsyncTransactionManager importCommands (String cipheredSamCommands)
            }
            +interface LegacyControlSamAsyncTransactionManager extends LegacySamWriteTransactionManager {
                +<color:grey>LegacyControlSamAsyncTransactionManager prepareGiveTargetSamPseudoRandom (? asyncRandom)
                +<color:grey>String exportCommands ()
            }
        }
        +interface LegacySamSecuritySettingFactory {
            +<color:grey>LegacySamSecuritySetting createSecuritySetting ()
        }
        +interface LegacySamSecuritySetting {
            +<color:grey>LegacySamSecuritySetting setControlSamResource (<back:yellow>CardReader</back> samReader, LegacySam sam)
        }
        together {
            +interface CardTransactionCryptoExtensionFactory {
                +<color:grey>LegacySamCardTransactionCryptoExtension createCardTransactionCryptoExtension ()
            }
            +interface "<<<back:pink>CardTransactionCryptoExtension</back>>>\nLegacySamCardTransactionCryptoExtension" as LegacySamCardTransactionCryptoExtension {
                +<color:grey>LegacySamCardTransactionCryptoExtension prepareComputeSignature (CommonSignatureComputationData<?> data)
                +<color:grey>LegacySamCardTransactionCryptoExtension prepareVerifySignature (CommonSignatureVerificationData<?> data)
            }
        }
        together {
            +interface CommonSignatureComputationData<T extends CommonSignatureComputationData<T>> {
                +T setData (byte[] data, byte kif, byte kvc)
                +T setSignatureSize (int size)
                +T setKeyDiversifier (byte[] diversifier)

                +byte[] getSignature ()
            }
            +interface BasicSignatureComputationData extends CommonSignatureComputationData {
            }
            +interface TraceableSignatureComputationData extends CommonSignatureComputationData {
                +TraceableSignatureComputationData withSamTraceabilityMode (int offset, boolean usePartialSamSerialNumber)
                +TraceableSignatureComputationData withoutBusyMode ()

                +byte[] getSignedData ()
            }
            +interface CommonSignatureVerificationData<T extends CommonSignatureVerificationData<T>> {
                +T setData (byte[] data, byte[] signature, byte kif, byte kvc)
                +T setKeyDiversifier (byte[] diversifier)

                +boolean isSignatureValid ()
            }
            +interface BasicSignatureVerificationData extends CommonSignatureVerificationData {
            }
            +interface TraceableSignatureVerificationData extends CommonSignatureVerificationData {
                +TraceableSignatureVerificationData withSamTraceabilityMode (int offset, boolean isPartialSamSerialNumber, LegacySamRevocationServiceSpi samRevocationService)
                +TraceableSignatureVerificationData withoutBusyMode ()
            }
            +interface CommandDataFactory {
                +BasicSignatureComputationData createBasicSignatureComputationData ()
                +TraceableSignatureComputationData createTraceableSignatureComputationData ()
                +BasicSignatureVerificationData createBasicSignatureVerificationData ()
                +TraceableSignatureVerificationData createTraceableSignatureVerificationData ()
            }
        }
        +class "<<RuntimeException>>" as RuntimeException {
            +**SamRevokedException**
            +**InconsistentDataException**: Number of R-APDUs != number of C-APDUs
            +**InvalidSignatureException**
            +**UnexpectedCommandStatusException**
            +**ReaderIOException**: SAM reader communication is broken.
            +**SamIOException**
        }
    }
    package sam {
        +interface CardSelectionFactory {
            +LegacySamSelection createSamSelection ()
        }
        +interface "<<<back:yellow>CardSelection</back>>>\nLegacySamSelection" as LegacySamSelection {
            +LegacySamSelection filterByProductType (LegacySam.ProductType productType)
            +LegacySamSelection filterBySerialNumber (String serialNumberRegex)

            +LegacySamSelection setUnlockData (String unlockData)
        }
        +interface "<<<back:yellow>SmartCard</back>>>\nLegacySam" as LegacySam {
            +ProductType getProductType ()
            +String getProductInfo ()

            +byte[] getSerialNumber ()
            +byte getPlatform ()
            +byte getApplicationType ()
            +byte getApplicationSubType ()
            +byte getSoftwareIssuer ()
            +byte getSoftwareVersion ()
            +byte getSoftwareRevision ()

            +Integer getEventCounter (int eventCounterNumber)
            +SortedMap<Integer, Integer> getEventCounters ()

            +Integer getEventCeiling (int eventCeilingNumber)
            +SortedMap<Integer, Integer> getEventCeilings ()
        }
        +enum "ProductType" as SamProductType {
            SAM_C1
            HSM_C1
            SAM_S1E1
            SAM_S1Dx
            UNKNOWN
        }
    }
    package spi {
        +interface LegacySamRevocationServiceSpi {
            +boolean isSamRevoked (byte[] serialNumber)
            +boolean isSamRevoked (byte[] serialNumber, int counterValue)
        }
    }
}


LegacySamTransactionManagerFactory .up.> LegacySamSecureReadTransactionManager #3498DB : provide >
LegacySamTransactionManagerFactory .up.> LegacySamFreeTransactionManager #3498DB : provide >
LegacySamTransactionManagerFactory .up.> LegacySamSecureWriteTransactionManager #3498DB : provide >
LegacySamTransactionManagerFactory .up.> LegacyControlSamAsyncTransactionManager #3498DB : provide >
LegacySamTransactionManagerFactory .up.> LegacyTargetSamAsyncTransactionManager #3498DB : provide >
LegacySamTransactionManagerFactory .up.> LegacySam #27AE60 : use >
LegacySamTransactionManagerFactory ..> LegacySamSecuritySetting #27AE60 : use >

CommandDataFactory .up.> BasicSignatureComputationData #3498DB : provide >
CommandDataFactory .up.> TraceableSignatureComputationData #3498DB : provide >
CommandDataFactory .up.> BasicSignatureVerificationData #3498DB : provide >
CommandDataFactory .up.> TraceableSignatureVerificationData #3498DB : provide >

TraceableSignatureVerificationData ..> LegacySamRevocationServiceSpi #27AE60 : use >

LegacySamSecuritySettingFactory .up.> LegacySamSecuritySetting #3498DB : provide >

LegacySamFreeTransactionManager ..> CommonSignatureComputationData #27AE60 : use >
LegacySamFreeTransactionManager ..> CommonSignatureVerificationData #27AE60 : use >

CardTransactionCryptoExtensionFactory ..> LegacySamCardTransactionCryptoExtension #3498DB : provide >

LegacySamCardTransactionCryptoExtension ..> CommonSignatureComputationData #27AE60 : use >
LegacySamCardTransactionCryptoExtension ..> CommonSignatureVerificationData #27AE60 : use >

CardSelectionFactory ..> LegacySamSelection #3498DB : provide >

LegacySamSelection ..> SamProductType #27AE60 : use >

LegacySam +- - SamProductType
LegacySam ..> SamProductType #3498DB : provide >




package api #F8F9F9 {}
package spi #F2F3F4 {}
package sam #F2F3F4 {}
package transaction #F2F3F4 {}

interface LegacySamTransactionManager <<blue>>
interface LegacySamFreeTransactionManager <<blue>>
interface LegacySamFreeWriteTransactionManager <<blue>>
interface LegacySamReadTransactionManager <<blue>>
interface LegacySamWriteTransactionManager <<blue>>
interface LegacySamSecureReadTransactionManager <<blue>>
interface LegacySamSecureWriteTransactionManager <<blue>>
interface LegacyControlSamAsyncTransactionManager <<blue>>
interface LegacyTargetSamAsyncTransactionManager <<blue>>

interface CardSelectionFactory <<red>>
interface LegacySamTransactionManagerFactory <<red>>
interface CardTransactionCryptoExtensionFactory <<red>>
interface CommandDataFactory <<red>>
interface LegacySamSecuritySettingFactory <<red>>

interface LegacySamCardTransactionCryptoExtension <<green>>

interface LegacySamSelection <<green>>

@enduml

PlantUML version 1.2022.13(Sat Nov 19 14:22:17 CET 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: fr
Country: FR
--></g></svg>